!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=32)}([function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));const o="[amp-web-push]",r={NOTIFICATION_PERMISSION:"amp-web-push-notification-permission"},i={GRANTED:"granted",DENIED:"denied",DEFAULT:"default"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var o=n(0),r=n(3);function i(e){return e.data}class a{constructor(e){e||(e={debug:!1,windowContext:window}),this.messages_={},this.listeners_={},this.debug_=e.debug,this.listening_=!1,this.connecting_=!1,this.connected_=!1,this.channel_=null,this.messagePort_=null,this.onListenConnectionMessageReceivedProc_=null,this.onConnectConnectionMessageReceivedProc_=null,this.onChannelMessageReceivedProc_=null,this.window_=e.windowContext||window}listen(e){return new Promise((t,n)=>{this.connected_?n(new Error("Already connected.")):this.listening_?n(new Error("Already listening for connections.")):Array.isArray(e)?(this.onListenConnectionMessageReceivedProc_=this.onListenConnectionMessageReceived_.bind(this,e,t,n),this.window_.addEventListener("message",this.onListenConnectionMessageReceivedProc_),this.debug_&&console.debug(o.c,"Listening for a connection message...")):n(new Error("allowedOrigins should be a string array of allowed origins to accept messages from. Got:",e))}).then(()=>{this.send(a.Topics.CONNECT_HANDSHAKE,null),this.connected_=!0})}isAllowedOrigin_(e,t){const n=Object(r.b)(e).origin;for(let e=0;e<t.length;e++){const o=t[e];if(Object(r.b)(o).origin===n)return!0}return!1}onListenConnectionMessageReceived_(e,t,n,r){const s=i(r),{origin:c,ports:p}=r;this.debug_&&console.debug(o.c,"Window message for listen() connection received:",s),this.isAllowedOrigin_(c,e)?s&&s.topic===a.Topics.CONNECT_HANDSHAKE?(console.debug(o.c,"Received expected connection handshake message:",s),this.window_.removeEventListener("message",this.onListenConnectionMessageReceivedProc_),this.messagePort_=p[0],this.onChannelMessageReceivedProc_=this.onChannelMessageReceived_.bind(this),this.messagePort_.addEventListener("message",this.onChannelMessageReceivedProc_,!1),this.messagePort_.start(),t()):console.debug(o.c,"Discarding connection message because it did not contain our expected handshake:",s):console.debug(o.c,`Discarding connection message from ${c} because it isn't an allowed origin:`,s," (allowed  origins are)",e)}connect(e,t){return new Promise((n,i)=>{e||i(new Error("Provide a valid Window context to connect to.")),t||i(new Error("Provide an expected origin for the remote Window or provide the wildcard *.")),this.connected_?i(new Error("Already connected.")):this.connecting_?i(new Error("Already connecting.")):(this.channel_=new MessageChannel,this.messagePort_=this.channel_.port1,this.onConnectConnectionMessageReceivedProc_=this.onConnectConnectionMessageReceived_.bind(this,this.messagePort_,t,n),this.messagePort_.addEventListener("message",this.onConnectConnectionMessageReceivedProc_),this.messagePort_.start(),e.postMessage({topic:a.Topics.CONNECT_HANDSHAKE},"*"===t?"*":Object(r.b)(t).origin,[this.channel_.port2]),console.debug(o.c,`Opening channel to ${t}...`))})}onConnectConnectionMessageReceived_(e,t,n){this.connected_=!0,this.debug_&&console.debug(o.c,`Messenger channel to ${t} established.`),e.removeEventListener("message",this.onConnectConnectionMessageReceivedProc_),this.onChannelMessageReceivedProc_=this.onChannelMessageReceived_.bind(this),e.addEventListener("message",this.onChannelMessageReceivedProc_,!1),n()}static get Topics(){return{CONNECT_HANDSHAKE:"topic-connect-handshake",NOTIFICATION_PERMISSION_STATE:"topic-notification-permission-state",SERVICE_WORKER_STATE:"topic-service-worker-state",SERVICE_WORKER_REGISTRATION:"topic-service-worker-registration",SERVICE_WORKER_QUERY:"topic-service-worker-query",STORAGE_GET:"topic-storage-get"}}onChannelMessageReceived_(e){const t=i(e);if(this.messages_[t.id]&&t.isReply){const e=this.messages_[t.id];delete this.messages_[t.id];const{promiseResolver:n}=e;e.message=t.data,this.debug_&&console.debug(o.c,"Received reply for topic '%s': %s",t.topic,t.data),n([t.data,this.sendReply_.bind(this,t.id,e.topic)])}else{const e=this.listeners_[t.topic];if(!e)return;this.debug_&&console.debug(o.c,`Received new message for topic '${t.topic}': ${t.data}`);for(let n=0;n<e.length;n++)(0,e[n])(t.data,this.sendReply_.bind(this,t.id,t.topic))}}on(e,t){this.listeners_[e]?this.listeners_[e].push(t):this.listeners_[e]=[t]}off(e,t){if(t){const n=this.listeners_[e].indexOf(t);-1!==n&&this.listeners_[e].splice(n,1)}else this.listeners_[e]&&delete this.listeners_[e]}sendReply_(e,t,n){const o={id:e,topic:t,data:n,isReply:!0};return this.messagePort_.postMessage(o),new Promise(e=>{this.messages_[o.id]={message:n,topic:t,promiseResolver:e}})}send(e,t){const n={id:crypto.getRandomValues(new Uint8Array(10)).join(""),topic:e,data:t};return this.debug_&&console.debug(o.c,"Sending %s: %s",e,t),this.messagePort_.postMessage(n),new Promise(o=>{this.messages_[n.id]={message:t,topic:e,promiseResolver:o}})}}},function(e,t,n){"use strict";var o,r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var o=Array(e),r=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,s=i.length;a<s;a++,r++)o[r]=i[a];return o};Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.DEBUG="debug",e.TRACE="trace",e.LOG="log",e.INFO="info",e.WARN="warn",e.ERROR="error"}(o=t.LogLevel||(t.LogLevel={}));var i=function(){function e(e){this._log_retained=[],this._log_reentrant=0,this._debugCollapsed_cache={},this.runMode="??????",(null==e?void 0:e.runMode)&&(this.runMode=e.runMode),this.sdkName=null==e?void 0:e.sdkName}return e.prototype._log=function(e){++this._log_reentrant;try{var t=new Date,n=console[e];console[e]instanceof Function||(n=console.log);var o=[];if(this._log_reentrant>1?o.unshift("[REENTRANT]"):o.unshift(this.runMode),this.sdkName&&o.unshift("["+this.sdkName+"]"),o.unshift("["+t.toLocaleTimeString("en-GB")+"."+("00"+t.getMilliseconds()).slice(-3)+"]"),!Object({debug:!1})["debug-unresolved"]||"trace"!==e&&"debug"!==e)return Function.prototype.bind.apply(n,[console].concat(o));var r=this;return function(){var e;null===(e=r._log_retained)||void 0===e||e.push([n,o.concat(Array.prototype.slice.call(arguments))])}}catch(e){return console.log}finally{--this._log_reentrant}},e.prototype.noop=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(){}},Object.defineProperty(e.prototype,"level",{get:function(){return o.INFO},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"trace",{get:function(){return this.noop()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"debug",{get:function(){return this.noop()},enumerable:!0,configurable:!0}),e.prototype.debugResolved=function(){Object({debug:!1})["debug-unresolved"]||(this._log_retained=void 0)},Object.defineProperty(e.prototype,"log",{get:function(){return this._log(o.LOG)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"info",{get:function(){return this._log(o.INFO)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"warn",{get:function(){return this._log(o.WARN)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"error",{get:function(){return this._log(o.ERROR)},enumerable:!0,configurable:!0}),e.prototype.debugCollapsed=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=JSON.stringify(t);this._debugCollapsed_cache[e]!==o&&(this._debugCollapsed_cache[e]=o,this.debug(t))},e}();t.SimpleLogger=i,t.defaultLogger=new i,t.setDefaultLogger=function(e){t.defaultLogger=e},t.trace=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.defaultLogger.trace.apply(t.defaultLogger,e)},t.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.defaultLogger.debug.apply(t.defaultLogger,e)},t.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.defaultLogger.log.apply(t.defaultLogger,e)},t.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.defaultLogger.info.apply(t.defaultLogger,e)},t.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.defaultLogger.warn.apply(t.defaultLogger,e)},t.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.defaultLogger.error.apply(t.defaultLogger,e)},t.debugCollapsed=function(e){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return t.defaultLogger.debugCollapsed.apply(t.defaultLogger,r([e],n))},t.debugResolved=function(){return t.defaultLogger.debugResolved()}},function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));const o=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function r(e,t=""){try{return decodeURIComponent(e)}catch(e){return t}}function i(e){const t=Object.create(null);if(!e)return t;let n;for(;n=o.exec(e);){const e=r(n[1],n[1]),o=n[2]?r(n[2],n[2]):"";t[e]=o}return t}let a;function s(e){return a||(a=self.document.createElement("a")),function(e,t){e.href=t,e.protocol||(e.href=e.href);const n={href:e.href,protocol:e.protocol,host:e.host,hostname:e.hostname,port:"0"==e.port?"":e.port,pathname:e.pathname,search:e.search,hash:e.hash,origin:null};let o;return"/"!==n.pathname[0]&&(n.pathname="/"+n.pathname),("http:"==n.protocol&&80==n.port||"https:"==n.protocol&&443==n.port)&&(n.port="",n.host=n.hostname),o=e.origin&&"null"!=e.origin?e.origin:"data:"!=n.protocol&&n.host?n.protocol+"//"+n.host:n.href,n.origin=o,!1}(a,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5);!function(e){e.ON_FOREGROUND="ON_FOREGROUND",e.APP_LAUNCH="APP_LAUNCH",e.ON_EXIT="ON_EXIT"}(t.SystemEvent||(t.SystemEvent={})),function(e){e.FADE_IN="fadeIn",e.SLIDE_IN_FROM_RIGHT="slideInFromRight",e.SLIDE_IN_FROM_LEFT="slideInFromLeft",e.SLIDE_IN_FROM_TOP="slideInFromTop",e.SLIDE_IN_FROM_BOTTOM="slideInFromBottom"}(t.EntryAnimation||(t.EntryAnimation={})),function(e){e.FADE_OUT="fadeOut",e.SLIDE_OUT_RIGHT="slideOutRight",e.SLIDE_OUT_LEFT="slideOutLeft",e.SLIDE_OUT_TOP="slideOutUp",e.SLIDE_OUT_DOWN="slideOutDown"}(t.ExitAnimation||(t.ExitAnimation={})),t.urlPassesFilters=function(e,t){if(!t)return!0;var n=e.href;if(t.whiteList&&t.whiteList.filter((function(e){return!!e})).length>0){for(var o=!1,r=0,i=t.whiteList;r<i.length;r++)if((c=i[r])&&n.indexOf(c)>=0){o=!0;break}if(!o)return!1}if(t.blackList&&t.blackList.filter((function(e){return!!e})).length>0)for(var a=0,s=t.blackList;a<s.length;a++){var c;if((c=s[a])&&n.indexOf(c)>=0)return!1}return!0};var r,i=function(){function e(e){this.campaign=e}return Object.defineProperty(e.prototype,"campaignId",{get:function(){for(var e=0,t=this.campaign.notifications;e<t.length;e++){var n=t[e],r=o.ReportingDataUtil.extract(n);if("string"==typeof r.campaignId)return r.campaignId}throw new Error("campaign without identifier")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active",{get:function(){var e=+new Date;return!(this.campaign.scheduling.startDate&&this.campaign.scheduling.startDate>e||this.campaign.scheduling.endDate&&this.campaign.scheduling.endDate<e)},enumerable:!0,configurable:!0}),e.prototype.triggersMatchingEvent=function(e){return this.campaign.triggers.filter((function(t){var n;return t.systemEvent===e||(null===(n=t.event)||void 0===n?void 0:n.type)===e}))},e}();t.CampaignWrapper=i,function(e){e.BANNER="banner",e.CARD="card",e.IMAGEONLY="imageOnly",e.MODAL="modal"}(r=t.InAppMessageType||(t.InAppMessageType={}));var a=function(){function e(e,t,n,o){this.messageType=e,this.content=t,this.reportingData=n,this.payload=o}return e.prototype.buttonTypeOfActions=function(e){var t=function(t){if(!e||!t||e.length!==t.length)return!1;if(!e.length)return!1;for(var n=0;n<e.length&&t[n]===e[n];n++)if(n===e.length-1)return!0;return!1};switch(this.messageType){case r.BANNER:case r.IMAGEONLY:case r.MODAL:if(t((n=this.content).actions))return"primary";break;case r.CARD:var n;if(t((n=this.content).primaryActions))return"primary";if(t(n.secondaryActions))return"secondary"}},e}();t.InAppMessage=a,function(e){e.SWIPE="swipe",e.TAP="tap",e.AUTO="auto"}(t.DismissType||(t.DismissType={}))},function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i="eventAttribution",a="[attribution ]";t.isReportingData=function(e){return"object"==typeof e&&!("string"!=typeof e.notificationId||void 0!==e.campaignId&&null!==e.campaignId&&"string"!=typeof e.campaignId||void 0!==e.viewId&&null!==e.viewId&&"string"!=typeof e.viewId||void 0!==e.reporting&&null!=e.reporting&&"object"!=typeof e.reporting)};var s=function(){function e(){}return e.extract=function(e){function t(e){return null===e||"string"==typeof e}function n(e){return"string"==typeof e?e:null}function o(e){return"object"==typeof e?e:null}return t(e.n)||t(e.c)||t(e.v)?{notificationId:n(e.n),campaignId:n(e.c),viewId:n(e.v),reporting:o(e.reporting)}:t(e.notificationId)||t(e.campaignId)||t(e.viewId)?{notificationId:n(e.notificationId),campaignId:n(e.campaignId),viewId:n(e.viewId),reporting:o(e.reporting)}:"object"==typeof e.reporting?{notificationId:n(e.reporting.notificationId),campaignId:n(e.reporting.campaignId),viewId:n(e.reporting.viewId),reporting:e.reporting}:{notificationId:null,campaignId:null,viewId:null,reporting:null}},e.hasReportingEventData=function(e){return"notificationId"in e||"campaignId"in e||"viewId"in e||"reporting"in e},e.assignEventData=function(e,t){t&&!this.hasReportingEventData(e)&&(null!==t.notificationId&&(e.notificationId=t.notificationId),null!==t.campaignId&&(e.campaignId=t.campaignId),null!==t.viewId&&(e.viewId=t.viewId),null!==t.reporting&&(e.reporting=t.reporting))},e.withEventData=function(e,t){if(!t||this.hasReportingEventData(e))return e;var n=o({},e);return this.assignEventData(n,t),n},e}();t.ReportingDataUtil=s;var c=function(){function e(e){this.storage=e}return e.prototype.setCurrentAttribution=function(e,t){var n={data:e,expirationTime:+new Date+t};return r.debug(a,"[setCurrentAttribution]",e,t),this.storage.set(i,n).then((function(){r.debug(a,"[setCurrentAttribution] done",n)}))},e.prototype.currentAttribution=function(){return this.storage.get(i,void 0).then((function(e){if(e&&(new Date).getTime()<e.expirationTime)return e.data}))},e.prototype.renewCurrentAttribution=function(e){return r.debug(a,"[renewCurrentAttribution]",e),this.storage.bulk([{test:{key:i,defaultValue:void 0,operationsCb:function(t){return t?{put:{key:i,value:o(o({},t),{expirationTime:+new Date+e})}}:[]}}}]).then((function(){r.debug(a,"[renewCurrentAttribution] done",e)}))},e.prototype.resetCurrentAttribution=function(){return r.debug(a,"[resetCurrentAttribution]"),this.storage.rm(i).then((function(){r.debug(a,"[resetCurrentAttribution] done")}))},e}();t.EventAttributionManager=c},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,o,r,i=e[1]||"",a=e[3];if(!a)return i;if(t&&"function"==typeof btoa){var s=(n=a,o=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),r="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(r," */")),c=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[i].concat(c).concat([s]).join("\n")}return[i].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(o)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(r[a]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);o&&r[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class o{constructor(e){this.context=e}}t.ASTCriterionNode=o,t.ASTUnknownCriterionNode=class extends o{constructor(e,t,n){super(e),this.key=t,this.value=n}accept(e){return e.visitASTUnknownCriterionNode(this)}};class r{constructor(e,t){this.context=e,this.value=t}}t.ASTValueNode=r,t.ASTUnknownValueNode=class extends r{constructor(e,t,n){super(e,void 0),this.key=t,this.value=n}accept(e){return e.visitUnknownValueNode(this)}}},function(e,t,n){"use strict";var o,r=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function a(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function s(e,t){for(var n={},o=[],r=0;r<e.length;r++){var s=e[r],c=t.base?s[0]+t.base:s[0],p=n[c]||0,u="".concat(c," ").concat(p);n[c]=p+1;var d=a(u),l={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(i[d].references++,i[d].updater(l)):i.push({identifier:u,updater:g(l,t),references:1}),o.push(u)}return o}function c(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var i=n.nc;i&&(o.nonce=i)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var a=r(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var p,u=(p=[],function(e,t){return p[e]=t,p.filter(Boolean).join("\n")});function d(e,t,n,o){var r=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=u(t,r);else{var i=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}var l=null,f=0;function g(e,t){var n,o,r;if(t.singleton){var i=f++;n=l||(l=c(t)),o=d.bind(null,n,i,!1),r=d.bind(null,n,i,!0)}else n=c(t),o=function(e,t,n){var o=n.css,r=n.media,i=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),i&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o));var n=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var r=a(n[o]);i[r].references--}for(var c=s(e,t),p=0;p<n.length;p++){var u=a(n[p]);0===i[u].references&&(i[u].updater(),i.splice(u,1))}n=c}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class o extends Error{}t.SegmentationDSLError=o,t.BadInputError=class extends o{},t.UnknownCriterionError=class extends o{constructor(e){super(`Unknown criterion "${e.key}"`),this.node=e}},t.UnknownValueError=class extends o{constructor(e){super(`Unknown value type "${e.key}"`),this.node=e}}},function(e,t,n){e.exports=function(){"use strict";var e=Object.freeze||function(e){return e},t=e(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),n=e(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),o=e(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),r=e(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),i=e(["#text"]),a=Object.freeze||function(e){return e},s=a(["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","coords","crossorigin","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","integrity","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","minlength","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns"]),c=a(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),p=a(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),u=a(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),d=Object.hasOwnProperty,l=Object.setPrototypeOf,f=("undefined"!=typeof Reflect&&Reflect).apply;function g(e,t){l&&l(e,null);for(var n=t.length;n--;){var o=t[n];if("string"==typeof o){var r=o.toLowerCase();r!==o&&(Object.isFrozen(t)||(t[n]=r),o=r)}e[o]=!0}return e}function h(e){var t={},n=void 0;for(n in e)f(d,e,[n])&&(t[n]=e[n]);return t}f||(f=function(e,t,n){return e.apply(t,n)});var m=Object.seal||function(e){return e},v=m(/\{\{[\s\S]*|[\s\S]*\}\}/gm),_=m(/<%[\s\S]*|[\s\S]*%>/gm),y=m(/^data-[\-\w.\u00B7-\uFFFF]/),w=m(/^aria-[\-\w]+$/),b=m(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),S=m(/^(?:\w+script|data):/i),E=m(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g),I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function C(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var T=("undefined"!=typeof Reflect&&Reflect).apply,P=Array.prototype.slice,N=Object.freeze,O=function(){return"undefined"==typeof window?null:window};T||(T=function(e,t,n){return e.apply(t,n)});var A=function(e,t){if("object"!==(void 0===e?"undefined":I(e))||"function"!=typeof e.createPolicy)return null;var n=null;t.currentScript&&t.currentScript.hasAttribute("data-tt-policy-suffix")&&(n=t.currentScript.getAttribute("data-tt-policy-suffix"));var o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function e(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O(),d=function(t){return e(t)};if(d.version="2.0.5",d.removed=[],!a||!a.document||9!==a.document.nodeType)return d.isSupported=!1,d;var l=a.document,f=!1,m=!1,M=!1,x=a.document,D=a.DocumentFragment,k=a.HTMLTemplateElement,R=a.Node,L=a.NodeFilter,U=a.NamedNodeMap,j=void 0===U?a.NamedNodeMap||a.MozNamedAttrMap:U,W=a.Text,B=a.Comment,z=a.DOMParser,F=a.TrustedTypes;if("function"==typeof k){var V=x.createElement("template");V.content&&V.content.ownerDocument&&(x=V.content.ownerDocument)}var G=A(F,l),H=G?G.createHTML(""):"",K=x,Y=K.implementation,J=K.createNodeIterator,q=K.getElementsByTagName,Q=K.createDocumentFragment,Z=l.importNode,X={};d.isSupported=Y&&void 0!==Y.createHTMLDocument&&9!==x.documentMode;var $=v,ee=_,te=y,ne=w,oe=S,re=E,ie=b,ae=null,se=g({},[].concat(C(t),C(n),C(o),C(r),C(i))),ce=null,pe=g({},[].concat(C(s),C(c),C(p),C(u))),ue=null,de=null,le=!0,fe=!0,ge=!1,he=!1,me=!1,ve=!1,_e=!1,ye=!1,we=!1,be=!1,Se=!1,Ee=!1,Ie=!0,Ce=!0,Te=!1,Pe={},Ne=g({},["audio","colgroup","head","math","script","style","template","thead","svg","video"]),Oe=g({},["audio","video","img","source","image"]),Ae=null,Me=g({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),xe=null,De=x.createElement("form"),ke=function(e){xe&&xe===e||(e&&"object"===(void 0===e?"undefined":I(e))||(e={}),ae="ALLOWED_TAGS"in e?g({},e.ALLOWED_TAGS):se,ce="ALLOWED_ATTR"in e?g({},e.ALLOWED_ATTR):pe,Ae="ADD_URI_SAFE_ATTR"in e?g(h(Me),e.ADD_URI_SAFE_ATTR):Me,ue="FORBID_TAGS"in e?g({},e.FORBID_TAGS):{},de="FORBID_ATTR"in e?g({},e.FORBID_ATTR):{},Pe="USE_PROFILES"in e&&e.USE_PROFILES,le=!1!==e.ALLOW_ARIA_ATTR,fe=!1!==e.ALLOW_DATA_ATTR,ge=e.ALLOW_UNKNOWN_PROTOCOLS||!1,he=e.SAFE_FOR_JQUERY||!1,me=e.SAFE_FOR_TEMPLATES||!1,ve=e.WHOLE_DOCUMENT||!1,we=e.RETURN_DOM||!1,be=e.RETURN_DOM_FRAGMENT||!1,Se=e.RETURN_DOM_IMPORT||!1,Ee=e.RETURN_TRUSTED_TYPE||!1,ye=e.FORCE_BODY||!1,Ie=!1!==e.SANITIZE_DOM,Ce=!1!==e.KEEP_CONTENT,Te=e.IN_PLACE||!1,ie=e.ALLOWED_URI_REGEXP||ie,me&&(fe=!1),be&&(we=!0),Pe&&(ae=g({},[].concat(C(i))),ce=[],!0===Pe.html&&(g(ae,t),g(ce,s)),!0===Pe.svg&&(g(ae,n),g(ce,c),g(ce,u)),!0===Pe.svgFilters&&(g(ae,o),g(ce,c),g(ce,u)),!0===Pe.mathMl&&(g(ae,r),g(ce,p),g(ce,u))),e.ADD_TAGS&&(ae===se&&(ae=h(ae)),g(ae,e.ADD_TAGS)),e.ADD_ATTR&&(ce===pe&&(ce=h(ce)),g(ce,e.ADD_ATTR)),e.ADD_URI_SAFE_ATTR&&g(Ae,e.ADD_URI_SAFE_ATTR),Ce&&(ae["#text"]=!0),ve&&g(ae,["html","head","body"]),ae.table&&(g(ae,["tbody"]),delete ue.tbody),N&&N(e),xe=e)},Re=function(e){d.removed.push({element:e});try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=H}},Le=function(e,t){try{d.removed.push({attribute:t.getAttributeNode(e),from:t})}catch(e){d.removed.push({attribute:null,from:t})}t.removeAttribute(e)},Ue=function(e){var t=void 0,n=void 0;if(ye)e="<remove></remove>"+e;else{var o=e.match(/^[\s]+/);(n=o&&o[0])&&(e=e.slice(n.length))}if(f)try{t=(new z).parseFromString(e,"text/html")}catch(e){}if(M&&g(ue,["title"]),!t||!t.documentElement){var r=(t=Y.createHTMLDocument("")).body;r.parentNode.removeChild(r.parentNode.firstElementChild),r.outerHTML=G?G.createHTML(e):e}return n&&t.body.insertBefore(x.createTextNode(n),t.body.childNodes[0]||null),q.call(t,ve?"html":"body")[0]};d.isSupported&&(function(){try{Ue('<svg><p><textarea><img src="</textarea><img src=x abc=1//">').querySelector("svg img")&&(f=!0)}catch(e){}}(),function(){try{var e=Ue("<x/><title>&lt;/title&gt;&lt;img&gt;");/<\/title/.test(e.querySelector("title").innerHTML)&&(M=!0)}catch(e){}}(),function(){try{Ue("<svg></p></svg>").querySelector("svg p")&&(m=!0)}catch(e){}}());var je=function(e){return J.call(e.ownerDocument||e,e,L.SHOW_ELEMENT|L.SHOW_COMMENT|L.SHOW_TEXT,(function(){return L.FILTER_ACCEPT}),!1)},We=function(e){return"object"===(void 0===R?"undefined":I(R))?e instanceof R:e&&"object"===(void 0===e?"undefined":I(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},Be=function(e,t,n){X[e]&&X[e].forEach((function(e){e.call(d,t,n,xe)}))},ze=function(e){var t,n=void 0;if(Be("beforeSanitizeElements",e,null),!((t=e)instanceof W||t instanceof B||"string"==typeof t.nodeName&&"string"==typeof t.textContent&&"function"==typeof t.removeChild&&t.attributes instanceof j&&"function"==typeof t.removeAttribute&&"function"==typeof t.setAttribute&&"string"==typeof t.namespaceURI))return Re(e),!0;var o=e.nodeName.toLowerCase();if(Be("uponSanitizeElement",e,{tagName:o,allowedTags:ae}),!ae[o]||ue[o]){if(Ce&&!Ne[o]&&"function"==typeof e.insertAdjacentHTML)try{var r=e.innerHTML;e.insertAdjacentHTML("AfterEnd",G?G.createHTML(r):r)}catch(e){}return Re(e),!0}return"noscript"===o&&/<\/noscript/i.test(e.innerHTML)||"noembed"===o&&/<\/noembed/i.test(e.innerHTML)||e.namespaceURI&&/svg|math/i.test(e.namespaceURI)&&e.textContent&&new RegExp("</"+o,"i").test(e.textContent)?(Re(e),!0):"svg"!==o&&"math"!==o||0===e.querySelectorAll("template, svg, math").length?(!he||e.firstElementChild||e.content&&e.content.firstElementChild||!/</g.test(e.textContent)||(d.removed.push({element:e.cloneNode()}),e.innerHTML?e.innerHTML=e.innerHTML.replace(/</g,"&lt;"):e.innerHTML=e.textContent.replace(/</g,"&lt;")),me&&3===e.nodeType&&(n=(n=(n=e.textContent).replace($," ")).replace(ee," "),e.textContent!==n&&(d.removed.push({element:e.cloneNode()}),e.textContent=n)),Be("afterSanitizeElements",e,null),!1):(Re(e),!0)},Fe=function(e,t,n){if(Ie&&("id"===t||"name"===t)&&(n in x||n in De))return!1;if(fe&&te.test(t));else if(le&&ne.test(t));else{if(!ce[t]||de[t])return!1;if(Ae[t]);else if(ie.test(n.replace(re,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==n.indexOf("data:")||!Oe[e])if(ge&&!oe.test(n.replace(re,"")));else if(n)return!1}return!0},Ve=function(e){var t=void 0,n=void 0,o=void 0,r=void 0,i=void 0;Be("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var s={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ce};for(i=a.length;i--;){var c=t=a[i],p=c.name,u=c.namespaceURI;if(n=t.value.trim(),o=p.toLowerCase(),s.attrName=o,s.attrValue=n,s.keepAttr=!0,Be("uponSanitizeAttribute",e,s),n=s.attrValue,(ae.svg&&!ue.svg||ae.math&&!ue.math)&&m&&/<\//.test(n)&&Re(e),"name"===o&&"IMG"===e.nodeName&&a.id)r=a.id,a=T(P,a,[]),Le("id",e),Le(p,e),a.indexOf(r)>i&&e.setAttribute("id",r.value);else{if("INPUT"===e.nodeName&&"type"===o&&"file"===n&&s.keepAttr&&(ce[o]||!de[o]))continue;"id"===p&&e.setAttribute(p,""),Le(p,e)}if(s.keepAttr){me&&(n=(n=n.replace($," ")).replace(ee," "));var l=e.nodeName.toLowerCase();if(Fe(l,o,n))try{u?e.setAttributeNS(u,p,n):e.setAttribute(p,n),d.removed.pop()}catch(e){}}}Be("afterSanitizeAttributes",e,null)}},Ge=function e(t){var n=void 0,o=je(t);for(Be("beforeSanitizeShadowDOM",t,null);n=o.nextNode();)Be("uponSanitizeShadowNode",n,null),ze(n)||(n.content instanceof D&&e(n.content),Ve(n));Be("afterSanitizeShadowDOM",t,null)};return d.sanitize=function(e,t){var n=void 0,o=void 0,r=void 0,i=void 0,s=void 0;if(e||(e="\x3c!--\x3e"),"string"!=typeof e&&!We(e)){if("function"!=typeof e.toString)throw new TypeError("toString is not a function");if("string"!=typeof(e=e.toString()))throw new TypeError("dirty is not a string, aborting")}if(!d.isSupported){if("object"===I(a.toStaticHTML)||"function"==typeof a.toStaticHTML){if("string"==typeof e)return a.toStaticHTML(e);if(We(e))return a.toStaticHTML(e.outerHTML)}return e}if(_e||ke(t),d.removed=[],Te);else if(e instanceof R)1===(o=(n=Ue("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===o.nodeName||"HTML"===o.nodeName?n=o:n.appendChild(o);else{if(!we&&!me&&!ve&&Ee&&-1===e.indexOf("<"))return G?G.createHTML(e):e;if(!(n=Ue(e)))return we?null:H}n&&ye&&Re(n.firstChild);for(var c=je(Te?e:n);r=c.nextNode();)3===r.nodeType&&r===i||ze(r)||(r.content instanceof D&&Ge(r.content),Ve(r),i=r);if(i=null,Te)return e;if(we){if(be)for(s=Q.call(n.ownerDocument);n.firstChild;)s.appendChild(n.firstChild);else s=n;return Se&&(s=Z.call(l,s,!0)),s}var p=ve?n.outerHTML:n.innerHTML;return me&&(p=(p=p.replace($," ")).replace(ee," ")),G&&Ee?G.createHTML(p):p},d.setConfig=function(e){ke(e),_e=!0},d.clearConfig=function(){xe=null,_e=!1},d.isValidAttribute=function(e,t,n){xe||ke({});var o=e.toLowerCase(),r=t.toLowerCase();return Fe(o,r,n)},d.addHook=function(e,t){"function"==typeof t&&(X[e]=X[e]||[],X[e].push(t))},d.removeHook=function(e){X[e]&&X[e].pop()},d.removeHooks=function(e){X[e]&&(X[e]=[])},d.removeAllHooks=function(){X={}},d}()}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4),r=function(){function e(e){this.baseOptions=e,this.resizeListener=this.handleResize.bind(this),window.addEventListener("resize",this.resizeListener)}return e.prototype.attachAndAnimateEntry=function(){var e=this;return this.attach().then((function(){return e.performEntryAnimation()}))},e.prototype.performEntryAnimation=function(){var e=this,t=this.animationElement;return t&&t.animate?(this.dimBackgroundElement&&this.dimBackgroundElement.animate([{opacity:0},{opacity:1}],{duration:250}),new Promise((function(n){var r;switch(e.baseOptions.entryAnimation){case o.EntryAnimation.FADE_IN:r=t.animate([{opacity:0},{opacity:1}],{duration:250});break;case o.EntryAnimation.SLIDE_IN_FROM_BOTTOM:var i=t.clientHeight;r=t.animate([{transform:"translateY("+Math.round(i)+"px)"},{transform:"translateX(0)"}],{duration:250});break;case o.EntryAnimation.SLIDE_IN_FROM_LEFT:i=-t.clientWidth,r=t.animate([{transform:"translateX("+Math.round(i)+"px)"},{transform:"translateX(0)"}],{duration:250});break;case o.EntryAnimation.SLIDE_IN_FROM_RIGHT:i=t.clientWidth,r=t.animate([{transform:"translateX("+Math.round(i)+"px)"},{transform:"translateX(0)"}],{duration:250});break;case o.EntryAnimation.SLIDE_IN_FROM_TOP:i=-t.clientHeight,r=t.animate([{transform:"translateY("+Math.round(i)+"px)"},{transform:"translateX(0)"}],{duration:250});break;default:n()}r&&(r.onfinish=r.oncancel=function(){return n()})}))):Promise.resolve()},e.prototype.performExitAnimation=function(){var e=this,t=this.animationElement;return t&&t.animate?(this.dimBackgroundElement&&this.dimBackgroundElement.animate([{opacity:0}],{duration:250}),new Promise((function(n){var r;switch(e.baseOptions.exitAnimation){case o.ExitAnimation.FADE_OUT:r=t.animate([{opacity:0}],{duration:250});break;case o.ExitAnimation.SLIDE_OUT_DOWN:var i=t.clientHeight;r=t.animate([{transform:"translateY("+Math.round(i)+"px)"}],{duration:250});break;case o.ExitAnimation.SLIDE_OUT_LEFT:i=-t.clientWidth,r=t.animate([{transform:"translateX("+Math.round(i)+"px)"}],{duration:250});break;case o.ExitAnimation.SLIDE_OUT_RIGHT:i=t.clientWidth,r=t.animate([{transform:"translateX("+Math.round(i)+"px)"}],{duration:250});break;case o.ExitAnimation.SLIDE_OUT_TOP:i=-t.clientHeight,r=t.animate([{transform:"translateY("+Math.round(i)+"px)"}],{duration:250});break;default:n()}r&&(r.onfinish=r.oncancel=function(){return n()})}))):Promise.resolve()},Object.defineProperty(e.prototype,"isLandscape",{get:function(){return window.innerWidth>=window.innerHeight},enumerable:!0,configurable:!0}),e.prototype.destroy=function(){window.removeEventListener("resize",this.resizeListener)},e.prototype.click=function(e,t){var n=this;this.active&&(this.clickCallback&&this.clickCallback(e,t),this.performExitAnimation().then((function(){return n.detach()})),this.destroy())},e.prototype.dismiss=function(e){var t=this;this.active&&(this.dismissType=e,this.dismissCallback&&this.dismissCallback(e),this.performExitAnimation().then((function(){return t.detach()})),this.destroy())},e}();t.Controller=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(7);t.MatchAllCriterionNode=class extends o.ASTCriterionNode{constructor(e){super(e)}accept(e){return e.visitMatchAllCriterionNode(this)}},t.AndCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.children=t}accept(e){return e.visitAndCriterionNode(this)}},t.OrCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.children=t}accept(e){return e.visitOrCriterionNode(this)}},t.NotCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.child=t}accept(e){return e.visitNotCriterionNode(this)}},t.SegmentCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.segmentId=t}accept(e){return e.visitSegmentCriterionNode(this)}},t.LastActivityDateCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.dateComparison=t}accept(e){return e.visitLastActivityDateCriterionNode(this)}},t.PresenceCriterionNode=class extends o.ASTCriterionNode{constructor(e,t,n,o){super(e),this.present=t,this.sinceDateComparison=n,this.elapsedTimeComparison=o}accept(e){return e.visitPresenceCriterionNode(this)}},t.JoinCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.child=t}accept(e){return e.visitJoinCriterionNode(this)}},t.EqualityCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.value=t}accept(e){return e.visitEqualityCriterionNode(this)}},t.AllCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.values=t}accept(e){return e.visitAllCriterionNode(this)}},t.AnyCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.values=t}accept(e){return e.visitAnyCriterionNode(this)}},t.ComparisonCriterionNode=class extends o.ASTCriterionNode{constructor(e,t,n){super(e),this.comparator=t,this.value=n}accept(e){return e.visitComparisonCriterionNode(this)}},t.PrefixCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.value=t}accept(e){return e.visitPrefixCriterionNode(this)}},t.InsideCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.value=t}accept(e){return e.visitInsideCriterionNode(this)}},t.GeoCriterionNode=class extends o.ASTCriterionNode{constructor(e,t,n){super(e),this.locationComparison=t,this.dateComparison=n}accept(e){return e.visitGeoCriterionNode(this)}},t.SubscriptionStatusCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.subscriptionStatus=t}accept(e){return e.visitSubscriptionStatusCriterionNode(this)}},t.PushUnsupportedCriterionNode=class extends o.ASTCriterionNode{constructor(e,t){super(e),this.pushUnsupported=t}accept(e){return e.visitPushUnsupportedCriterionNode(this)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(7);t.NullValueNode=class extends o.ASTValueNode{constructor(e){super(e,null)}accept(e){return e.visitNullValueNode(this)}},t.BooleanValueNode=class extends o.ASTValueNode{accept(e){return e.visitBooleanValueNode(this)}},t.NumberValueNode=class extends o.ASTValueNode{accept(e){return e.visitNumberValueNode(this)}},t.StringValueNode=class extends o.ASTValueNode{accept(e){return e.visitStringValueNode(this)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(9);class r{constructor(e,t,n,o,r,i,a,s){this.positive=e,this.years=t,this.months=n,this.weeks=o,this.days=r,this.hours=i,this.minutes=a,this.seconds=s}static parse(e){if("string"!=typeof e)throw new o.BadInputError('"PT" ISO 8601 duration expects a string');const t="\\d+(?:(?:[.,])\\d*)?",n=new RegExp(`^([+-])?P(${t}Y)?(${t}M)?(${t}W)?(${t}D)?(?:T(${t}H)?(${t}M)?(${t}S)?)?$`).exec(e);if(null===n)throw new o.BadInputError('invalid "PT" ISO 8601 duration given');const i="-"!==n[1],a=e=>parseFloat((n[e]||"").replace(",","."))||0,s=a(2),c=a(3),p=a(4),u=a(5),d=a(6),l=a(7),f=a(8);return new r(i,s,c,p,u,d,l,f)}applyTo(e){const t=this.positive?1:-1,n=e.getUTCFullYear()+t*this.years,o=e.getUTCMonth()+t*this.months,r=e.getUTCDate()+t*(7*this.weeks+this.days),i=e.getUTCHours()+t*this.hours,a=e.getUTCMinutes()+t*this.minutes,s=e.getUTCSeconds()+e.getUTCMilliseconds()/1e3+t*this.seconds,c=Math.trunc(s),p=Math.round(1e3*(s-c));return new Date(Date.UTC(n,o,r,i,a,c,p))}}t.ISO8601Duration=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoLocation=class{constructor(e,t){this.lat=e,this.lon=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class o{constructor(e,t,n,o){this.top=e,this.right=t,this.bottom=n,this.left=o}static fromTopRightBottomLeft(e,t,n,r){return new o(e,t,n,r)}static fromTopRightAndBottomLeft(e,t){return new o(e.lat,e.lon,t.lat,t.lon)}static fromTopLeftAndBottomRight(e,t){return new o(e.lat,t.lon,t.lat,e.lon)}}t.GeoBox=o},function(e,t,n){"use strict";n.r(t),n.d(t,"WorkerMessengerCommand",(function(){return o})),n.d(t,"registerListeners",(function(){return r}));const o={AMP_SUBSCRIPTION_STATE:"amp-web-push-subscription-state",AMP_SUBSCRIBE:"amp-web-push-subscribe",AMP_UNSUBSCRIBE:"amp-web-push-unsubscribe"};function r(e,t){const n=e();t("message",e=>{const{command:t}=e.data;switch(t){case o.AMP_SUBSCRIPTION_STATE:n.then(e=>{!function(e){let t=null;Promise.all([self.registration.pushManager.getSubscription().then(e=>(t=e,e?self.registration.pushManager.permissionState(e.options):null)),e.getManuallyUnsubscribed()]).then(([e,n])=>{if(null==e||n)i(o.AMP_SUBSCRIPTION_STATE,!1);else{const n=!!t&&"granted"===e;i(o.AMP_SUBSCRIPTION_STATE,n)}})}({getManuallyUnsubscribed:e.getManuallyUnsubscribed})});break;case o.AMP_SUBSCRIBE:n.then(e=>{e={applicationServerKey:e.applicationServerKey,onSubscribe:e.onSubscribe},self.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e.applicationServerKey}).then(t=>e.onSubscribe(t)).then(()=>{i(o.AMP_SUBSCRIBE,null)})});break;case o.AMP_UNSUBSCRIBE:n.then(e=>{!function(e){e&&e.onUnsubscribe&&e.onUnsubscribe().then(()=>{i(o.AMP_UNSUBSCRIBE,null)})}({onUnsubscribe:e.onUnsubscribe})})}})}function i(e,t){self.clients.matchAll().then(n=>{for(let o=0;o<n.length;o++)n[o].postMessage({command:e,payload:t})})}},function(e,t,n){var o;void 0===(o=function(){return function(e){var t=function(){var e=JSON.parse(JSON.stringify(n));return delete e._mergeStoredOptions,delete e._mode,delete e._popup,delete e._hiddenFrame,delete e._syncInit,e},n=JSON.parse(JSON.stringify(e._protected.options||{})),o=t();Object.freeze(o),delete e._protected.options;var r=new e._protected.Promise.Deferred;return e._protected.Options=new function(){var i=!1,a={webKey:!0,_mode:!0,_hiddenFrame:!0,_popup:!0};function s(t,o){return i||t in a||e._protected.Helper.warn("[options     ]",new e._protected.Errors.InternalOptionsNotYetAvailableError("Option "+t+" read before options get filled")),e._protected.Helper.plainObjectCopy(t in n?n[t]:o)}function c(e){delete n[e]}e.preInstantiationPromise.then((function(){e._protected.Storage.getModuleInitializationPromise().then((function(){return e._protected.Storage.isDefaultContainerAvailable()?e._protected.RunModes.Behaviors.ModeServiceWorker||!0===n._mergeStoredOptions?e._protected.Storage.get("options",{webKey:n.webKey}).then((function(r){e._protected.Helper.mergeObjectInplaceRecursive(r,n),!0===(n=r)._mergeStoredOptions&&(o=t(),Object.freeze(o))})):void 0:(i=!0,void r.resolve())})).then((function(){i=!0,e._protected.Helper._debugResolved()})).then((function(){if(e._protected.RunModes.Behaviors.ModeFrame||e._protected.RunModes.Behaviors.ModeWebSite&&e._protected.Integration.isOnRightDomain())return e._protected.Storage.set("options",o).then((function(){}))})).then(()=>{r.resolve()})})),this.get=s,this.getModuleInitializationPromise=function(){return r.promise},this.exportCurrent=t,this.exportInitial=function(){return e._protected.Helper.plainObjectCopy(o)},this.merge=function(t,o){n=e._protected.Options._merge3Way(JSON.parse(JSON.stringify(t||{})),JSON.parse(JSON.stringify(n||{})),JSON.parse(JSON.stringify(o||{})))},this._merge3Way=function(t,o,r){var i=JSON.parse(JSON.stringify(t));return e._protected.Helper.mergeObjectInplaceRecursive(i,JSON.parse(JSON.stringify(n))),e._protected.Helper.mergeObjectInplaceRecursive(i,JSON.parse(JSON.stringify(r))),i},this.isDebug=function(){return!!s("debug",!1)},this.getFrameUrl=function(){return s("frameUrl",e._protected.Constants.FRAME_URL)},this.getServiceWorkerUrl=function(){return s("serviceWorkerUrl",e._protected.Constants.SERVICE_WORKER_URL)},this.getWebKey=function(){return s("webKey")},this.getTranslations=function(){return s("translations")||{}},this.getServiceWorkerScope=function(){return s("serviceWorkerScope")},this.getRedirectionPageUrl=function(t){var n=s("redirectionPageUrl",e._protected.Constants.REDIRECT_URL);return t&&(n=n.replace("${url}",encodeURIComponent(t))),n},this.get_mode=function(){return void 0===s("_mode")?e._protected.gscope.ServiceWorkerGlobalScope?e._protected.RunModes.Modes.ServiceWorker:e._protected.Options.get_hiddenFrame()?e._protected.RunModes.Modes.Frame:e._protected.Options.get_popup()?e._protected.RunModes.Modes.Popup:e._protected.RunModes.Modes.WebSite:s("_mode")},this.remove_mode=function(){return e._protected.Options.remove_hiddenFrame(),e._protected.Options.remove_popup(),c("_mode")},this.get_hiddenFrame=function(){return s("_hiddenFrame")},this.remove_hiddenFrame=function(){return c("_hiddenFrame")},this.get_popup=function(){return s("_popup")},this.remove_popup=function(){return c("_popup")},this.getLanguage=function(){return s("language")}},e._protected.RunModes.setCurrentMode(e._protected.Options.get_mode()),e._protected.Options.remove_mode(),r.promise}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t=e._protected.Options._merge3Way;e._protected.Options._merge3Way=function(n,o,r){var i=t(n,o,r);return i.plugins=e._protected.Plugins.mergeOptionsPlugins(n.plugins||{},o.plugins||{},r.plugins||{}),i},e._protected.Options.getRequiresUserConsent=function(){return e._protected.Options.get("requiresUserConsent")||!1},e._protected.Options.getStylesheetUrl=function(){return e._protected.Options.get("stylesheetUrl")},e._protected.Options.getCustomDomain=function(){return e._protected.Options.get("customDomain")},e._protected.Options.getServiceWorkerUrl=function(){var t=e._protected.Options.get("serviceWorkerUrl",e._protected.Constants.SERVICE_WORKER_URL);return t.replace("${webKey}",encodeURIComponent(e._protected.Options.getWebKey()))},e._protected.Options.getManifestUrl=function(){return e._protected.Options.get("manifestUrl",e._protected.Constants.MANIFEST_URL)},e._protected.Options.getUserId=function(){return e._protected.Options.get("userId",null)},e._protected.Options.getApiUrlPrefix=function(){return"https://"+e._protected.Options.get("_rootApiUrl",e._protected.Constants.ROOT_API_URL)+"/"+e._protected.Options.get("_apiVersion",e._protected.Constants.API_VERSION)},e._protected.Options.getMeasurementsApiUrlPrefix=function(){let t=e._protected.Options.get("_measurementApiUrl",e._protected.Constants.MEASUREMENTS_API_BASE_URL);return t.replace(/\/*$/,"")},e._protected.Options.getApplicationVersion=function(){return e._protected.Options.get("applicationVersion")},e._protected.Options.getIntegrator=function(){return e._protected.Options.get("integrator")},e._protected.Options.getGeolocation=function(){return e._protected.Options.get("geolocation","auto")},e._protected.Options.getNotificationIcon=function(){return e._protected.Options.get("notificationIcon")},e._protected.Options.getDefaultNotificationUrl=function(){return e._protected.Options.get("notificationDefaultUrl")},e._protected.Options.getApplicationName=function(){return e._protected.Options.get("applicationName",location.hostname)},e._protected.Options.getOptInOptions=function(){return e._protected.Options.get("optInOptions",{})},e._protected.Options.getPlugins=function(){return e._protected.Options.get("plugins")},e._protected.Options.getSubscriptionOptions=function(){return e._protected.Options.get("subscriptionOptions",{})},e._protected.Options.getApplicationServerKey=function(){return e._protected.Options.get("applicationServerKey")},e._protected.Options.getAllowedSubscriptionDomains=function(){return e._protected.Options.get("allowedSubscriptionDomains")}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t,n=!1,o=e.prototype.SessionState.INIT_UNSTARTED,r=new Promise((function(t,n){var o=function(n){"session"===(n.detail||{}).name&&n.detail.state===e.this.SessionState.INIT_SUCCESS&&(t(),e._protected.Events.unlisten(o))};e._protected.Events.listen(o)})),i=function(){if(!e._protected.Init.isInitialized()){var t=function(){n=!0,a(e.this.SessionState.INIT_SUCCESS)},o=function(){a(e.this.SessionState.INIT_FAILED)};e._protected.Blocker.category("accessToken").add("initNeedsConfig"),e._protected.Config.getModuleInitializationPromise().then(()=>{e._protected.Integration.isOnRightDomain()&&e._protected.Blocker.category("accessToken").remove("isOnRightDomain"),e._protected.RunModes.Behaviors.CoreProperties&&e._protected.Installation.updateInstallationCoreProperties()}),e._protected.Config.getModuleInitializationPromise().then((function(){e._protected.RunModes.Behaviors.AccessToken&&e._protected.Integration.isOnRightDomain()&&(a(e.this.SessionState.INIT_INPROGRESS),e.instantiationPromise.then((function(){e._protected.Init.fetchAccessTokenIfNeeded(e._protected.Options.getUserId(),t,o)}))),e._protected.Blocker.category("accessToken").remove("initNeedsConfig")}))}e._protected.Blocker.category("ready").remove("init")};e._protected.Init.isInitialized=function(){return n},e._protected.Init.getSessionState=function(){return o};var a=function(n){t!==(o=n)&&(t=o,e._protected.Events.fire(e._protected.Events.WonderPushSessionEvent(e._protected.Init.getSessionState())),e._protected.RunModes.Behaviors.ModeFrame&&e._protected.Init.setSessionStateOnParentWindow(n),n===e.prototype.SessionState.INIT_SUCCESS&&((e._protected.RunModes.Behaviors.ModeFrame||e._protected.RunModes.Behaviors.ModeWebSite&&e._protected.Integration.isOnRightDomain())&&e._protected.Helper.supportsServiceWorker()&&e._protected.Init.setSessionStateOnServiceWorker(n),e._protected.RunModes.Behaviors.ModeServiceWorker&&e._protected.Init.setSessionStateOnServiceWorkerClients(n)))};e._protected.Init.setSessionStateOnParentWindow=e._protected.Integration.proxifyToParentWindow("WonderPushSDK._protected.Init.setSessionStateOnParentWindow",(function(e){a(e)})),e._protected.Init.setSessionStateOnServiceWorker=e._protected.Integration.proxifyToServiceWorker("WonderPushSDK._protected.Init.setSessionStateOnServiceWorker",(function(e){a(e)})),e._protected.Init.setSessionStateOnServiceWorkerClients=e._protected.Integration.proxifyToServiceWorkerClients("WonderPushSDK._protected.Init.setSessionStateOnServiceWorkerClients",(function(e){a(e)})),e.prototype.getInitializationPromise=function(){return r},e._protected.Init.getDeviceId=function(){return e._protected.Storage.get("deviceId",null).then((function(t){if(t)return t;var n=e._protected.Helper.uuidv4()+"-"+(+new Date).toString(16);return e._protected.Storage.set("deviceId",n).then((function(){return n}))}))},e._protected.Init.getFederatedDeviceId=function(){const t=e._protected.Helper.detectBrowser();return t&&"Safari"===t.name?Promise.resolve(null):e._protected.Storage.get("federatedDeviceId",null).then((function(t){return t||(e._protected.RunModes.Behaviors.ContextWindow?new Promise((function(t){e._protected.Integration.isOnFederatedDomain()?t(e._protected.Helper.uuidv4()+"-"+(+new Date).toString(16)):t(e._protected.Federated.call("WonderPushSDK._protected.Init.getFederatedDeviceId",[]))})).then((function(t){return e._protected.Promise.catchNoop(e._protected.Storage.set("federatedDeviceId",t)).then((function(){return t}))})):null)}))},e._protected.Blocker.category("accessToken").wait().then((function(){e._protected.Init.fetchAccessTokenIfNeeded(e._protected.Options.getUserId())}));var s={},c=function(e,t,n,o){for(var r=0;r<e.length;++r)e[r][t].call(n,o);e.splice(0)};e._protected.Init.fetchAccessTokenIfNeeded=function(t,n,o){e._protected.RunModes.Behaviors.AccessToken&&e._protected.Integration.isOnRightDomain()?e._protected.Consent.awaitUserConsent().then(()=>{var r=function(){};"function"!=typeof n&&(n=r),"function"!=typeof o&&(o=r),s[t]||(s[t]=[]),s[t].push({onload:n,onerror:o}),e._protected.Blocker.category("accessToken").unblocked()&&(n=function(){c(s[t],"onload",this)},o=function(){c(s[t],"onerror",this)},e._protected.Session.getSession(t).then((function(r){if(r&&r.accessToken&&r.installationId)setTimeout(n,0);else{var i=new e._protected.Locking.ExpiringUnfairNamedGlobalMutex("fetchAccessToken:userId="+(t||""),3e4);i.tryAcquire().then((function(){var r=new e._protected.Promise.Deferred;i.renewWhile({interval:15e3,release:!0},r.promise),e._protected.Promise.catchNoop(r.promise),function(t,n){e._protected.RunModes.Behaviors.AccessToken&&e._protected.Integration.isOnRightDomain()?e._protected.Init.getDeviceId().then((function(o){var r={clientId:e._protected.Options.getWebKey(),devicePlatform:"Web",deviceId:o,userId:t};r.userId||delete r.userId,e._protected.Rest.post(t,"/authentication/accessToken",r,void 0,n)}),(function(e){console.warn("Failed to read deviceId",e),n.onerror&&n.onerror.call(null,e)})):console.error("fetchAccessToken should not be called from this mode")}(t,{onload:function(t){e._protected.Promise.do(function(t){var o=function(t){var o=(t=t||{}).token||null,r=(t.data||{}).sid||null,a=(t.data||{}).installationId||null,s=(t.data||{}).userId||null;return o&&a?i.renew().then((function(){var i=[];return t._installation instanceof Object&&i.push(e._protected.JsonSyncInstallationCustom.receiveStateForUser(s,t._installation.custom||{},!1)),i.push(e._protected.Session.setSession({accessToken:o,sid:r,installationId:a,userId:s})),Promise.all(i).then((function(){setTimeout((function(){n()}),0)}))}),(function(){return Promise.reject()})):Promise.reject("invalid access token")};return"function"==typeof Response&&t instanceof Response?t.json().then(o):o(this.responseJSON)}.call(this,t),r.resolve).catch((function(e){o.call(this,e)}))},onerror:function(e){r.reject(e),o.call(this,e)}})}),(function(){setTimeout((function(){e._protected.Init.fetchAccessTokenIfNeeded(t,null,null)}),2e3)}))}})))}):console.error("fetchAccessToken should not be called from this mode")},e._protected.Blocker.category("ready").add("init"),e._protected.RunModes.Behaviors.AccessToken||e._protected.Blocker.category("accessToken").add("mode"),e._protected.Blocker.category("accessToken").add("isOnRightDomain"),setTimeout((function(){e.preInstantiationPromise.then(i)}),0)}}.apply(t,[]))||(e.exports=o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(4);t.EventRateLimits=[{limit:1,timeToLive:6e4,eventType:o.SystemEvent.ON_FOREGROUND,key:"system-event"},{limit:1,timeToLive:6e4,eventType:o.SystemEvent.APP_LAUNCH,key:"system-event"},{limit:1,timeToLive:6e4,eventType:o.SystemEvent.ON_EXIT,key:"system-event"}]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){}return e.makeCloseButton=function(){var e=document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("height","24"),e.setAttribute("width","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("class","wpiam-cancel-button"),e.innerHTML='<circle fill="#FFFFFF" cx="12" cy="12" r="8"/><path d="M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12 17 15.59z" /><path d="M0 0h24v24H0z" fill="none" />',e},e}();t.DisplayHelper=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(7),r=n(14);t.DateValueNode=class extends o.ASTValueNode{constructor(e,t){super(e,t)}accept(e){return e.visitDateValueNode(this)}},t.RelativeDateValueNode=class extends o.ASTValueNode{constructor(e,t){super(e,Number.NaN),this.duration=t}get value(){return this.duration.applyTo(new Date).getTime()}set value(e){}accept(e){return e.visitRelativeDateValueNode(this)}},t.DurationValueNode=class extends o.ASTValueNode{constructor(e,t){if(t instanceof r.ISO8601Duration){const n=new Date;super(e,t.applyTo(n).getTime()-n.getTime())}else super(e,t)}accept(e){return e.visitDurationValueNode(this)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(7);t.GeoLocationValueNode=class extends o.ASTValueNode{accept(e){return e.visitGeoLocationValueNode(this)}};class r extends o.ASTValueNode{}t.GeoAbstractAreaValueNode=r,t.GeoBoxValueNode=class extends r{accept(e){return e.visitGeoBoxValueNode(this)}},t.GeoCircleValueNode=class extends r{accept(e){return e.visitGeoCircleValueNode(this)}},t.GeoPolygonValueNode=class extends r{accept(e){return e.visitGeoPolygonValueNode(this)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class o extends Error{constructor(e,t,n){super("Parser already exists for key "+JSON.stringify(e)),this.key=e,this.oldParser=t,this.newParser=n}}t.CriterionParserAlreadyExistsForKey=o,t.ConfigurableCriterionNodeParser=class{constructor(){this.exactNameParsers=new Map,this.dynamicNameParsers=[]}registerExactNameParser(e,t){const n=this.exactNameParsers.get(e);if(void 0!==n)throw new o(e,n,t);this.exactNameParsers.set(e,t)}registerDynamicNameParser(e){this.dynamicNameParsers.push(e)}parseCriterion(e,t,n){const o=this.exactNameParsers.get(t);if(void 0!==o)return o(e,t,n);for(let o=0,r=this.dynamicNameParsers.length;o<r;++o){const r=(0,this.dynamicNameParsers[o])(e,t,n);if(null!==r)return r}return null}};class r extends Error{constructor(e,t,n){super("Parser already exists for key "+JSON.stringify(e)),this.key=e,this.oldParser=t,this.newParser=n}}t.ValueParserAlreadyExistsForKey=r,t.ConfigurableValueNodeParser=class{constructor(){this.exactNameParsers=new Map,this.dynamicNameParsers=[]}registerExactNameParser(e,t){const n=this.exactNameParsers.get(e);if(void 0!==n)throw new r(e,n,t);this.exactNameParsers.set(e,t)}registerDynamicNameParser(e){this.dynamicNameParsers.push(e)}parseValue(e,t,n){const o=this.exactNameParsers.get(t);if(void 0!==o)return o(e,t,n);for(let o=0,r=this.dynamicNameParsers.length;o<r;++o){const r=(0,this.dynamicNameParsers[o])(e,t,n);if(null!==r)return r}return null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(9),r=n(15),i=n(16);class a{constructor(e,t,n,o,r){this.geohash=e,this.top=t,this.right=n,this.bottom=o,this.left=r}static parse(e){if("string"!=typeof e)throw new o.BadInputError('"geohash" expects a string');e=e.toLowerCase();let t,n=!0,r=a.MAX_LAT,i=a.MIN_LAT,s=a.MAX_LON,c=a.MIN_LON;for(let p=0,u=e.length;p<u;p++){const u=e[p],d=a.BASE32_CODES_DICT[u];if(void 0===d)throw new o.BadInputError('character "'+u+'" is not valid in a geohash');for(let e=4;e>=0;e--){const o=d>>e&1;n?(t=(s+c)/2,1===o?c=t:s=t):(t=(r+i)/2,1===o?i=t:r=t),n=!n}}return new a(e,r,s,i,c)}get centerLat(){return(this.top+this.bottom)/2}get centerLon(){return(this.left+this.right)/2}getTopLeft(){return new r.GeoLocation(this.top,this.left)}getTopRight(){return new r.GeoLocation(this.top,this.right)}getBottomLeft(){return new r.GeoLocation(this.bottom,this.left)}getBottomRight(){return new r.GeoLocation(this.bottom,this.right)}toGeoLocation(){return new r.GeoLocation(this.centerLat,this.centerLon)}toGeoBox(){return i.GeoBox.fromTopRightBottomLeft(this.top,this.right,this.bottom,this.left)}}t.Geohash=a,a.BASE32_CODES="0123456789bcdefghjkmnpqrstuvwxyz",a.BASE32_CODES_DICT=(()=>{const e={};for(let t=0;t<a.BASE32_CODES.length;t++)e[a.BASE32_CODES.charAt(t)]=t;return e})(),a.MIN_LAT=-90,a.MAX_LAT=90,a.MIN_LON=-180,a.MAX_LON=180},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoCircle=class{constructor(e,t){this.center=e,this.radiusMeters=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GeoPolygon=class{constructor(e){this.points=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class o{constructor(e){this.parts=e}static parse(e){return new o(e.split("."))}}t.FieldPath=o;class r{constructor(e){this.parent=e}getRootDataSource(){return null===this.parent?this:this.parent.getRootDataSource()}}t.DataSource=r,t.UserSource=class extends r{constructor(){super(null)}getName(){return"user"}accept(e){return e.visitUserSource(this)}},t.InstallationSource=class extends r{constructor(){super(null)}getName(){return"installation"}accept(e){return e.visitInstallationSource(this)}},t.EventSource=class extends r{constructor(){super(null)}getName(){return"event"}accept(e){return e.visitEventSource(this)}};class i extends r{constructor(e,t){super(e),this.path=t}getName(){return this.parent.getName()+"."+this.path.parts.join(".")}fullPath(){let e=this;const t=[];for(;null!==e;)e instanceof i&&t.unshift(...e.path.parts),e=e.parent;return new o(t)}accept(e){return e.visitFieldSource(this)}}t.FieldSource=i,t.LastActivityDateSource=class extends r{constructor(e){super(e)}getName(){return"lastActivityDate"}accept(e){return e.visitLastActivityDateSource(this)}},t.PresenceSinceDateSource=class extends r{constructor(e,t){super(e),this.present=t}getName(){return"presence.sinceDate"}accept(e){return e.visitPresenceSinceDateSource(this)}},t.PresenceElapsedTimeSource=class extends r{constructor(e,t){super(e),this.present=t}getName(){return"presence.elapsedTime"}accept(e){return e.visitPresenceElapsedTimeSource(this)}},t.GeoLocationSource=class extends r{constructor(e){super(e)}getName(){return"geo.location"}accept(e){return e.visitGeoLocationSource(this)}},t.GeoDateSource=class extends r{constructor(e){super(e)}getName(){return"geo.date"}accept(e){return e.visitGeoDateSource(this)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(7),r=n(12),i=n(9),a=n(13),s=n(31);t.SegmentationDSLParser=class{constructor(e){this.parserConfig=e}parse(e,t){const n=new s.ParsingContext(this,null,t);return this.parseCriterion(n,e)}parseCriterion(e,t){if(null===t||"object"!=typeof t||Array.isArray(t))throw new i.BadInputError("Expects an object");if(0===Object.keys(t).length){if(e.dataSource.getRootDataSource()!==e.dataSource)throw new i.BadInputError("Missing data criterion");return new r.MatchAllCriterionNode(e)}if(Object.keys(t).length>1)return new r.AndCriterionNode(e,Object.keys(t).map(n=>this.parseCriterion(e,{[n]:t[n]})));const n=Object.keys(t)[0];if(0===n.length)throw new i.BadInputError('Bad key ""');const a=t[n],s=this.parserConfig.criterionParser.parseCriterion(e,n,a);if(null===s){const t=new o.ASTUnknownCriterionNode(e,n,a);if(this.parserConfig.throwOnUnknownCriterion)throw new i.UnknownCriterionError(t);return t}return s}parseValue(e,t){if(null==t)return new a.NullValueNode(e);if("boolean"==typeof t)return new a.BooleanValueNode(e,t);if("number"==typeof t)return new a.NumberValueNode(e,t);if("string"==typeof t)return new a.StringValueNode(e,t);if(Array.isArray(t))throw new i.BadInputError("array values are not accepted");if("object"!=typeof t)throw new i.BadInputError(typeof t+" values are not accepted");const n=Object.keys(t);if(1!==n.length)throw new i.BadInputError("object values can only have 1 key defining their type");const r=n[0],s=t[r],c=this.parserConfig.valueParser.parseValue(e,r,s);if(null===c){const t=new o.ASTUnknownValueNode(e,r,s);if(this.parserConfig.throwOnUnknownValue)throw new i.UnknownValueError(t);return t}return c}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class o{constructor(e,t,n){this.parser=e,this.parentContext=t,this.dataSource=n}withDataSource(e){return new o(this.parser,this,e)}}t.ParsingContext=o},function(e,t,n){var o,r;o=[n(33),n(51),n(54),n(55),n(56),n(57),n(58),n(59),n(60),n(19),n(61),n(62),n(66),n(67),n(68),n(69),n(70),n(20),n(71),n(72),n(73),n(74),n(75),n(77),n(78),n(79),n(80),n(81),n(82),n(83),n(84),n(85),n(86),n(87),n(88),n(95),n(96),n(97),n(98),n(101)],void 0===(r=function(e,t,n,o,r,i,a,s,c,p,u,d,l,f,g,h,m,v,_,y,w,b,S,E,I,C,T,P,N,O,A,M,x,D,k,R,L,U,j,W){var B=Array.prototype.slice.call(arguments).slice(1);!function(t){"use strict";if(!t.WonderPush||"WonderPush"!==t.WonderPush.constructor.name){var n="undefined"!=typeof document?document.currentScript:null,o=!0,r=void 0,i=[];t.WonderPush&&(r=t.WonderPush?t.WonderPush.initOpts:void 0,i=Array.isArray(t.WonderPush)?t.WonderPush:Array.isArray(t.WonderPush.q)?t.WonderPush.q:[],o=!!t.ServiceWorkerGlobalScope);var a=s(location.search);o?c():setTimeout(c,0)}function s(e){var t={};if(e){"?"===e.charAt(0)&&(e=e.substring(1));for(var n=e.split("&"),o=0;o<n.length;++o){var r=n[o].split("=");r.length>2&&r.push(r.splice(1).join("=")),r[0]=decodeURIComponent(r[0]),r.length<2?r.push(null):r[1]=decodeURIComponent(r[1]),t[r[0]]=r[1]}}return t}function c(){var o=e(t,"WonderPush",B,{postInitFunctionNames:["setUserConsent"],preInstantiationCallback:e=>{e._protected.Api.proxifyPublicSDK(),e.this.init=o.init,e.this.ready=o.ready,e.this.push=o.ready,t.WonderPush=e.this,"permission"===a.wonderpushPopupUI&&e.this.push(e._protected.PopupUI.presentPermissionUI)}});if(t.WonderPush.push=o.ready,r)o.init(r);else{var c={};try{n&&(c=s(new URL(n.src).search))}catch(e){}var p=a.wonderpushWebKey||c.webKey,u=a.wonderpushUserId||c.userId,d=a.amp,l=a.wonderpushInitOpts||c.initOpts,f=a.wonderpushUI||a.wonderpushUi;(p||l)&&(l=l?JSON.parse(l):{},p&&(l.webKey=p),void 0!==u&&(l.userId=u),f&&(l._mode=l._mode||"popup"),"frame"===d&&(l._mode="frame"),"dialog"===d&&(l._mode="popup"),l._mergeStoredOptions=!0,WonderPush.init(l))}for(const e of i)o.ready(e)}}(self)}.apply(t,o))||(e.exports=r)},function(e,t,n){var o,r;o=[n(34),n(35),n(36),n(37),n(38),n(39),n(18),n(40),n(41),n(42),n(43),n(44),n(45),n(46),n(47),n(48),n(49),n(50),n(10)],void 0===(r=function(e,t,n,o,r,i,a,s,c,p,u,d,l,f,g,h,m,v,_){"use strict";return function(e,y,w,b={}){const S=new Set(b.postInitFunctionNames||[]),E=new function(){var I,C=!1,T=[],P=new Promise((function(e,t){I=e})),N=function(e){return setTimeout(()=>e.apply(O.this),0),P};this.ready=e=>{const t=new class{constructor(e){this.payload=e}get isValid(){return!(!Array.isArray(this.payload)||"string"!=typeof this.payload[0])||"function"==typeof this.payload}get functionName(){if(this.isValid&&Array.isArray(this.payload))return this.payload[0]}apply(e){if(this.isValid&&e){if("function"==typeof this.payload)return this.payload(e);if(Array.isArray(this.payload)){const t=Array.from(this.payload),n=t.shift(),o="function"==typeof t[t.length-1]?t.pop():()=>{};e[n]?Promise.resolve(e[n].apply(e,t)).then(e=>o(null,e),e=>o(e)):o(new TypeError(`${y}.${n} is not a function`))}}}}(e);return C?N(t):("init"===t.functionName?t.apply(E):S.has(t.functionName)?M.promise.then(()=>{t.apply(O.this)}):T.push(t),P)};var O=new function(){this._protected={gscope:e,sdkName:y},this.constructor=function(){},this.prototype=this.constructor.prototype,this.this=null};t(O),n(O);var A=new O._protected.Promise.Deferred;O.preInstantiationPromise=A.promise;var M=new O._protected.Promise.Deferred;O.instantiationPromise=M.promise;var x=[];O.readyCallback=function(){R(O.this)};var D=!1;this.init=function(t){return D?k(t):(D=!0,O._protected.options=t,x.push(o(O)),x.push(r(O)),x.push(i(O)),x.push(d(O)),x.push(s(O,b.additionalRunModes)),x.push(a(O)),x.push(u(O)),x.push(c(O)),x.push(l(O)),x.push(f(O)),x.push(p(O)),x.push(g(O)),x.push(h(O)),x.push(m(O)),x.push(v(O)),w.forEach((function(e){"function"==typeof e&&x.push(e(O))})),O.this=new O.constructor,A.resolve(),b.preInstantiationCallback&&b.preInstantiationCallback(O),Promise.all(x).then((function(){return M.resolve(),O}),(function(e){return console.error("SDK instantiation failed!",e),M.reject(e),O})).then((function(){O._protected.Options.isDebug()&&(e[y+"SDK"]=O)})),Promise.resolve())};var k=function(){O._protected.Helper.warn("[sdk         ]","extra call to init() dropped, sdk already instantialized!")},R=function(e){C=!0,I(e),T.forEach((function(e){N(e)})),T=[]},L=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")};(function(){var e=this.init.bind(this),t=this.ready.bind(this);if("undefined"!=typeof window){var n,o=y.toLowerCase();if(n=document.querySelector('HEAD>META[name="'+o+'-integration"]')){var r=(n.content||n.getAttribute("content")).trim().split(/\s*,\s*/);if(!(r.indexOf("frame")<0&&r.indexOf("popup")<0)){var i=!1;t((function(){i=!0})),window.addEventListener("message",(function(n){if(n.data instanceof Object&&n.data.sdk===y)switch(n.data.type){case"ping":n.ports&&n.ports.length>0&&n.ports[0].postMessage({type:"pong"});break;case"isReady":n.ports&&n.ports.length>0&&n.ports[0].postMessage({type:"readiness",ready:i});break;case"init":e(n.data.initOpts),t((function(){n.ports&&n.ports.length>0&&n.ports[0].postMessage({type:"ready"})}));break;case"display":for(var o=["text-content","main-content","whole-content"],r=[['onclick="window.close();"','data-onclickwindowclose="'+Math.random()+'"']],a=0;a<o.length;++a){var s=o[a];if(s in n.data){var c=n.data[s];r.forEach(([e,t])=>{c=c.replace(new RegExp(L(e),"g"),t)}),c=_.sanitize(c),r.forEach(([e,t])=>{c=c.replace(new RegExp(L(t),"g"),e)}),document.getElementById(s).innerHTML=c}}break;case"close":setTimeout((function(){window.close()}),n.data.sleep||0)}}))}}}}).bind(this)()};return e[y]||(e[y]={}),e[y].init=E.init.bind(E),e[y].ready=E.ready.bind(E),e[y]}}.apply(t,o))||(e.exports=r)},function(e,t,n){var o;void 0===(o=function(){var e;Function.prototype.bind||(Function.prototype.bind=function(e){var t=Array.prototype.slice.call(arguments,1),n=this,o=function(){},r=function(){return n.apply(this instanceof o?this:e,t.concat(Array.prototype.slice.call(arguments)))};return o.prototype=this.prototype,r.prototype=new o,r}),Object.freeze||(Object.freeze=function(e){return e}),"function"!=typeof Object.create&&(Object.create=(e=function(){},function(t){if(arguments.length>1)throw Error("Second argument not supported");if("object"!=typeof t)throw TypeError("Argument must be an object");e.prototype=t;var n=new e;return e.prototype=null,n}))}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Function={delay:function(e,t){var n=e;return function(){setTimeout(Function.prototype.bind.apply(n,[e].concat(Array.prototype.slice.call(arguments))),t)}}}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){if("undefined"!=typeof Promise){var t=function(){};e._protected.Promise={setIntervalUntilSettled:function(t,n,o,r,i){var a=!1,s=function(){a=!0},c=(t.then(s,s),function(){var i;if(!a)return r?i=n():r=!0,e._protected.Promise.catchNoop(Promise.all([i]).then((function(){return e._protected.Promise.catchNoop(Promise.race([t,new e._protected.Promise.DelayedStartPromise((function(e,t){e(c())}),o)]))})))});return i?c():setTimeout(c,0),t},DelayedResultPromise:function(t,n){return new Promise((function(o,r){return t(e._protected.Function.delay(o,n),e._protected.Function.delay(r,n))}))},DelayedStartPromise:function(e,t){return new Promise((function(n,o){var r=this;setTimeout((function(){try{e.call(r,n,o)}catch(e){o(e)}}),t)}))},Poll:function(t,n,o){var r=new e._protected.Promise.Deferred,i=+new Date,a=function(){if(+new Date-i>n)r.reject(new e.prototype.Errors.TimeoutError);else{var s;try{s=!!t()}catch(e){return void r.reject(e)}s?r.resolve():setTimeout(a,o)}};a(),this.wait=function(){return r.promise},this.cancel=function(){r.reject(new e.prototype.Errors.CancellationError)}},Deferred:function(){try{this.resolve=null,this.reject=null,this.promise=new Promise(function(e,t){this.resolve=e,this.reject=t}.bind(this)),Object.freeze(this)}catch(t){throw new e.prototype.Errors.InternalError("Promise/Deferred is not available")}},DynamicPromise:function(){let e,t,n;Object.defineProperty(this,"pending",{get:()=>!!t||!!n});let o=()=>{t=void 0,n=void 0};this.setPending=()=>{this.pending||(e=new Promise((e,r)=>{t=t=>{o(),e(t)},n=e=>{o(),r(e)}}))},this.setResolved=n=>{t&&this.pending?t(n):e=Promise.resolve(n)},this.setRejected=t=>{n&&this.pending?n(t):e=Promise.reject(t)},Object.defineProperty(this,"promise",{get:()=>e}),this.setPending()},allTimeout:function(t,n,o){var r={},i=t.map((function(){return o}));return e._protected.Promise.timeout(Promise.all(t.map((function(e,t){return e.then((function(e){i[t]=e}))}))),n,r).then((function(){return i}),(function(e){return e===r?Promise.resolve(i):Promise.reject(e)}))},delay:function(t,n){var o=t;return new e._protected.Promise.DelayedStartPromise((function(e,t){o.then(e,t)}),n)},timeout:function(t,n,o,r){return void 0===n?t:Promise.race([t,new e._protected.Promise.DelayedStartPromise((function(e,t){(r?e:t)(o)}),n)])},do:function(e,t){return e.then((function(e){try{t()}catch(e){}return Promise.resolve(e)}),(function(e){try{t()}catch(e){}return Promise.reject(e)}))},log:function(e,t){var n=t?function(e){console.log(t,e)}:function(e){console.log(e)};return e.then((function(e){return n(e),Promise.resolve(e)}),(function(e){return n(e),Promise.reject(e)}))},catchNoop:function(e){return e.catch(t)}}}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Blocker={};var t={};e._protected.Blocker.clearAllCategories=function(){t={}},e._protected.Blocker.category=function(n){var o=t[n]||new function(t){this.name=t;var n={},o=[],r=function(){const e=o.splice(0,o.length);setTimeout(()=>{e.forEach((function(e){e.resolve()}))},0)};this.add=function(e){n[e]=!0},this.remove=function(e){delete n[e],this.unblocked()&&r()},this.wait=function(){var t=new e._protected.Promise.Deferred;return o.push(t),this.unblocked()&&r(),t.promise},this.unblocked=function(){for(var e in n)if(n.hasOwnProperty(e))return!1;return!0}}(n);return t[n]=o,o}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e.prototype.Errors=new function(){this.Error=function(t){var n=e._protected.Helper.plainObjectCopy(new Error(t));delete n.name,e._protected.Helper.assign(this,n)},this.Error.prototype=Object.create(Error.prototype,{name:{value:e._protected.sdkName+"SDK.Errors.Error"},constructor:{value:this.Error}}),this.InternalError=function(t){e.prototype.Errors.Error.apply(this,arguments)},this.InternalError.prototype=Object.create(this.Error.prototype,{name:{value:e._protected.sdkName+"SDK.Errors.InternalError"},constructor:{value:this.InternalError}}),this.InvalidArgumentError=function(t){e.prototype.Errors.Error.apply(this,arguments)},this.InvalidArgumentError.prototype=Object.create(this.Error.prototype,{name:{value:e._protected.sdkName+"SDK.Errors.InvalidArgumentError"},constructor:{value:this.InvalidArgumentError}}),this.TimeoutError=function(t){e.prototype.Errors.Error.apply(this,arguments)},this.TimeoutError.prototype=Object.create(this.Error.prototype,{name:{value:"SDK.Errors.TimeoutError"},constructor:{value:this.TimeoutError}}),this.CancellationError=function(t){e.prototype.Errors.Error.apply(this,arguments)},this.CancellationError.prototype=Object.create(this.Error.prototype,{name:{value:"SDK.Errors.CancellationError"},constructor:{value:this.CancellationError}})},e._protected.Errors=new function(){this.InternalOptionsNotYetAvailableError=function(t){e.prototype.Errors.InternalError.apply(this,arguments)},this.InternalOptionsNotYetAvailableError.prototype=Object.create(e.prototype.Errors.InternalError.prototype,{name:{value:e._protected.sdkName+"SDK.Errors.InternalOptionsNotYetAvailableError"},constructor:{value:this.InternalOptionsNotYetAvailableError}}),this.InternalStorageError=function(t){e.prototype.Errors.InternalError.apply(this,arguments)},this.InternalStorageError.prototype=Object.create(e.prototype.Errors.InternalError.prototype,{name:{value:e._protected.sdkName+"SDK.Errors.InternalStorageError"},constructor:{value:this.InternalStorageError}}),this.InternalRPCTargetClosedError=function(t){e.prototype.Errors.InternalError.apply(this,arguments)},this.InternalRPCTargetClosedError.prototype=Object.create(e.prototype.Errors.InternalError.prototype,{name:{value:e._protected.sdkName+"SDK.Errors.InternalRPCTargetClosedError"},constructor:{value:this.InternalRPCTargetClosedError}})}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Constants={},e._protected.Constants.HOME_URL="https://example.com/",e._protected.Constants.CONFIG_URL_PATTERN="https://cdn.example.com/config/webkeys/${webkey}",e._protected.Constants.CONFIG_FETCH_MAX_TRIES=5,e._protected.Constants.SERVICE_WORKER_URL="serviceworker.js",e._protected.Constants.FRAME_URL="index.html",e._protected.Constants.REDIRECT_URL="redirect.html?url=${url}",e._protected.Constants.INTEGRATION_POPUP_DEFAULT_OPTIONS={resizable:0,toolbar:0,location:0,menubar:0,status:0,directories:0,personalbar:0,dependent:"yes",scrollbars:0,center:"window"},e._protected.Constants.WINDOW_LOAD_MAX_PAGELOAD_MS=6e4,e._protected.Constants.WINDOW_LOAD_SLOW_WARN_MS=1e4,e._protected.Constants.WINDOW_LOAD_CHECK_PAGELOADED_INTERVAL_MS_MIN=100,e._protected.Constants.WINDOW_LOAD_CHECK_PAGELOADED_INTERVAL_MS_MAX=1e3,e._protected.Constants.WINDOW_LOAD_CHECK_PAGELOADED_INTERVAL_MS_EXP=1.5,e._protected.Constants.REQUEST_TIMEOUT_MS=2e4,e._protected.Constants.REQUEST_VAULT_ERROR_WAIT_MS=2e4,e._protected.Constants.REQUEST_VAULT_RUNNING_JOB_TIMEOUT_MS=Math.round(1.1*e._protected.Constants.REQUEST_TIMEOUT_MS)+1e3,e._protected.Constants.REQUEST_VAULT_IDLE_WAIT_MS=2e4,e._protected.Constants.INTEGRATION_RPC_CHECK_TARGET_CLOSED_INTERVAL_MS=250,e._protected.Constants.AVAILABLE_LANGUAGES=["en"],e._protected.Constants.I18N_TRANSLATIONS={en:{}},e._protected.Constants.GOOGLE_ANALYTICS_USER_DATA_STORAGE_KEY="analyticsStorageKey",e._protected.Constants.GOOGLE_ANALYTICS_STORAGE_DATABASE_NAME=e._protected.sdkName+"_analytics",e.preInstantiationPromise.then((function(){e._protected.Helper.assign(e._protected.Constants,e.prototype.Constants),Object.freeze(e.prototype.Constants),Object.freeze(e._protected.Constants)}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e,t=[]){var n="[runmodes    ]";e._protected.RunModes=new function(){var t,o;this.Modes={},this.ModeParents={},this.ModeLogTags={},this.Behaviors={},this.BehaviorResolvers={},this.knownMode=function(e){return!!e&&Object.keys(this.Modes).some(function(t){return this.Modes.hasOwnProperty(t)&&this.Modes[t]===e}.bind(this))}.bind(this),this.registerMode=function(t,n,o,r){if(!t)throw new e.prototype.Errors.InternalError("Bad mode const name");if(!n)throw new e.prototype.Errors.InternalError("Bad mode value");if(t in this.Modes||this.knownMode(n))throw new e.prototype.Errors.InternalError("Mode already registered");this.Modes[t]=n,this.ModeLogTags[n]=o,this.knownMode(r)&&(this.ModeParents[n]=r),this.registerBehavior("Mode"+t,(function(e){return e===n}))}.bind(this),this.registerBehavior=function(t,n){if(!t)throw new e.prototype.Errors.InternalError("Bad behavior name");if(!(n instanceof Function))throw new e.prototype.Errors.InternalError("Bad behavior resolver");if(t in this.Behaviors)throw new e.prototype.Errors.InternalError("Behavior already registered");Object.defineProperty(this.Behaviors,t,{enumerable:!0,get:function(){return this.hasBehavior(t)}.bind(this)}),this.BehaviorResolvers[t]=n}.bind(this),this.setCurrentMode=function(n){if(void 0!==t)throw new e.prototype.Errors.InternalError("Current mode is already set");t=n,o={},e._protected.Helper.setLogRunMode(this.ModeLogTags[n])}.bind(this),this.getCurrentModeNotForBehaviorTestingPurpose=function(){return t}.bind(this),this.hasBehavior=function(r){if(!(r in o)){for(var i,a=t;void 0!==a&&void 0===i;){try{i=this.BehaviorResolvers[r](a)}catch(o){e._protected.Helper.error(n,"mode:",t,"behavior:",r,"error while resolving value using resolver",this.BehaviorResolvers[r],o)}a=this.ModeParents[a]}void 0===i&&e._protected.Helper.error(n,"mode:",t,"behavior:",r,"resolved value is undefined"),o[r]=i}return o[r]}.bind(this)},e._protected.RunModes.registerMode("WebSite","website","[website]"),e._protected.RunModes.registerMode("Frame","frame","[frame  ]"),e._protected.RunModes.registerMode("ServiceWorker","serviceworker","[sw     ]"),e._protected.RunModes.registerMode("Popup","popup","[popup  ]"),e._protected.RunModes.registerMode("Slave","slave","[slave  ]");for(const n of t)e._protected.RunModes.registerMode(`${n.charAt(0).toUpperCase()}${n.slice(1)}`,n,`[${n}]`);e._protected.RunModes.registerBehavior("ContextWindow",(function(){return!!e._protected.gscope.window})),e._protected.RunModes.registerBehavior("ContextServiceWorker",(function(){return!!e._protected.gscope.ServiceWorkerGlobalScope})),e._protected.RunModes.registerBehavior("ContextFrame",(function(t){return[e._protected.RunModes.Modes.Frame,e._protected.RunModes.Modes.Slave].indexOf(t)>=0})),e._protected.RunModes.registerBehavior("Visible",(function(){return e._protected.RunModes.Behaviors.ContextWindow&&!e._protected.RunModes.Behaviors.ContextFrame})),e._protected.RunModes.registerBehavior("AccessToken",(function(t){return[e._protected.RunModes.Modes.ServiceWorker,e._protected.RunModes.Modes.Popup,e._protected.RunModes.Modes.Frame,e._protected.RunModes.Modes.WebSite].indexOf(t)>=0}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o,r;o=[n(18)],void 0===(r=function(e){return Object({debug:!1}),function(e){var t,n="[storage     ]",o=new e._protected.Promise.Deferred,r=function(t){var o,r,i;t&&t.then?i=t.then(function(e){return o=(r=e)&&r.name,this}.bind(this)):o=t;var a=function(t){e._protected.Helper.warn(t),r&&(r.close(),r=void 0,i=void 0)}.bind(this);this.ready=function(){return i||(i=function(t,o){var r,i=new e._protected.Promise.Deferred;try{r=e._protected.gscope.indexedDB.open(t,1)}catch(t){return"SecurityError"===t.name?e._protected.Helper.warn(n,"Could not open IndexedDB: cross-site tracking is probably disabled",t):e._protected.Helper.warn(n,"Could not open IndexedDB, the WonderPush SDK will not initialize",t),new Promise(()=>{})}var a=!1;return r.onupgradeneeded=function(t){a=!0;var o=t.target.result;if(1!==t.newVersion)throw new e._protected.Errors.InternalStorageError("Updating from version "+t.oldVersion+" to version "+t.newVersion+", but dbVersion in code is 1");var r=t.oldVersion,i=[];i.push((function(){0===r&&(++r,o.createObjectStore("kv-storage"),o.createObjectStore("mutex")),this.onsuccess()})),i.push((function(){if(1!==r){var o="IndexedDB upgrade chain from version "+t.oldVersion+" to version "+t.newVersion+" broken at version "+r;throw e._protected.Helper.error(n,o),new e._protected.Errors.InternalStorageError(o)}a=!1}));for(var s=i.length-2;s>=0;--s){var c=i[s],p=i[s+1];c.onsuccess=p.bind(p),c.onerror=i[i.length-1]}i[0].bind(i[0])()},r.onerror=function(o){r.error&&"InvalidStateError"===r.error.name?e._protected.Helper.debug(n,"Could not open database",r.error):(e._protected.Helper.error(n,"failed to initialize IndexedDB storage",t,o,r.error),i.reject(r.error))},r.onsuccess=function(t){a&&i.reject(new e._protected.Errors.InternalStorageError("Module storage initialization failed: error encountered or broken upgrade chain"));var n=t.target.result;Promise.resolve(e._protected.Storage.onDbOpen(n)).then(i.resolve.bind(null,n),i.resolve.bind(null,n))},i.promise}(o).then(function(e){return(r=e).addEventListener("close",a),r.addEventListener("abort",a),this}.bind(this)))},this.getKeyValueStorageStoreName=function(){return"kv-storage"},this.getMutexStoreName=function(){return"mutex"},this.get=function(e,t){return s({get:{key:e,defaultValue:t}})},this.set=function(e,t){return s({put:{key:e,value:t}})},this.rm=function(e){return s({delete:{key:e}})};var s=function(e){return this.bulk([e]).then((function(e){return e.results.byIndex[0]}))}.bind(this);this.bulk=function(t,o){t=t.slice(),o=o||{};var i=new e._protected.Promise.Deferred,a=[],s={},c=Object.keys(t.reduce((function(e,t){return e[t[Object.keys(t)[0]].store||"kv-storage"]=!0,e}),{})),p={test:!0,add:!0,put:!0,delete:!0},u=t.find((function(e){return!!p[Object.keys(e)[0]]}))?"readwrite":"readonly",d=null;try{d=r.transaction(c,u)}catch(r){if("InvalidStateError"===r.name){e._protected.Helper.warn(n,r);var l=o.tries||1;if(l>=3)return Promise.reject(r);var f=1e3*Math.pow(2,l-1)*(1+.2*Math.random());e._protected.Helper.info(n,"Reopening IDBDatabase connection in ",f,"ms, cause:",r.message);const i=this;return new Promise((function(e,n){setTimeout((function(){return i.ready().then((function(){return i.bulk.call(i,t,Object.assign({},o,{tries:l+1}))})).then(e,n)}),f)}))}throw r}var g=c.reduce((function(e,t){return e[t]=d.objectStore(t),e}),{}),h=function(n){for(var o=!1,r=function(n){var r,i=t[n],c=Object.keys(i)[0],p=i[c],u=p.store||"kv-storage",l=g[u],f=p.key,m=p.alias||f,v=p.value,_=p.defaultValue;switch(c){case"test":o=!0;case"get":r=l.get(f);break;case"add":r=l.add(v,f);break;case"put":r=l.put(v,f);break;case"delete":r=l.delete(f);break;case"abort":o=!0,d.abort(),r={};break;default:throw new e._protected.Errors.InternalStorageError("Unhandled operation type "+c)}r.onsuccess=function(e){var o=void 0!==e.target.result?e.target.result:_;if(a[n]=o,s[m]=o,"test"===c){var r=p.operationsCb(o);r&&"object"==typeof r&&(r instanceof Array||(r=[r]),r.length>0&&t.splice.apply(t,[n+1,0].concat(r))),h(n+1)}},r.onerror=function(e){e.preventDefault(),a[n]=e,s[m]=e}},i=n;!o&&i<t.length;++i)r(i)};return d.onabort=d.onerror=function(e){i.reject({event:e,results:{byIndex:a,byKey:s}})},d.oncomplete=function(e){i.resolve({event:e,results:{byIndex:a,byKey:s}})},h(0),i.promise},this.listObjectStores=function(){return Array.from(r.objectStoreNames)},this.listKeyValuePairs=function(e){return new Promise((function(t,n){var o=[];try{var i=r.transaction(e);i.objectStore(e).openCursor().onsuccess=function(e){var t=e.target.result;t&&(o.push([t.key,t.value]),t.continue())},i.oncomplete=function(){t(o)},i.onerror=i.onabort=function(e){n(e)}}catch(e){n(e)}}))}};return e._protected.Storage=new function(){this.getDatabaseName=function(){return e._protected.sdkName},this.onDbOpen=function(e){};var i,a={},s=function(t){if(!t)return Promise.reject(new e._protected.Errors.InternalStorageError("Missing dbName. Storage not available."));if(a[t])return a[t].ready();var n=a[t]||new e._protected.Storage.Container(t);return n.ready().then((function(){return a[t]=n,n}))};t=function(){e._protected.Storage.getDatabaseName()?s(e._protected.Storage.getDatabaseName()).then((function(e){i=e,o.resolve()})).catch((function(e){o.reject(e)})):o.resolve()},this.getModuleInitializationPromise=function(){return o.promise},this.getKeyValueStorageStoreName=function(){return i?i.getKeyValueStorageStoreName():null},this.getMutexStoreName=function(){return i?i.getMutexStoreName():null},this.get=function(t,n,o){return o=o||e._protected.Storage.getDatabaseName(),s(o).then((function(e){return e.get(t,n)}))},this.set=function(t,n,o){return o=o||e._protected.Storage.getDatabaseName(),s(o).then((function(e){return e.set(t,n)}))},this.rm=function(t,n){return n=n||e._protected.Storage.getDatabaseName(),s(n).then((function(e){return e.rm(t)}))},this.bulk=function(t,n){return n=n||e._protected.Storage.getDatabaseName(),s(n).then((function(e){return e.bulk(t)}))},this.listObjectStores=function(t){return t=t||e._protected.Storage.getDatabaseName(),s(t).then((function(e){return e.listObjectStores()}))},this.deleteDatabase=function(t){return function(t){return new Promise((function(o,r){try{e._protected.Helper.warn(n,"deleting IndexedDB storage",t,"");var i=e._protected.gscope.indexedDB.deleteDatabase(t);i.onerror=function(o){e._protected.Helper.error(n,"failed to delete IndexedDB storage",t,":",o,i.error),r(i.error)},i.onsuccess=function(){e._protected.Helper.warn(n,"deleting IndexedDB storage",t,"succeeded"),o()}}catch(o){e._protected.Helper.error(n,"error while deleting IndexedDB storage",t,":",o),r(o)}}))}(t=t||e._protected.Storage.getDatabaseName())},this.listKeyValuePairs=function(t,n){return n=n||e._protected.Storage.getDatabaseName(),s(n).then((function(e){return e.listKeyValuePairs(t)}))},this.isDefaultContainerAvailable=function(){return!!i},this.getDefaultContainer=function(){return i},this.Container=r,this.getKeyValueStorageStoreName=function(){return"kv-storage"},this.getMutexStoreName=function(){return"mutex"}},e.preInstantiationPromise.then(t),o.promise}}.apply(t,o))||(e.exports=r)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t,n,o=new e._protected.Promise.Deferred;return e._protected.Locking=new function(){n=function(){e.preInstantiationPromise.then((function(){e._protected.Integration.getModuleInitializationPromise().then((function(){e._protected.Integration.isOnRightDomain()&&(e._protected.Locking=t),Promise.all([e._protected.Storage.getModuleInitializationPromise(),e._protected.Integration.getModuleInitializationPromise()]).then((function(){o.resolve()}))}))}))},this.getModuleInitializationPromise=function(){return o.promise},this.isAvailable=function(){return e._protected.Storage.isDefaultContainerAvailable()},this.ExpiringUnfairNamedGlobalMutex=function(t,n,o){var r=!1,i=null,a=t,s=n,c=o;this.acquire=function(t){if((t=t||{}).interval=t.interval||250,t.ttl=t.ttl||s,0===t.timeout)return this.tryAcquire(t.ttl);if(r)return Promise.resolve();var n=new e._protected.Promise.Deferred,o=+new Date;return e._protected.Promise.setIntervalUntilSettled(n.promise,function(){if(!(t.timeout>0&&+new Date-o>=t.timeout))return this.tryAcquire(t.ttl).then(n.resolve,(function(){}));n.reject()}.bind(this),t.interval,!0,!1),n.promise},this.tryAcquire=function(t){if(r)return Promise.resolve();var n;t=t||s;var o=function(){return n=+new Date+t,e._protected.Storage.bulk([{add:{store:e._protected.Storage.getMutexStoreName(),key:a,value:{name:a,until:n}}}],c)};return o().catch((function(e){return p().then((function(){return o()}))})).then((function(){r=!0,i=n;var e=new Date(i);return e=e.toLocaleTimeString("en-GB")+"."+("00"+e.getMilliseconds()).slice(-3),Promise.resolve()}),(function(){return r=!1,Promise.reject()}))},this.renewWhile=function(t,n){return(t=t||{}).ttl=t.ttl||s,t.interval=t.interval||t.ttl/2,e._protected.Promise.setIntervalUntilSettled(n,function(){return this.renew(t.ttl)}.bind(this),t.interval,!1,!1),t.release&&e._protected.Promise.do(n,function(){this.release()}.bind(this)),n},this.renew=function(t){if(!r)throw new e.prototype.Errors.InternalError("Cannot renew unacquired mutex");i<=+new Date&&console.log("Lock",a,"probably expired",+new Date-i,"ms ago"),t=t||s;var n=+new Date+t;return e._protected.Storage.bulk([{test:{store:e._protected.Storage.getMutexStoreName(),key:a,operationsCb:function(t){return t&&t.name===a&&t.until===i?{put:{store:e._protected.Storage.getMutexStoreName(),key:a,value:{name:a,until:n}}}:(console.warn("Lock",a,"has already expired"),r=!1,void(i=null))}}}],c).then((function(){i=n;var e=new Date(i);e=e.toLocaleTimeString("en-GB")+"."+("00"+e.getMilliseconds()).slice(-3)}),(function(e){return console.error("Failed to renew lock",a,":",e),Promise.reject()}))},this.release=function(){if(!r)throw new e.prototype.Errors.InternalError("Cannot release unacquired mutex");return i<=+new Date&&console.log("Lock",a,"probably expired",+new Date-i,"ms ago"),e._protected.Storage.bulk([{test:{store:e._protected.Storage.getMutexStoreName(),key:a,operationsCb:function(t){return t&&t.name===a&&t.until===i?{delete:{store:e._protected.Storage.getMutexStoreName(),key:a}}:(console.warn("Lock",a,"has already expired"),r=!1,void(i=null))}}}],c).then((function(){r=!1,i=null}),(function(e){return console.error("Failed to release lock",a,":",e),Promise.reject()}))};var p=function(){var t=+new Date,n=!1;return e._protected.Storage.bulk([{test:{store:e._protected.Storage.getMutexStoreName(),key:a,operationsCb:function(o){if(o&&o.name===a&&o.until<t)return n=!0,{delete:{store:e._protected.Storage.getMutexStoreName(),key:a}}}}}],c).then((function(){return n?Promise.resolve():Promise.reject()}),(function(e){return console.error("Failed to purge expired lock",a," (if any):",e),Promise.reject()}))}},this.remoteMutexManager=e._protected.Integration.proxifyToCustomDomain("SDK._protected.Locking.remoteMutexManager",new function(){const t={};this.create=(n,o,r)=>{const i=e._protected.Helper.uuidv4();return t[i]||(t[i]=new e._protected.Locking.ExpiringUnfairNamedGlobalMutex(n,o,r)),Promise.resolve(i)},this.acquire=(e,n)=>t[e].acquire(n),this.tryAcquire=(e,n)=>t[e].tryAcquire(n),this.renew=(e,n)=>t[e].renew(n),this.release=e=>t[e].release()})},t=e._protected.Locking,e._protected.Locking={getModuleInitializationPromise:t.getModuleInitializationPromise,remoteMutexManager:t.remoteMutexManager},n(),o.promise}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t=e.readyCallback;delete e.readyCallback,e._protected.Init={};var n=[];e._protected.Init.addWillBecomeReadyCallback=function(e){n.push(e)},e._protected.Blocker.category("ready").add("_init"),e._protected.Blocker.category("ready").wait().then((function(){n.forEach((function(e){e()})),n=[],t()})),e.instantiationPromise.then((function(){e._protected.Blocker.category("ready").remove("_init")}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;const r=n(2);void 0===(o=function(){return function(e){e._protected.Helper={browserAndOSCSSClasses:function(){var e=[],t=navigator.userAgent.toLowerCase();return t.indexOf("iphone")>-1&&e.push("iphone"),t.indexOf("ipad")>-1&&e.push("ipad"),t.indexOf("ipod")>-1&&e.push("ipod"),t.indexOf("android")>-1&&e.push("android"),t.indexOf("macintosh")>-1&&e.push("macintosh"),t.indexOf("windows")>-1&&e.push("windows"),t.indexOf("linux")>-1&&e.push("linux"),t.indexOf("chrome")>-1&&e.push("chrome"),t.indexOf("firefox")>-1&&e.push("firefox"),t.indexOf("safari")>-1&&-1===t.indexOf("chrome")&&e.push("safari"),e},inArray:function(e,t){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},uuidv4:function(){var t,n=new Array(31);if(e._protected.gscope.crypto&&crypto.getRandomValues){var o=new Uint8Array(31);for(crypto.getRandomValues(o),t=0;t<31;t++)n[t]=15&o[t]}else for(t=0;t<31;t++)n[t]=16*Math.random()|0;var r=0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=n[r++];return("x"===e?t:3&t|8).toString(16)}))},stripObject:function(t){for(var n in t){var o=t[n];if(null==o)delete t[n];else if(o instanceof Object){e._protected.Helper.stripObject(o);var r=!0;for(var i in o){r=!1;break}r&&delete t[n]}}return t},messagePassableValue:function(t){var n=t;return t instanceof Blob||(n=e._protected.Helper.plainObjectCopy(t)),n},plainObjectCopy:function(t){var n=t;if(t instanceof Array){n=[];for(var o=0;o<t.length;++o){var r=t[o];r instanceof Function||n.push(e._protected.Helper.plainObjectCopy(r))}}else if(t instanceof Object){if("undefined"!=typeof PushSubscriptionOptions&&t instanceof PushSubscriptionOptions){for(var i in n={},t)n[i]=e._protected.Helper.plainObjectCopy(t[i]);return n}if(t.toJSON instanceof Function){var a=t.toJSON();return a!==t&&(a=e._protected.Helper.plainObjectCopy(a)),t instanceof PushSubscription&&(a.keys instanceof Object&&("string"==typeof a.keys.auth&&(a.keys.auth=a.keys.auth.replace(/=+$/,"")),"string"==typeof a.keys.p256dh&&(a.keys.p256dh=a.keys.p256dh.replace(/=+$/,""))),t.options instanceof Object&&(a.options=e._protected.Helper.plainObjectCopy(t.options))),a}if(t instanceof Error)return n=e._protected.Helper.assign({},t),["name","message","stack","columnNumber","fileName","lineNumber"].forEach((function(e){void 0!==t[e]&&(n[e]=t[e])})),n;if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return e._protected.Helper.arrayBufferToBase64UrlSafe(t);n={},Object.getOwnPropertyNames(t).forEach((function(o){var r=t[o];r instanceof Function||(n[o]=e._protected.Helper.plainObjectCopy(r))}))}return n},assign:function(e,t){"use strict";if(Object.assign)return Object.assign.apply(null,arguments);if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),o=1;o<arguments.length;o++){var r=arguments[o];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])}return n},mergeObjectInplaceRecursive:function(t,n){for(var o in n)if(n.hasOwnProperty(o)){var r=t[o],i=n[o];r instanceof Object&&i instanceof Object?e._protected.Helper.mergeObjectInplaceRecursive(r,i):t[o]=i}return t},rawurlencode:function(e){return e=(e+"").toString(),encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A")},decodeQueryString:function(e){var t={};if(e){"?"===e.charAt(0)&&(e=e.substring(1));for(var n=e.split("&"),o=0;o<n.length;++o){var r=n[o].split("=");r.length>2&&r.push(r.splice(1).join("=")),r[0]=decodeURIComponent(r[0]),r.length<2?r.push(null):r[1]=decodeURIComponent(r[1]),t[r[0]]=r[1]}}return t},escapeRegExp:function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},fireEvent:function(e,t,n){var o;if("function"==typeof CustomEvent)return o=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}),!e.dispatchEvent(o);if("function"==typeof Event)return(o=new Event(t,{bubbles:!0,cancelable:!0})).detail=n,!e.dispatchEvent(o);if("object"==typeof document&&document.createEventObject)return(o=document.createEventObject()).data=n,e.fireEvent("on"+t,o);throw Error("Cannot instantiate Event for "+t)},listenEvent:function(e,t,n){e.addEventListener(t,n,!1)},unlistenEvent:function(e,t,n){e.removeEventListener(t,n,!1)},supportsServiceWorker:function(){return navigator.serviceWorker&&"function"==typeof navigator.serviceWorker.register},supportsPushManager:function(){return"undefined"!=typeof PushManager},getLocales:function(){var t=[];e._protected.gscope.document&&(t.push(document.documentElement.getAttribute("lang")),t=(t=t.concat(Array.prototype.slice.call(document.querySelectorAll("HEAD > meta[name=language], HEAD > meta[http-equiv=content-language], HEAD > meta[http-equiv=Content-Language]")).map((function(e){return e.content})))).reduce((function(e,t){return t?e.concat(t.split(",")):e}),[])),t.push(navigator.language);var n=t.concat(navigator.languages).map(e._protected.Helper.normalizeLocale).filter((function(e){return!!e}));return n.filter((function(e,t){return n.indexOf(e)===t}))},normalizeLocale:function(e){if("string"!=typeof e)return null;var t=e.trim().toLowerCase().match(/^([a-z][a-z])(?:[-_]([a-z][a-z]))?$/);return t?t[2]?t[1]+"_"+t[2].toUpperCase():t[1]:null},parseNumber:function(e,t){var n;t=t||navigator.language;try{n=Intl.NumberFormat(t).format("1.1")}catch(e){n=Intl.NumberFormat(navigator.language).format("1.1")}var o=new RegExp("[^-+0-9"+n.charAt(1)+"]","g"),r=e.replace(o,"").replace(n.charAt(1),".");return parseFloat(r)},tryParse:function(e,t){try{return JSON.parse(e)}catch(e){}return t},detectBrowser:function(){var e,t,n,o=navigator.userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];!e&&/trident/i.test(o[1])&&(e="Internet Explorer",t=(n=/\brv[ :]+([\d\.]+)/g.exec(navigator.userAgent)||[])[1]),!e&&/msie/i.test(o[1])&&(e="Internet Explorer",t=o[2]),!e&&/chrome/i.test(o[1])&&(n=navigator.userAgent.match(/\b(OPR|Edge)\/([\d\.]+)/)||[]).length>0&&(e=n[1],t=n[2]),!e&&o[1]&&(e=o[1],t=o[2]),"OPR"===e&&(e="Opera"),null!==(n=navigator.userAgent.match(/version\/([\d\.]+)/i))&&(t=n[1]);var r=navigator.userAgent.match(/(Linux|iPad|iPhone|Android|Windows|Macintosh)/g)||[],i=null;return-1!==r.indexOf("Android")?i="Android":r.length>0&&(i=r[0]),{name:e,platform:i,version:t}},arrayBufferFromBase64:function(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))},arrayBufferFromBase64UrlSafe:function(t){return e._protected.Helper.arrayBufferFromBase64(t.replace(/-/g,"+").replace(/_/g,"/"))},arrayBufferToBase64:function(e){return btoa(String.fromCharCode.apply(null,new Uint8Array(e)))},arrayBufferToBase64UrlSafe:function(t){return e._protected.Helper.arrayBufferToBase64(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"")},compareVersions:function(e,t){var n=function(e){return parseInt(e,10)};e=e.split(".").map(n),t=t.split(".").map(n);for(var o=0;o<Math.max(e.length,t.length);++o){if(o>=e.length)return-1;if(o>=t.length)return 1;if(e[o]<t[o])return-1;if(e[o]>t[o])return 1}return 0},_:void 0};const t=new r.SimpleLogger({sdkName:e._protected.sdkName});r.setDefaultLogger(t),Object.defineProperties(e._protected.Helper,{trace:{get:function(){return r.trace}},debug:{get:function(){return r.debug}},_debugResolved:{get:function(){return r.debugResolved}},log:{get:function(){return r.log}},info:{get:function(){return r.info}},warn:{get:function(){return r.warn}},error:{get:function(){return r.error}},debugCollapsed:{get:function(){return r.debugCollapsed}},setLogRunMode:{value:function(e){t.runMode=e}}})}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Consulate=function(t){var n,o,r,i,a=function(){n=null,o=null,r=!1,i=new e._protected.Promise.Deferred};a(),this.setup=function(t,a){if(this.isSetup())console.warn("cannot set up an already setup consulate");else{n=new URL(t).origin,"allow"in(o=document.createElement("IFRAME"))&&(o.allow.supports?o.allow.supports("geolocation")&&o.allow.add("geolocation"):o.allow="geolocation"),o.style.display="none",o.src=t;var s=function(){document.body.appendChild(o),o.addEventListener("load",(function(){e._protected.Integration.probeAndInitWindowObject(o.contentWindow,n,a,(function(e){r=!0,i.resolve()}),{type:"ping"},(function(e){return e.data instanceof Object&&"pong"===e.data.type}))}))};document.body?s():document.addEventListener("DOMContentLoaded",s)}}.bind(this),this.tearDown=function(){this.isSetup()&&(document.body.removeChild(o),a())}.bind(this),this.isSetup=function(){return!!o},this.isReady=function(){return r},this.getReadyPromise=function(){return i.promise},this.getPostMessageTarget=function(){return o.contentWindow},this.getPostMessageOrigin=function(){return n},this.getIFrame=function(){return o}};var t={};e._protected.Consulate.getConsulate=function(e){return t[e]||null},e._protected.Consulate.createConsulate=function(n){if(t[n])throw new e.prototype.Errors.InternalError("Consulate already created");return t[n]=new e._protected.Consulate(n),t[n]}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t,n=new e._protected.Promise.Deferred,o=new Set,r=new Map;return"undefined"!=typeof document&&document.currentScript,e._protected.Integration=new function(){var i,a,s=e._protected.Consulate.createConsulate("frame");t=function(){e._protected.RunModes.Behaviors.ModeWebSite&&!e._protected.Integration.isOnRightDomain()&&c(),e._protected.RunModes.Behaviors.ModeFrame?d():e._protected.RunModes.Behaviors.ModePopup?h():e._protected.RunModes.Behaviors.ModeSlave?v():e._protected.RunModes.Behaviors.ModeWebSite?f():e._protected.RunModes.Behaviors.ModeServiceWorker&&y(),Promise.resolve().then((function(){if(e._protected.RunModes.Behaviors.ModeFrame||e._protected.RunModes.Behaviors.ModeWebSite&&e._protected.Integration.isOnRightDomain())return e._protected.Storage.getModuleInitializationPromise().then((function(){return e._protected.Integration.incrementPageViews()}))})).catch((function(){})).then(n.resolve)},this.getModuleInitializationPromise=function(){return n.promise},this.getFrameReadyPromise=function(){return s.getReadyPromise()},this.getIFrame=function(){return s.getIFrame()},this.incrementPageViews=function(){return e._protected.RunModes.Behaviors.ModeFrame||e._protected.RunModes.Behaviors.ModeWebSite&&e._protected.Integration.isOnRightDomain()?e._protected.Storage.getModuleInitializationPromise().then((function(){return e._protected.Storage.bulk([{test:{key:"pageViews",defaultValue:0,operationsCb:function(e){return{put:{key:"pageViews",value:++e}}}}}])})):(console.error("should not be called from this domain"),Promise.resolve())},this.getHomeUrlObject=function(){return new URL(e._protected.Constants.HOME_URL)},this.getHomeHref=function(){return e._protected.Integration.getHomeUrlObject().href},this.getHomeOrigin=function(){return e._protected.Integration.getHomeUrlObject().origin},this.isOnRightDomain=function(){return e._protected.RunModes.Behaviors.ModeServiceWorker?(location.origin,e._protected.Integration.getHomeOrigin(),!0):location.origin===e._protected.Integration.getHomeOrigin()},this.areTopWindowAndSelfOnRightDomain=function(){if(e._protected.RunModes.Behaviors.ModeServiceWorker)return location.origin,e._protected.Integration.getHomeOrigin(),!0;try{return window.top.location.origin===e._protected.Integration.getHomeOrigin()}catch(e){return!1}},this.getServiceWorkerUrl=function(){var t=new URL(e._protected.Options.getServiceWorkerUrl(),e._protected.Integration.getHomeHref());return t.protocol="https:",t.href},this.getFrameUrl=function(){var t=new URL(e._protected.Options.getFrameUrl(),e._protected.Integration.getHomeHref());return t.protocol="https:",t.href},this.getRedirectionPageUrl=function(t){var n=new URL(e._protected.Options.getRedirectionPageUrl(t),e._protected.Integration.getHomeHref());return n.protocol="https:",n.href};var c=function(){if(e._protected.RunModes.Behaviors.ModeWebSite){e._protected.Blocker.category("ready").add("hiddenFrame");var t=e._protected.Options.exportInitial();t._mode=e._protected.RunModes.Modes.Frame,t._hiddenFrame=!0,s.setup(e._protected.Integration.getFrameUrl(),t),s.getReadyPromise().then(p)}};this.injectStylesheetLink=function(e){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=e,document.head.appendChild(t)},this.injectStylesheetInline=function(e){var t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode(e)),document.head.appendChild(t)};var p=function(t){e._protected.Blocker.category("ready").remove("hiddenFrame")},u=function(t,n,o,r){var i=e._protected.Options.exportInitial();i._mode=e._protected.RunModes.Modes.Popup,i._popup=!0,e._protected.Integration.probeAndInitWindowObject(t,e._protected.Integration.getTargetOrigin(),i,n,o,r)};this.probeWindowObject=function(t,n,o,r){var i=new e._protected.Promise.Deferred;if(!t)return Promise.reject(new Error("Missing window object"));o instanceof Object&&(o.sdk=e._protected.sdkName);var a=e._protected.Constants.WINDOW_LOAD_CHECK_PAGELOADED_INTERVAL_MS_MIN,s=((new Date).getTime(),!0),c=function(n){var c=new MessageChannel;c.port2.onmessage=function(e){s&&r(e)&&(s=!1,i.resolve())},a=Math.min(e._protected.Constants.WINDOW_LOAD_CHECK_PAGELOADED_INTERVAL_MS_MAX,a*e._protected.Constants.WINDOW_LOAD_CHECK_PAGELOADED_INTERVAL_MS_EXP),t.postMessage(o,n,[c.port1]),setTimeout(p,a)},p=function(){s&&(t.closed?(s=!1,i.reject(new Error("Window has gone away"))):c("*"))};return setTimeout(c.bind(null,n),a),i.promise},this.probeAndInitWindowObject=function(t,n,o,r,i,a){if(t){i instanceof Object&&(i.sdk=e._protected.sdkName);var s=e._protected.Constants.WINDOW_LOAD_CHECK_PAGELOADED_INTERVAL_MS_MIN,c=(new Date).getTime(),p=!0,u=function(){(new Date).getTime();var i=new MessageChannel;i.port2.onmessage=function(e){if(e.data instanceof Object)switch(e.data.type){case"ready":r(t),r=function(){}}},t.postMessage({type:"init",sdk:e._protected.sdkName,initOpts:o},n,[i.port1])},d=function(n){var o=new MessageChannel;o.port2.onmessage=function(e){p&&a(e)&&(p=!1,u())},s=Math.min(e._protected.Constants.WINDOW_LOAD_CHECK_PAGELOADED_INTERVAL_MS_MAX,s*e._protected.Constants.WINDOW_LOAD_CHECK_PAGELOADED_INTERVAL_MS_EXP),t.postMessage(i,n,[o.port1]),setTimeout(l,s)},l=function(){if(p)if(t.closed)p=!1,r(!1),r=function(){};else if((new Date).getTime()-c<e._protected.Constants.WINDOW_LOAD_MAX_PAGELOAD_MS)d("*");else{try{t.close()}catch(e){}p=!1,r(!1),r=function(){}}};setTimeout(d.bind(null,n),s),setTimeout((function(){if(p){var t=((e._protected.Constants.WINDOW_LOAD_MAX_PAGELOAD_MS-e._protected.Constants.WINDOW_LOAD_SLOW_WARN_MS)/1e3).toFixed(0);console.warn(e._protected.sdkName+" seems to be taking some time to initialize one of its external resource on the domain ",n,".\nIf you see one error or repeated errors (which will stop in about "+t+' seconds) about "postMessage" and "target origin [] not match[ing] the recipient window\'s origin", then you either:\n- have a browser extension blocking that resource;\n- see a broken integration that you would be kind to report.\nIf not, then just wait around, and everything should get loaded soon.')}}),e._protected.Constants.WINDOW_LOAD_SLOW_WARN_MS)}else r(null)},this.openPopup=function(t,n){var o=(n=e._protected.Helper.mergeObjectInplaceRecursive(e._protected.Constants.INTEGRATION_POPUP_DEFAULT_OPTIONS,n||{})).width,r=n.height;"window"===n.center?(n.left=(window.innerWidth-o)/2+window.screenX,n.top=(window.innerHeight-r)/2+window.screenY):"screen"===n.center&&(n.left=(screen.width-o)/2+screen.availLeft,n.top=(screen.height-r)/2+screen.availTop),delete n.center;var i=Object.keys(n).map((function(e){return e+"="+n[e]})).join(",");return window.open(t,"_blank",i)},this.openAndInitPopup=function(t,n,o){i=e._protected.Integration.openPopup(t,o),u(i,a=n,{type:"ping"},(function(e){return e.data instanceof Object&&"pong"===e.data.type}))},this.reloadPopup=function(){e._protected.RunModes.Behaviors.ModePopup?(window.opener.postMessage({type:"reloadPopup",sdk:e._protected.sdkName},"*"),window.location.reload()):console.error("reloadPopup() can only be called from within the popup itself")},this.reinitializePopup=function(t){e._protected.RunModes.Behaviors.ModeWebSite?i===t?u(i,a,{type:"isReady"},(function(e){return e.data instanceof Object&&"readiness"===e.data.type&&!e.data.ready})):console.error("reinitializePopup() can only be invoked from the last opened popup"):console.error("reinitializePopup() can only be called from within the popup parent window")},this.getTargetOrigin=function(){return e._protected.Integration.getHomeOrigin()};var d=function(){window.addEventListener("message",l),e._protected.ServiceWorkerClient.addMessageEventListener(b)},l=function(t){if(t.data instanceof Object&&t.data.sdk===e._protected.sdkName)switch(t.data.type){case"callOnCustomDomain":e._protected.Promise.catchNoop(I(t.data.functionName,t.data.args,t.ports[0]))}},f=function(){window.addEventListener("message",g),e._protected.ServiceWorkerClient.addMessageEventListener(b)},g=function(t){if(t.data instanceof Object&&t.origin===e._protected.Integration.getTargetOrigin()&&t.data.sdk===e._protected.sdkName)switch(t.data.type){case"callOnParentWindow":e._protected.Promise.catchNoop(I(t.data.functionName,t.data.args,t.ports[0]));break;case"reloadPopup":e._protected.Integration.reinitializePopup(t.source)}},h=function(){window.addEventListener("message",m)},m=function(t){if(t.data instanceof Object&&t.data.sdk===e._protected.sdkName)switch(t.data.type){case"callOnPopupWindow":e._protected.Promise.catchNoop(I(t.data.functionName,t.data.args,t.ports[0]))}},v=function(){window.addEventListener("message",_)},_=function(t){if(t.data instanceof Object&&t.data.sdk===e._protected.sdkName)switch(t.data.type){case"callOnSlave":e._protected.Promise.catchNoop(I(t.data.functionName,t.data.args,t.ports[0]))}},y=function(){e._protected.ServiceWorker.addMessageEventListener(w)},w=function(t){if(t.data instanceof Object&&t.data.sdk===e._protected.sdkName)switch(t.data.type){case"callOnServiceWorker":t.waitUntil(e._protected.Promise.catchNoop(I(t.data.functionName,t.data.args,t.ports[0])))}},b=function(t){if(t.data instanceof Object&&t.data.sdk===e._protected.sdkName)switch(t.data.type){case"callOnServiceWorkerClients":e._protected.Promise.catchNoop(I(t.data.functionName,t.data.args,t.ports[0]))}},S=function(t){var n=new e.prototype.Errors.InvalidArgumentError("Invalid function name");if(!t)throw n;var o=t.split(".");if(o.length<3)throw n;var r=o[1];if("this"!==r&&"_protected"!==r&&"prototype"!==r)throw n},E=function(t,n,o,r){if(!t||t.postMessage){if(r=r||[],S(o),null===t)return I(o,r);var i=new e._protected.Promise.Deferred,a=new MessageChannel;return"closed"in t&&e._protected.Promise.setIntervalUntilSettled(i.promise,(function(){if(t.closed){var n=new e._protected.Errors.InternalRPCTargetClosedError;i.reject(n)}}),e._protected.Constants.INTEGRATION_RPC_CHECK_TARGET_CLOSED_INTERVAL_MS,!1,!1),a.port2.onmessageerror=function(t){e._protected.Helper.error("[integration ]","[callOn] raised onmessageerror",t,"(for target:","<REDACTED>","type:",n,"functionName:",o,"args:",r,")"),i.reject(t)},a.port2.onmessage=function(t){if(t.data instanceof Object)if("returned"in t.data)i.resolve(t.data.returned);else if("error"in t.data&&t.data.error){var n=t.data.error;if(n&&n.name){var o=e._protected.sdkName+"SDK.Errors.",r=Error;if(n.name&&n.name.startsWith(o)&&(r=e.prototype.Errors[n.name.substring(o.length)]||e._protected.Errors[n.name.substring(o.length)]),"function"==typeof r){var a=new r(n.message);a.name===n.name&&(delete n.name,e._protected.Helper.assign(a,n),n=a)}}i.reject(n)}},"undefined"!=typeof ServiceWorker&&t instanceof ServiceWorker||"undefined"!=typeof Client&&t instanceof Client?t.postMessage({sdk:e._protected.sdkName,type:n,functionName:o,args:r},[a.port1]):t.postMessage({sdk:e._protected.sdkName,type:n,functionName:o,args:r},"*",[a.port1]),i.promise}},I=function(t,n,o){n=n||[];for(var r,i=t.split(".").slice(1),a=e,s=0;s<i.length;++s)r=a,a=(a||{})[i[s]];return new e._protected.Promise.DelayedStartPromise((function(e,t){e(a.apply(r,n))}),1).then((function(t){return o&&o.postMessage&&o.postMessage({returned:e._protected.Helper.messagePassableValue(t)}),t}),(function(t){throw o&&o.postMessage&&o.postMessage({error:e._protected.Helper.messagePassableValue(t)}),t}))},C=function(e,t,n,o,r){if("function"==typeof n)return function(){var i=!0;r instanceof Function&&(i=r());var a=Array.prototype.slice.call(arguments);return i?e(t,a):new Promise((function(e,t){e(n.apply(o,a))}))};if("object"==typeof n){for(var i in n)n.hasOwnProperty(i)&&(n[i]=C(e,t+"."+i,n[i],n,r));return n}return n};this.callOnCustomDomain=function(t,n){return S(t),e._protected.Integration.isOnRightDomain()?E(null,"callOnCustomDomain",t,n):s.getReadyPromise().then((function(){return E(s.getPostMessageTarget(),"callOnCustomDomain",t,n)}))},this.proxifyToCustomDomain=function(t,n){return C(e._protected.Integration.callOnCustomDomain,t,n,void 0,()=>!e._protected.Integration.isOnRightDomain())},this.callOnParentWindow=function(t,n){var o;return o=e._protected.RunModes.Behaviors.ContextFrame&&window.parent!==window?e._protected.RunModes.Behaviors.ModeSlave?null:window.parent:null,E(o,"callOnParentWindow",t,n)},this.proxifyToParentWindow=function(t,n){return e._protected.RunModes.Behaviors.ContextFrame?C(e._protected.Integration.callOnParentWindow,t,n,void 0,()=>window.parent!==window):n},this.callOnPopupWindow=function(e,t,n){return E(e,"callOnPopupWindow",t,n)},this.callOnSlave=function(e,t,n){return E(e,"callOnSlave",t,n)},this.callOnServiceWorker=function(t,n){return S(t),e._protected.RunModes.Behaviors.ContextServiceWorker?E(null,"callOnServiceWorker",t,n):navigator.serviceWorker?navigator.serviceWorker.ready.then((function(){return E(navigator.serviceWorker.controller,"callOnServiceWorker",t,n)})):new Promise((e,t)=>{})},this.proxifyToServiceWorker=function(t,n){return e._protected.RunModes.Behaviors.ContextServiceWorker?n:C(e._protected.Integration.callOnServiceWorker,t,n)},this.callOnServiceWorkerClients=function(t,n){return S(t),e._protected.RunModes.Behaviors.ContextServiceWorker?clients.matchAll().then((function(e){return Promise.all(e.map((function(e){return E(e,"callOnServiceWorkerClients",t,n)})))})):E(null,"callOnServiceWorkerClients",t,n)},this.proxifyToServiceWorkerClients=function(t,n){return e._protected.RunModes.Behaviors.ContextServiceWorker?C(e._protected.Integration.callOnServiceWorkerClients,t,n):n},this.broadcast=function(t,n){const o=e._protected.Helper.uuidv4();e._protected.Integration.onBroadcast(t,n,o)},this.onBroadcast=function(t,n,i){if(o.has(i))return;o.add(i);const a=r.get(t);a&&a.forEach(e=>e(t,n)),e._protected.RunModes.Behaviors.ModeWebSite&&s&&s.isSetup()?e._protected.Integration.callOnCustomDomain("SDK._protected.Integration.onBroadcast",[t,n,i]):e._protected.RunModes.Behaviors.ModeFrame?(e._protected.Integration.callOnParentWindow("SDK._protected.Integration.onBroadcast",[t,n,i]),e._protected.Helper.supportsServiceWorker()&&e._protected.Integration.callOnServiceWorker("SDK._protected.Integration.onBroadcast",[t,n,i])):e._protected.RunModes.Behaviors.ModeServiceWorker&&e._protected.Integration.callOnServiceWorkerClients("SDK._protected.Integration.onBroadcast",[t,n,i])},this.addBroadcastListener=function(e,t){let n=r.get(e);n||(n=new Set,r.set(e,n)),n.add(t)},this.removeBroadcastListener=function(e,t){let n=r.get(e);n&&(t?n.delete(t):n.clear())}},e.preInstantiationPromise.then((function(){return e._protected.Options.getModuleInitializationPromise()})).then((function(){return e._protected.Blocker.category("integration").wait()})).then(t),n.promise}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Request=new function(){this.request=function(t,n,o,r,i,a,s){s=s||{},a=a||{};var c=function(e,t){if("function"!=typeof XMLHttpRequest&&"function"!=typeof XDomainRequest)return null;var n=new XMLHttpRequest;return"withCredentials"in n?n.open(e,t,!0):"undefined"!=typeof XDomainRequest?(n=new XDomainRequest).open(e,t):n=null,n}(t,n);if(!(c&&!0!==s.fetch||"function"!=typeof fetch)){var p={};if(p.method=t||"GET",p.mode="cors",r?p.body=r:o&&(p.body=o),i)for(var u in p.headers=new Headers,i)p.headers.append(u,i[u]);var d=function(){},l="function"==typeof a.onload?a.onload:d,f="function"==typeof a.onerror?a.onerror:d;return fetch(n,p).then((function(t){if(t.json().then(t=>{const n=t?t._configVersion:void 0;n&&e._protected.Config.getModuleInitializationPromise().then(()=>e._protected.Config.remoteConfigManager.declareVersion(n.toString()))}),0===t.status||t.status>=200&&t.status<=299)return l(t),t;throw f(t),t}),(function(e){throw f(e),e}))}if(c){if(c.timeout=e._protected.Constants.REQUEST_TIMEOUT_MS,i)for(var u in i)c.setRequestHeader(u,i[u]);a&&["onerror","ontimeout","onabort","onloadend"].forEach((function(e){a[e]&&(c[e]=a[e])})),c.onload=function(){if(a){try{c.responseJSON=e._protected.Helper.tryParse(this.responseText,null);const t=c.responseJSON?c.responseJSON._configVersion:void 0;t&&e._protected.Config.getModuleInitializationPromise().then(()=>e._protected.Config.remoteConfigManager.declareVersion(t.toString()))}catch(e){}var t=this.status;t>=200&&t<=299&&a.onload?a.onload.apply(this,arguments):a.onerror&&a.onerror.apply(this,arguments)}},c.onloadend=function(){a.onloadend&&a.onloadend.apply(this,arguments)},"POST"===t||"PATCH"===t?c.send(o):c.send()}},this.requestEventually=function(t,n,o,r,i){if(!e._protected.RunModes.Behaviors.AccessToken||!e._protected.Integration.isOnRightDomain())throw new e.prototype.Errors.InternalError("Should not be called in this environment");var a=new e._protected.RequestVaultJob([t,n,o,r,i]);return e._protected.RequestVault.run(a)}}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.RequestVault={JOB_STATUS_QUEUED:"queued",JOB_STATUS_RUNNING:"running",JOB_STATUS_PERFORMED:"performed",jobTypes:{},run:function(e){return this._queue(e).then(function(){this._execute(e)}.bind(this))},_queue:function(t){var n=Math.floor(1e10*Math.random());return e._protected.Storage.bulk([{test:{key:"requestVaultJobs",defaultValue:{},operationsCb:function(e){for(;n in e;)n=Math.floor(1e10*Math.random());return t._jid=n,e[n]=this.serialize(t),t._jid=null,{put:{key:"requestVaultJobs",value:e}}}.bind(this)}}]).then((function(){t._jid=n}))},_update:function(t){return e._protected.Storage.bulk([{test:{key:"requestVaultJobs",defaultValue:{},operationsCb:function(e){return t._jid in e?(e[t._jid]=this.serialize(t),{put:{key:"requestVaultJobs",value:e}}):{abort:{}}}.bind(this)}}]).then((function(){}))},_unqueue:function(t){return t instanceof Array||(t=[t]),t.length?e._protected.Storage.bulk([{test:{key:"requestVaultJobs",defaultValue:{},operationsCb:function(e){for(var n=0;n<t.length;++n)job=t[n],job._jid,delete e[job._jid];return{put:{key:"requestVaultJobs",value:e}}}.bind(this)}}]).then((function(){})):Promise.resolve()},_runQueued:function(){var t=new e._protected.Locking.ExpiringUnfairNamedGlobalMutex("requestvault",1e4);return t.tryAcquire().then(function(){var n=+new Date,o=n+e._protected.Constants.REQUEST_VAULT_IDLE_WAIT_MS;return e._protected.Promise.do(t.renewWhile({release:!0},e._protected.Storage.get("requestVaultJobs",{}).then(function(t){var r=[];for(var i in t)if(t.hasOwnProperty(i)){var a=this.unserialize(t[i]);switch(a.getStatus()){case this.JOB_STATUS_PERFORMED:r.push(a);break;case this.JOB_STATUS_QUEUED:n>=a.getWaitUntilDate()?this._executing[a._jid]||this._execute(a):o=Math.min(o,a.getWaitUntilDate());break;case this.JOB_STATUS_RUNNING:n>=a.getRunningSinceDate()+e._protected.Constants.REQUEST_VAULT_RUNNING_JOB_TIMEOUT_MS&&(this._executing[a._jid]||this._execute(a))}}return this._unqueue(r)}.bind(this))),function(){var e=o-n;e+=100+Math.round(1e3*Math.random()),setTimeout(this._runQueued.bind(this),e)}.bind(this))}.bind(this),function(){var t=Math.round(e._protected.Constants.REQUEST_VAULT_IDLE_WAIT_MS*(1+.2*Math.random()));setTimeout(this._runQueued.bind(this),t)}.bind(this))},_executing:{},_execute:function(t){e._protected.Blocker.category("requestvault").wait().then(()=>{if(!this._executing[t._jid]&&(t.getStatus()!==this.JOB_STATUS_RUNNING||+new Date>=t.getRunningSinceDate()+e._protected.Constants.REQUEST_VAULT_RUNNING_JOB_TIMEOUT_MS)){this._executing[t._jid]=!0;var n=e._protected.Constants.REQUEST_VAULT_RUNNING_JOB_TIMEOUT_MS,o=new e._protected.Locking.ExpiringUnfairNamedGlobalMutex("requestvault-job-"+t._jid,n);return e._protected.Promise.do(o.tryAcquire().then(function(){return t.setStatus(this.JOB_STATUS_RUNNING),e._protected.Promise.do(this._update(t).then(function(){return e._protected.Promise.do(t.run().then((function(){}),(function(){})),function(){this._update(t)}.bind(this))}.bind(this)),(function(){return o.release()}))}.bind(this),(function(){})),function(){delete this._executing[t._jid]}.bind(this))}})},_init:function(){e._protected.Locking.getModuleInitializationPromise().then(function(){e._protected.Locking.isAvailable()&&this._runQueued()}.bind(this))},serialize:function(e){return e.toJSONObject()},unserialize:function(t){"string"==typeof t&&((t=JSON.parse(t)).v=t.v||1,t.status=t.status||e._protected.RequestVault.JOB_STATUS_QUEUED,t.id=t.id||Math.floor(1e10*Math.random()));var n=t.type;return this.jobTypes[n].fromJSONObject(t)}},e._protected.RequestVaultJob=function(t){var n,o=e._protected.RequestVault.JOB_STATUS_QUEUED,r=+new Date,i=0,a=0,s=this,c={onload:function(){s.setStatus(e._protected.RequestVault.JOB_STATUS_PERFORMED),n.resolve(),n=void 0},onerror:function(t){t&&t.target&&(0===t.target.status||e._protected.Helper.inArray(t.target.status,[500,503]))||"undefined"!=typeof TypeError&&t instanceof TypeError?(s.setWaitUntilDate(e._protected.Constants.REQUEST_VAULT_ERROR_WAIT_MS+ +new Date),s.setStatus(e._protected.RequestVault.JOB_STATUS_QUEUED)):s.setStatus(e._protected.RequestVault.JOB_STATUS_PERFORMED),n.resolve(),n=void 0},ontimeout:function(){s.setWaitUntilDate(e._protected.Constants.REQUEST_VAULT_ERROR_WAIT_MS+ +new Date),s.setStatus(e._protected.RequestVault.JOB_STATUS_QUEUED),n.resolve(),n=void 0},onabort:function(){s.setWaitUntilDate(e._protected.Constants.REQUEST_VAULT_ERROR_WAIT_MS+ +new Date),s.setStatus(e._protected.RequestVault.JOB_STATUS_QUEUED),n.resolve(),n=void 0}},p=t.slice();p.push(c),this._jid=null,this.getStatus=function(){return o},this.setStatus=function(t){0===t&&(t=e._protected.RequestVault.JOB_STATUS_QUEUED),1===t&&(t=e._protected.RequestVault.JOB_STATUS_RUNNING),2===t&&(t=e._protected.RequestVault.JOB_STATUS_PERFORMED),o=t},this.getCreationDate=function(){return r},this.setCreationDate=function(e){r=e},this.getWaitUntilDate=function(){return i},this.setWaitUntilDate=function(e){i=e||0},this.getRunningSinceDate=function(){return a},this.setRunningSinceDate=function(e){a=e||0},this.run=function(){return n||(n=new e._protected.Promise.Deferred,a=+new Date,e._protected.Request.request.apply(e._protected.Request.request,p)),n.promise},this.toJSONObject=function(){return{type:"RequestVaultJob",v:1,id:s._jid,status:o,creationDate:r,waitUntilDate:i,runningSinceDate:a,args:t}}},e._protected.RequestVaultJob.fromJSONObject=function(t){var n=new e._protected.RequestVaultJob(t.args);return n._jid=t.id,n.setStatus(t.status),t.creationDate&&n.setCreationDate(t.creationDate),n.setWaitUntilDate(t.waitUntilDate),n.setRunningSinceDate(t.runningSinceDate),n},e._protected.RequestVault.jobTypes.RequestVaultJob=e._protected.RequestVaultJob,e.preInstantiationPromise.then((function(){e._protected.RunModes.Behaviors.AccessToken&&e._protected.Integration.getModuleInitializationPromise().then((function(){e._protected.Integration.isOnRightDomain()&&e._protected.RequestVault._init()}))}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t;e._protected.ServiceWorkerClient=new function(){var n=[];t=function(){e._protected.Integration.getModuleInitializationPromise().then((function(){e._protected.RunModes.Behaviors.RegisterServiceWorker&&e._protected.Helper.supportsServiceWorker()&&"https:"===location.protocol&&o()}))};var o=function(){addEventListener("message",r),navigator.serviceWorker&&navigator.serviceWorker.addEventListener("message",r)};this.isCurrentURLInScope=()=>{const t=e._protected.Integration.getServiceWorkerUrl(),n=e._protected.Options.getServiceWorkerScope(),o=new URL("./",n?new URL(n,e._protected.Integration.getHomeHref()).href:t);return new URL("./",location.href).href.startsWith(o.href)},this.registerServiceWorker=function(){const t=e._protected.Integration.getServiceWorkerUrl(),n={scope:e._protected.Options.getServiceWorkerScope()};return navigator.serviceWorker?navigator.serviceWorker.register(t,n).catch((function(e){})).then((function(e){return e}),(function(e){if(console.error("Cannot register the ServiceWorker / no ServiceWorker ready",e),e)throw e})):new Promise((e,t)=>{})}.bind(this),this.getPushSubscriptionAndRegisterServiceWorkerIfNecessary=e._protected.Integration.proxifyToCustomDomain("SDK._protected.ServiceWorkerClient.getPushSubscriptionAndRegisterServiceWorkerIfNecessary",function(){return navigator.serviceWorker?this.isCurrentURLInScope()&&!navigator.serviceWorker.controller?Promise.resolve(null):e._protected.ServiceWorkerClient.registerServiceWorker().then((function(e){return e.pushManager.getSubscription()})):new Promise((e,t)=>{})}.bind(this)),this.getPushSubscriptionFromServiceWorker=e._protected.Integration.proxifyToServiceWorker("SDK._protected.ServiceWorkerClient.getPushSubscriptionFromServiceWorker",(function(){return"granted"!==Notification.permission?Promise.resolve(null):registration.pushManager.getSubscription()}));var r=function(t){if("undefined"==typeof ServiceWorkerMessageEvent||t instanceof ServiceWorkerMessageEvent){if(t.data instanceof Object&&t.data.sdk!==e._protected.sdkName)switch(t.data.type){case"ping":"ports"in t&&t.ports.length>0&&t.ports[0].postMessage({type:"pong",data:t.data})}n.forEach((function(e){try{e.call(this,t)}catch(e){console.error("ServiceWorkerClient message handler threw",e)}}))}};this.addMessageEventListener=function(e){n.push(e)},this.removeMessageEventListener=function(e){var t=n.indexOf(e);t>=0&&n.splice(t,1)}},t()}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){if(e._protected.RunModes.Behaviors.ContextServiceWorker){var t=e._protected.gscope;e._protected.ServiceWorker=new function(){this.addEventListener=t._wp_worker_addEventListener||function(e,n){t.addEventListener(e,(function(e){var t=n(e);t instanceof Promise&&e.waitUntil(t)}))},this.removeEventListener=t._wp_worker_removeEventListener||function(e,n){t.removeEventListener(e,n)};var n=function(){this.addEventListener("message",(function(t){return e.instantiationPromise.then((function(){r(t)}))}))}.bind(this),o=[],r=function(e){e.data instanceof Object&&(e.data.type,o.forEach((function(t){try{t.call(this,e)}catch(e){console.error("ServiceWorker message handler threw",e)}})))};this.addMessageEventListener=function(e){o.push(e)},this.removeMessageEventListener=function(e){var t=o.indexOf(e);t>=0&&o.splice(t,1)},n()}}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o,r;o=[n(52)],void 0===(r=function(e){return function(t){var n,o=new t._protected.Promise.Deferred;return t._protected.Config=new function(){var r=null;n=function(){t._protected.Blocker.category("ready").add("config"),t.preInstantiationPromise.then((function(){Promise.all([t._protected.Options.getModuleInitializationPromise(),t._protected.Storage.getModuleInitializationPromise()]).then((function(){i()}))}))},this.isConfigLoaded=function(){return!!r},this.getModuleInitializationPromise=function(){return o.promise};var i=function(){if(!t._protected.Options.getWebKey())return void s({});var n=t._protected.Constants.CONFIG_URL_PATTERN;n=n.replace(/\${webkey}/,t._protected.Options.getWebKey()),n+="?_="+ +new Date;const o=new e.FetchRemoteConfigFetcher(new URL(n)),r=new e.IndexDbRemoteConfigStorage(t._protected.Storage),i={broadcast:(e,n)=>{t._protected.Integration.getModuleInitializationPromise().then(()=>t._protected.Integration.broadcast(e,n))},addBroadcastListener:(e,n)=>{t._protected.Integration.getModuleInitializationPromise().then(()=>t._protected.Integration.addBroadcastListener(e,n))}};this.remoteConfigManager=new e.RemoteConfigManager(o,r,i),this.remoteConfigManager.read().then(e=>{s(e.data)}).catch(e=>console.log("Could not fetch config. Please try again later.",e))}.bind(this),a=[];this.addConfigProcessor=function(e){a.push(e)};var s=function(e){s=function(){},a.forEach((function(t){t(e)})),r=e,c()},c=function(){var e=r.options||{},n=e.defaults||{},i=e.override||{};t._protected.Options.merge(n,i),t._protected.Blocker.category("ready").remove("config"),o.resolve()};this.invalidateConfig=function(){return t._protected.Storage.bulk([{test:{key:"config",defaultValue:null,operationsCb:function(e){return e.date=0,{put:{key:"config",value:e}}}}}])}},n(),o.promise}}.apply(t,o))||(e.exports=r)},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),a=n(53),s=function(e){function t(n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o}return r(t,e),t}(Error);t.InvalidFormatError=s;var c,p=function(e){function t(n){var o=e.call(this,n)||this;return Object.setPrototypeOf(o,t.prototype),o}return r(t,e),t}(Error);t.FetchRateLimitError=p,function(e){e[e.ascending=-1]="ascending",e[e.same=0]="same",e[e.descending=1]="descending"}(c=t.ComparisonResult||(t.ComparisonResult={}));t.disableConfigFetchKey="disableConfigFetch",t.remoteConfigStorageKey="remoteConfig";var u="[remoteconfig]",d=function(){function e(e,t,n,o,r){void 0===n&&(n=new Date),void 0===o&&(o=0),void 0===r&&(r=0),this.data=e,this.version=t,this.fetchDate=n,this.maxAge=o,this.minAge=r}return e.compareVersions=function(e,t){var n=a.validate(e),o=a.validate(t);return!n&&o?c.ascending:!o&&n?c.descending:n||o?a(e,t):c.same},e.prototype.toJSON=function(){return{data:this.data,version:this.version,fetchDate:this.fetchDate.getTime(),maxAge:this.maxAge,minAge:this.minAge}},e.fromJSON=function(t){if("object"==typeof t){var n=t.data,o=t.version,r=t.fetchDate,i=t.maxAge,a=t.minAge;if("string"==typeof o)return new e("object"==typeof n?n:{},o,"number"==typeof r?new Date(r):new Date(0),"number"==typeof i?i:0,"number"==typeof a?a:0)}},e.prototype.hasHigherVersionThan=function(t){return e.compareVersions(this.version,t.version)===c.descending},Object.defineProperty(e.prototype,"isExpired",{get:function(){return this.maxAge>0&&+new Date-this.fetchDate.getTime()>this.maxAge},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasReachedMinAge",{get:function(){return+new Date-this.fetchDate.getTime()>=this.minAge},enumerable:!0,configurable:!0}),e}();t.RemoteConfig=d,t.RemoteConfigUpdatedBroadcastType="RemoteConfigUpdated",t.RemoteConfigToUpdateBroadcastType="RemoteConfigToUpdate";var l=function(){function e(e,n,o){var r=this;this.remoteConfigFetcher=e,this.remoteConfigStorage=n,this.broadcastInterface=o,this.minimumFetchInterval=5e3,this.minimumConfigAge=0,this.maximumConfigAge=864e6,this.isFetching=!1,this.queuedHandlers=[],o.addBroadcastListener(t.RemoteConfigToUpdateBroadcastType,(function(e,t){var n=d.fromJSON(t);n&&(r.storedConfig&&!n.hasHigherVersionThan(r.storedConfig)||(r.storedHighestVersion=n.version,r.storedConfig=n,r.remoteConfigStorage.storeRemoteConfig(n).catch((function(e){return i.error(u,"[RemoteConfigManager] Could not store config",e)})).then((function(){return r.remoteConfigStorage.declareVersion(n.version)})).catch((function(e){return i.error(u,"[RemoteConfigManager] Could not declare config version",e)}))))}))}return e.prototype.declareVersion=function(e){var t=this;return this.remoteConfigStorage.declareVersion(e).then((function(){return t.storedHighestVersion&&d.compareVersions(t.storedHighestVersion,e)!==c.ascending||(t.storedHighestVersion=e),t.readConfigAndHighestDeclaredVersionFromStorage()}),(function(e){return i.error(u,"[declareVersion]","Error declaring version to storage",e),t.readConfigAndHighestDeclaredVersionFromStorage()})).then((function(n){var o,r=n[0],i=n[1];if(r){if(+new Date-r.fetchDate.getTime()<t.minimumConfigAge||!r.hasReachedMinAge)return;if(d.compareVersions(r.version,e)===c.same){var a=new d(r.data,r.version,new Date,r.maxAge,r.minAge);return void t.remoteConfigStorage.storeRemoteConfig(a).then((function(){t.storedConfig=a}))}if(i&&d.compareVersions(r.version,i)!==c.ascending)return}var s=+new Date-((null===(o=t.lastFetchDate)||void 0===o?void 0:o.getTime())||0);if(!(t.lastFetchDate&&s<t.minimumFetchInterval))return t.fetchAndStoreConfigWithVersion(i,r)})).catch((function(e){i.error(u,"[declareVersion]","Could not get RemoteConfig from storage",e)})).then((function(){}))},e.prototype.read=function(){var e=this;return this.isFetching?new Promise((function(t,n){e.queuedHandlers.push({resolve:t,reject:n})})):this.readConfigAndHighestDeclaredVersionFromStorage().then((function(t){var n,o=t[0],r=t[1],i=+new Date-((null===(n=e.lastFetchDate)||void 0===n?void 0:n.getTime())||0);if(!o){if(e.lastFetchDate&&i<e.minimumFetchInterval)throw new p;return e.fetchAndStoreConfigWithVersion(void 0,o)}var a=c.ascending==d.compareVersions(o.version,r||""),s=a,u=r,l=+new Date-o.fetchDate.getTime();s&&(l<e.minimumConfigAge||l<o.minAge)&&(s=!1);var f=l>e.maximumConfigAge||o.isExpired;return!s&&f&&(s=!0,a||(u=o.version)),s&&e.lastFetchDate&&i<e.minimumFetchInterval&&(s=!1),s?e.fetchAndStoreConfigWithVersion(u,o).catch((function(e){return o})):o}))},e.prototype.readConfigAndHighestDeclaredVersionFromStorage=function(){var e=this;return this.storedConfig&&this.storedHighestVersion?Promise.resolve([this.storedConfig,this.storedHighestVersion]):this.remoteConfigStorage.loadRemoteConfigAndHighestDeclaredVersion().then((function(t){var n=t[0],o=t[1];return n&&(e.storedConfig=n),o&&(e.storedHighestVersion=o),[n,o]}))},e.prototype.resolveHandlers=function(e){this.queuedHandlers.splice(0,this.queuedHandlers.length).forEach((function(t){return t.resolve(e)}))},e.prototype.rejectHandlers=function(e){this.queuedHandlers.splice(0,this.queuedHandlers.length).forEach((function(t){return t.reject(e)}))},e.prototype.fetchAndStoreConfigWithVersion=function(e,n){var o=this;return n&&n.data[t.disableConfigFetchKey]?Promise.resolve(n):this.isFetching?new Promise((function(e,t){o.queuedHandlers.push({resolve:e,reject:t})})):(this.isFetching=!0,this.lastFetchDate=new Date,this.remoteConfigFetcher.fetchConfigWithVersion(e).catch((function(e){throw i.error(u,"[fetchAndStoreConfigWithVersion]","Could not fetch RemoteConfig from server",e),o.rejectHandlers(e),o.isFetching=!1,e})).then((function(e){return n&&n.hasHigherVersionThan(e)?(o.resolveHandlers(n),o.isFetching=!1,n):o.remoteConfigStorage.storeRemoteConfig(e).catch((function(e){throw i.error(u,"[fetchAndStoreConfigWithVersion]","Could not store RemoteConfig",e),o.rejectHandlers(e),o.isFetching=!1,e})).then((function(){return o.remoteConfigStorage.declareVersion(e.version).catch((function(e){i.error(u,"[fetchAndStoreConfigWithVersion]","Error declaring version to storage",e)})).then((function(){return o.storedConfig=e,o.isFetching=!1,n&&!e.hasHigherVersionThan(n)||(o.broadcastInterface.broadcast(t.RemoteConfigToUpdateBroadcastType,e.toJSON()),o.broadcastInterface.broadcast(t.RemoteConfigUpdatedBroadcastType,e.toJSON())),o.resolveHandlers(e),e}))}))})))},e}();t.RemoteConfigManager=l;var f=function(){function e(e){this.storageModule=e}return e.prototype.declareVersion=function(e){return this.storageModule.bulk([{test:{key:t.remoteConfigStorageKey,defaultValue:{},operationsCb:function(n){var o=n.highestVersion;return o&&d.compareVersions(e,o)!==c.descending||(n.highestVersion=e),{put:{key:t.remoteConfigStorageKey,value:n}}}}}]).then((function(){}))},e.prototype.loadRemoteConfigAndHighestDeclaredVersion=function(){return this.storageModule.get(t.remoteConfigStorageKey,{}).then((function(e){var t=null==e?void 0:e.highestVersion;return[(null==e?void 0:e.serializedConfig)?d.fromJSON(e.serializedConfig):void 0,t]}))},e.prototype.storeRemoteConfig=function(e){return this.storageModule.bulk([{test:{key:t.remoteConfigStorageKey,defaultValue:{},operationsCb:function(n){var o=n.serializedConfig?d.fromJSON(n.serializedConfig):void 0;return o&&o.hasHigherVersionThan(e)?{}:(n.serializedConfig=e.toJSON(),{put:{key:t.remoteConfigStorageKey,value:n}})}}}]).then((function(){}))},e}();t.IndexDbRemoteConfigStorage=f;var g=function(){function e(e){this.url=e}return e.prototype.fetchConfigWithVersion=function(t){var n=new URL(this.url.toString());return fetch(n.toString()).then((function(e){return e.json()})).then((function(t){return e.parseConfigJSON(t)}))},e.parseConfigJSON=function(e){var t=e.version;if("number"==typeof t&&(t=""+t),"string"!=typeof t)throw new s;var n=t,o=e.maxAge;void 0===o&&(o=e.cacheTtl);var r="number"==typeof o?o:0,i=e.minAge;void 0===i&&(i=e.cacheMinAge);var a="number"==typeof i?i:0;return new d(e,n,new Date,r,a)},e}();t.FetchRemoteConfigFetcher=g},function(e,t,n){var o,r;void 0===(r="function"==typeof(o=function(){var e=/^v?(?:\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+)(\.(?:[x*]|\d+))?(?:-[\da-z\-]+(?:\.[\da-z\-]+)*)?(?:\+[\da-z\-]+(?:\.[\da-z\-]+)*)?)?)?$/i;function t(e){var t,n=e.replace(/^v/,"").replace(/\+.*$/,""),o=("-",-1===(t=n).indexOf("-")?t.length:t.indexOf("-")),r=n.substring(0,o).split(".");return r.push(n.substring(o+1)),r}function n(e){return isNaN(Number(e))?e:Number(e)}function o(t){if("string"!=typeof t)throw new TypeError("Invalid argument expected string");if(!e.test(t))throw new Error("Invalid argument not valid semver ('"+t+"' received)")}function r(e,r){[e,r].forEach(o);for(var i=t(e),a=t(r),s=0;s<Math.max(i.length-1,a.length-1);s++){var c=parseInt(i[s]||0,10),p=parseInt(a[s]||0,10);if(c>p)return 1;if(p>c)return-1}var u=i[i.length-1],d=a[a.length-1];if(u&&d){var l=u.split(".").map(n),f=d.split(".").map(n);for(s=0;s<Math.max(l.length,f.length);s++){if(void 0===l[s]||"string"==typeof f[s]&&"number"==typeof l[s])return-1;if(void 0===f[s]||"string"==typeof l[s]&&"number"==typeof f[s])return 1;if(l[s]>f[s])return 1;if(f[s]>l[s])return-1}}else if(u||d)return u?-1:1;return 0}var i=[">",">=","=","<","<="],a={">":[1],">=":[0,1],"=":[0],"<=":[-1,0],"<":[-1]};return r.validate=function(t){return"string"==typeof t&&e.test(t)},r.compare=function(e,t,n){!function(e){if("string"!=typeof e)throw new TypeError("Invalid operator type, expected string but got "+typeof e);if(-1===i.indexOf(e))throw new TypeError("Invalid operator, expected one of "+i.join("|"))}(n);var o=r(e,t);return a[n].indexOf(o)>-1},r})?o.apply(t,[]):o)||(e.exports=r)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Helper.supportsVAPID=function(){return"undefined"!=typeof PushSubscriptionOptions&&"applicationServerKey"in PushSubscriptionOptions.prototype}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Time={},e._protected.Time.getRealTime=function(){return Date.now()}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Constants.SERVICE_WORKER_URL="wonderpush-worker-loader.min.js?webKey=${webKey}",e._protected.Constants.FRAME_URL="wonderpush.min.html",e._protected.Constants.MANIFEST_URL="wonderpush-manifest.json",e._protected.Constants.REDIRECT_URL="wonderpush-redirect.html?url=${url}",e.prototype.Constants={},e.prototype.Constants.SDK_VERSION="1.1.28.2",e.prototype.Constants.SDK_SHORT_VERSION=e.prototype.Constants.SDK_VERSION.split(".").slice(0,2).join("."),e._protected.Constants.ROOT_API_URL="api.wonderpush.com",e._protected.Constants.API_VERSION="v1",e._protected.Constants.MEASUREMENTS_API_BASE_URL="https://measurements-api.wonderpush.com/v1",e._protected.Constants.DEFAULT_LANGUAGE_CODE="en",e._protected.Constants.VALID_LANGUAGE_CODES=["af","ar","be","bg","bn","ca","cs","da","de","el","en","en_GB","en_US","es","es_ES","es_MX","et","fa","fi","fr","fr_FR","fr_CA","he","hi","hr","hu","id","is","it","ja","ko","lt","lv","mk","ms","nb","nl","pa","pl","pt","pt_PT","pt_BR","ro","ru","sk","sl","sq","sr","sv","sw","ta","th","tl","tr","uk","vi","zh","zh_CN","zh_TW","zh_HK"],e._protected.Constants.DEFAULT_DOMAIN_SUFFIX=".by.wonderpush.com",e._protected.Constants.CDN_ROOT_HREF="https://cdn"+e._protected.Constants.DEFAULT_DOMAIN_SUFFIX+"/",e._protected.Constants.CONFIG_URL_PATTERN=e._protected.Constants.CDN_ROOT_HREF+"config/webkeys/${webkey}",e._protected.Constants.PLUGIN_ROOT_URL=e._protected.Constants.CDN_ROOT_HREF+"plugins/",e._protected.Constants.PARTNER_DOMAIN_DEFAULT_URL_SUFFIX="sdk/",e._protected.Constants.CONFIG_FETCH_WAIT_BEFORE_RETRY_MS=1e4,e._protected.Constants.CONFIG_FETCH_MAX_TRIES=3,e._protected.Constants.CONFIG_CACHE_DEFAULT_TTL=432e5,e._protected.Constants.CONFIG_MISSING_CACHE_TTL=9e5,e._protected.Constants.GET_DELIVERIES_TRIES=3,e._protected.Constants.GET_DELIVERIES_ERROR_WAIT_MS=1e4,e._protected.Constants.GET_DELIVERIES_RANDOM_WAIT_MIN_MS=0,e._protected.Constants.GET_DELIVERIES_RANDOM_WAIT_MAX_MS=5e3,e._protected.Constants.GEOLOCATION_SUPPORTED="geolocation"in navigator,e._protected.Constants.GEOLOCATION_MAXIMUM_AGE=3e5,e._protected.Constants.GEOLOCATION_OPTIONS_FIRST_FIX={enableHighAccuracy:!1,timeout:0,maximumAge:e._protected.Constants.GEOLOCATION_MAXIMUM_AGE},e._protected.Constants.GEOLOCATION_OPTIONS={enableHighAccuracy:!1,timeout:e._protected.Constants.GEOLOCATION_MAXIMUM_AGE,maximumAge:e._protected.Constants.GEOLOCATION_MAXIMUM_AGE},e._protected.Constants.DIFFERENT_SESSION_REGULAR_MIN_TIME_GAP=18e5,e._protected.Constants.DIFFERENT_SESSION_NOTIFICATION_MIN_TIME_GAP=9e5,e._protected.Constants.INSTALLATION_CORE_PROPERTIES_CACHE=6048e5,e._protected.Constants.INSTALLATION_PUSH_TOKEN_CACHE=e._protected.Constants.INSTALLATION_CORE_PROPERTIES_CACHE,e._protected.Constants.SW_MAX_PAGELOAD_MS=6e4,e._protected.Constants.SW_CHECK_PAGELOADED_INTERVAL_MS=250,e._protected.Constants.SW_PING_TIMEOUT_MS=2e3,e._protected.Constants.SUBSCRIPTION_SWITCH_ELEMENT_ID_DEFAULT="wonderpush-subscription-switch",e._protected.Constants.SUBSCRIPTION_MODE_DEFAULT="visits",e._protected.Constants.SUBSCRIPTION_MIN_VISITS_DEFAULT=2,e._protected.Constants.SUBSCRIPTION_MIN_PAGES_DEFAULT=3,e._protected.Constants.SUBSCRIPTION_DELAY_DEFAULT=0,e._protected.Constants.SUBSCRIPTION_SNOOZE_DEFAULT=6048e5,e._protected.Constants.POPUP_AUTOCLOSE_SLEEP=3e3,e._protected.Constants.PUSH_MANAGER_SUBSCRIBE_TOO_LONG=5e3,e._protected.Constants.ACTION_METHOD="method",e._protected.Constants.ACTION_LINK="link",e._protected.Constants.ACTION_TRACK_EVENT="trackEvent",e._protected.Constants.ACTION_UPDATE_INSTALLATION="updateInstallation",e._protected.Constants.ACTION_SUBSCRIBE_TO_NOTIFICATIONS="subscribeToNotifications",e._protected.Constants.ACTION_ADD_PROPERTY="addProperty",e._protected.Constants.ACTION_REMOVE_PROPERTY="removeProperty",e._protected.Constants.ACTION_RESYNC_INSTALLATION="resyncInstallation",e._protected.Constants.ACTION_ADD_TAG="addTag",e._protected.Constants.ACTION_REMOVE_TAG="removeTag",e._protected.Constants.ACTION_REMOVE_ALL_TAGS="removeAllTags",e._protected.Constants.ACTION__OVERRIDE_NOTIFICATION_RECEIPT="_overrideNotificationReceipt",e._protected.Constants.PER_USER_INSTALLATION_CUSTOM_PROPERTIES_STORAGE_KEY="perUserInstallationCustomProperties",e._protected.Constants.EVENTS_STORAGE_KEY="events",e._protected.Constants.JSON_SYNC_MAX_INFLIGHT_TIME=Math.round(1.1*e._protected.Constants.REQUEST_TIMEOUT_MS)+1e3,e._protected.Constants.CACHED_INSTALLATION_CUSTOM_PROPERTIES_MIN_DELAY=0,e._protected.Constants.CACHED_INSTALLATION_CUSTOM_PROPERTIES_MAX_DELAY=0,e._protected.Constants.FEDERATED_FRAME_URL=e._protected.Constants.CDN_ROOT_HREF+e._protected.Constants.PARTNER_DOMAIN_DEFAULT_URL_SUFFIX+e.prototype.Constants.SDK_VERSION+"/"+e._protected.Constants.FRAME_URL,e._protected.Constants.STORELOOP_WEBKEY="d94e437fcebe9b6abd33b391daf02ae151cefd9838ec80d287869abfbcd8e89b",e._protected.Constants.GOOGLE_ANALYTICS_PROPERTY_ID="UA-56491200-3",e._protected.Constants.GOOGLE_ANALYTICS_STORAGE_DATABASE_NAME="WP_analytics",e._protected.Constants.PRESENCE_ANTICIPATED_TIME_MS=3e5,e._protected.Constants.PRESENCE_UPDATE_SAFETY_MARGIN=6e4,e._protected.Constants.BROADCAST_TYPE_SET_USER_CONSENT="setUserConsent",e._protected.Constants.DEFAULT_LAST_RECEIVED_NOTIFICATION_CHECK_DELAY=6048e5,e._protected.Constants.LAST_RECEIVED_NOTIFICATION_CHECK_DATE_STORAGE_KEY="lastReceivedNotificationCheckDate",e._protected.Constants.LAST_RECEIVED_NOTIFICATION_CHECK_DATE_INSTALLATION_KEY="lastReceivedNotificationCheckDate",e._protected.Constants.LAST_RECEIVED_NOTIFICATION_CHECK_DELAY_PAYLOAD_KEY="lastReceivedNotificationCheckDelay",e._protected.Constants.FORCED_INAPPS_STORAGE_KEY="forcedInApps"}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(){}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t,n=new e._protected.Promise.Deferred,o={},r={},i=function(e){var t=r[e];t&&o[e]&&(o[e].forEach((function(e){e.resolve(t)})),delete o[e])};return e._protected.Analytics=new function(){var a;this.getModuleInitializationPromise=function(){return n.promise};var s={},c=function(t,n){for(var o=e._protected.Constants.ANALYTICS_EXPERIMENTS||{},r=0;o[t]&&r<o[t].variants.length;r++)if(o[t].variants[r].name===n)return r;return-1};t=function(){if(e._protected.RunModes.Behaviors.Analytics)return e._protected.Analytics.getUserData().then((function(t){return(a=t).experiments&&Object.keys(a.experiments).forEach((function(t){e._protected.Analytics.activateExperimentVariant(t,a.experiments[t])})),e._protected.Blocker.category("analytics").wait()})).then(n.resolve).catch(n.reject);n.resolve()},this.setExperimentVariant=function(t,n){(e._protected.Constants.ANALYTICS_EXPERIMENTS||{})[t]?(a&&a.experiments&&(a.experiments[t]=n),e._protected.Analytics.activateExperimentVariant(t,n),e._protected.Analytics.saveExperimentVariantToDatabase(t,n)):e._protected.Helper.warn("[analytics   ]","Experiment not found:"+t)},this.activateExperimentVariant=function(t,n){t&&n&&(e._protected.RunModes.Behaviors.ModeFrame&&e._protected.Integration.callOnParentWindow("SDK._protected.Analytics.activateExperimentVariant",[t,n]),r[t]=n,i(t))},this.saveExperimentVariantToDatabase=e._protected.Integration.proxifyToCustomDomain("SDK._protected.Analytics.saveExperimentVariantToDatabase",(function(t,n){e._protected.Storage.get(e._protected.Constants.GOOGLE_ANALYTICS_USER_DATA_STORAGE_KEY,{},e._protected.Constants.GOOGLE_ANALYTICS_STORAGE_DATABASE_NAME).then((function(o){var r=o.experiments||{};return r[t]=n,o.experiments=r,e._protected.Storage.set(e._protected.Constants.GOOGLE_ANALYTICS_USER_DATA_STORAGE_KEY,o,e._protected.Constants.GOOGLE_ANALYTICS_STORAGE_DATABASE_NAME)}))})),this.getUserData=e._protected.Integration.proxifyToCustomDomain("SDK._protected.Analytics.getUserData",(function(){var t;return e._protected.Storage.bulk([{test:{key:e._protected.Constants.GOOGLE_ANALYTICS_USER_DATA_STORAGE_KEY,defaultValue:{},operationsCb:function(n){if(n.cid||(n.cid=e._protected.Helper.uuidv4()),e._protected.RunModes.Behaviors.AnalyticsExperiments){n.experiments||(n.experiments={});var o=e._protected.Constants.ANALYTICS_EXPERIMENTS||{};Object.keys(o).forEach((function(t){n.experiments[t]&&-1<c(t,n.experiments[t])||(n.experiments[t]=function(t){var n=(e._protected.Constants.ANALYTICS_EXPERIMENTS||{})[t];if(n)for(var o=Math.random(),r=0,i=0;i<n.variants.length;i++)if(o<(r+=n.variants[i].weight))return n.variants[i].name}(t))}))}return t=n,{put:{key:e._protected.Constants.GOOGLE_ANALYTICS_USER_DATA_STORAGE_KEY,value:n}}}}}],e._protected.Constants.GOOGLE_ANALYTICS_STORAGE_DATABASE_NAME).then((function(){return t}))})),this.setCustomDimension=function(e,t){s[e]=t},this.sendEvent=function(t,n,o,r,i){if(!e._protected.RunModes.Behaviors.Analytics)return!1;var p="/events/"+(t||"null")+"/"+(n||"null");if(i||(i=e._protected.Options.getWebKey()),!a.cid)return Promise.reject(new e.prototype.Errors.InternalError("Could not find google CID"));var u="";e._protected.RunModes.Behaviors.AnalyticsExperiments&&(u="exp="+encodeURIComponent(Object.keys(a.experiments).map((function(t){var n=a.experiments[t],o=function(t){var n=e._protected.Constants.ANALYTICS_EXPERIMENTS||{};return n[t]?n[t].identifier:null}(t);if(!n||!o)return"";var r=c(t,n);return-1===r?"":o+"."+r})).join("!")));var d="undefined"!=typeof navigator&&navigator.userAgent||"",l="undefined"!=typeof screen&&screen.availWidth&&screen.availHeight&&screen.availWidth+"x"+screen.availHeight||"",f="undefined"!=typeof window&&window.innerWidth&&window.innerHeight&&window.innerWidth+"x"+window.innerHeight||"",g="undefined"!=typeof document&&document.characterSet||"",h="undefined"!=typeof screen&&screen.colorDepth&&screen.colorDepth+"-bit"||"",m="undefined"!=typeof navigator&&navigator.language&&navigator.language.toLowerCase()||"",v="v=1&cid="+encodeURIComponent(a.cid)+"&tid="+encodeURIComponent(e._protected.Constants.GOOGLE_ANALYTICS_PROPERTY_ID)+(d&&"&ua="+encodeURIComponent(d)||"")+(l&&"&sr="+encodeURIComponent(l)||"")+(f&&"&vp="+encodeURIComponent(f)||"")+(g&&"&de="+encodeURIComponent(g)||"")+(h&&"&sd="+encodeURIComponent(h)||"")+(m&&"&ul="+encodeURIComponent(m)||"")+(i?"&cs="+encodeURIComponent(i):"")+"&"+u+"&"+Object.keys(s).map((function(e){return encodeURIComponent(e.replace("dimension","cd"))+"="+encodeURIComponent(""+s[e])})).join("&"),_="https://www.google-analytics.com/batch",y=[v+"&t=event&ec="+(t?encodeURIComponent(t):"")+"&ea="+(n?encodeURIComponent(n):"")+"&el="+(o?encodeURIComponent(o):"")+(r?"&ev="+r:""),v+"&t=pageview"+(o?"&dt="+encodeURIComponent(o):"")+"&dh="+encodeURIComponent(e._protected.Integration.getHomeUrlObject().hostname)+"&dp="+p].join("\n");if("undefined"!=typeof navigator&&navigator.sendBeacon)return navigator.sendBeacon(_,y);var w=new e._protected.Promise.Deferred;return e._protected.Request.request("POST",_,y,void 0,void 0,{onload:function(){w.resolve()},onerror:function(e){w.reject(e)}},void 0),w.promise},this.onExperiment=function(t){var n=new e._protected.Promise.Deferred;return o[t]=o[t]||[],o[t].push(n),i(t),n.promise}},e.preInstantiationPromise.then((function(){return Promise.all([e._protected.Storage.getModuleInitializationPromise(),e._protected.Integration.getModuleInitializationPromise(),e._protected.Locking.getModuleInitializationPromise()])})).then(t),n.promise}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e.prototype.Errors.ConsentError=function(t){e.prototype.Errors.Error.apply(this,arguments)},e.prototype.Errors.ConsentError.prototype=Object.create(e.prototype.Errors.Error.prototype,{name:{value:"WonderPushSDK.Errors.ConsentError"},constructor:{value:e.prototype.Errors.ConsentError}}),e.prototype.Errors.PermissionError=function(t,n,o){e.prototype.Errors.Error.call(this,t),this.permission=n,this.state=o},e.prototype.Errors.PermissionError.prototype=Object.create(e.prototype.Errors.Error.prototype,{name:{value:"WonderPushSDK.Errors.PermissionError"},constructor:{value:e.prototype.Errors.PermissionError}}),e.prototype.Errors.UserCancellationError=function(t){e.prototype.Errors.Error.apply(this,arguments)},e.prototype.Errors.UserCancellationError.prototype=Object.create(e.prototype.Errors.Error.prototype,{name:{value:"WonderPushSDK.Errors.UserCancellationError"},constructor:{value:e.prototype.Errors.UserCancellationError}}),e.prototype.Errors.RegistrationInProgressError=function(t){e.prototype.Errors.Error.apply(this,arguments)},e.prototype.Errors.RegistrationInProgressError.prototype=Object.create(e.prototype.Errors.Error.prototype,{name:{value:"WonderPushSDK.Errors.RegistrationInProgressError"},constructor:{value:e.prototype.Errors.RegistrationInProgressError}}),e.prototype.Errors.PushNotificationsNotSupportedError=function(t){e.prototype.Errors.Error.apply(this,arguments)},e.prototype.Errors.PushNotificationsNotSupportedError.prototype=Object.create(e.prototype.Errors.Error.prototype,{name:{value:"WonderPushSDK.Errors.PushNotificationsNotSupportedError"},constructor:{value:e.prototype.Errors.PushNotificationsNotSupportedError}}),e.prototype.Errors.PopupError=function(t){e.prototype.Errors.Error.apply(this,arguments)},e.prototype.Errors.PopupError.prototype=Object.create(e.prototype.Errors.Error.prototype,{name:{value:"WonderPushSDK.Errors.PopupError"},constructor:{value:e.prototype.Errors.PopupError}}),e.prototype.Errors.NotificationPayloadError=function(t){e.prototype.Errors.Error.apply(this,arguments)},e.prototype.Errors.NotificationPayloadError.prototype=Object.create(e.prototype.Errors.Error.prototype,{name:{value:"WonderPushSDK.Errors.NotificationPayloadError"},constructor:{value:e.prototype.Errors.NotificationPayloadError}}),e.prototype.Errors.PluginError=function(t){e.prototype.Errors.Error.apply(this,arguments)},e.prototype.Errors.PluginError.prototype=Object.create(e.prototype.Errors.Error.prototype,{name:{value:"WonderPushSDK.Errors.PluginError"},constructor:{value:e.prototype.Errors.PluginError}}),e._protected.Errors.InternalConfigUnavailableError=function(t){e.prototype.Errors.InternalError.apply(this,arguments)},e._protected.Errors.InternalConfigUnavailableError.prototype=Object.create(e.prototype.Errors.InternalError.prototype,{name:{value:"WonderPushSDK.Errors.InternalConfigUnavailableError"},constructor:{value:e._protected.Errors.InternalConfigUnavailableError}}),e._protected.Errors.InternalWrongDomainError=function(t){e.prototype.Errors.InternalError.apply(this,arguments)},e._protected.Errors.InternalWrongDomainError.prototype=Object.create(e.prototype.Errors.InternalError.prototype,{name:{value:"WonderPushSDK.Errors.InternalWrongDomainError"},constructor:{value:e._protected.Errors.InternalWrongDomainError}}),e._protected.Errors.InternalWrongTargetError=function(t){e.prototype.Errors.InternalError.apply(this,arguments)},e._protected.Errors.InternalWrongTargetError.prototype=Object.create(e.prototype.Errors.InternalError.prototype,{name:{value:"WonderPushSDK.Errors.InternalWrongTargetError"},constructor:{value:e._protected.Errors.InternalWrongTargetError}})}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.RunModes.registerBehavior("CoreProperties",(function(t){return[e._protected.RunModes.Modes.WebSite,e._protected.RunModes.Modes.ServiceWorker,e._protected.RunModes.Modes.Popup].indexOf(t)>=0})),e._protected.RunModes.registerBehavior("Federated",(function(t){return t===e._protected.RunModes.Modes.Slave&&e._protected.Integration.isOnFederatedDomain()})),e._protected.RunModes.registerBehavior("Plugins",(function(t){return[e._protected.RunModes.Modes.WebSite,e._protected.RunModes.Modes.Frame,e._protected.RunModes.Modes.Popup,e._protected.RunModes.Modes.ServiceWorker].indexOf(t)>=0})),e._protected.RunModes.registerBehavior("Manifest",(function(t){return[e._protected.RunModes.Modes.WebSite,e._protected.RunModes.Modes.Popup,e._protected.RunModes.Modes.Frame].indexOf(t)>=0})),e._protected.RunModes.registerBehavior("Stylesheets",(function(){return e._protected.RunModes.Behaviors.Visible})),e._protected.RunModes.registerBehavior("Modal",(function(){return!1})),e._protected.RunModes.registerBehavior("NotificationPermission",(function(t){return[e._protected.RunModes.Modes.WebSite,e._protected.RunModes.Modes.Popup].indexOf(t)>=0})),e._protected.RunModes.registerBehavior("GeolocationPermission",(function(t){return t===e._protected.RunModes.Modes.WebSite})),e._protected.RunModes.registerBehavior("RegisterServiceWorker",(function(t){return[e._protected.RunModes.Modes.Frame,e._protected.RunModes.Modes.Popup].indexOf(t)>=0||t===e._protected.RunModes.Modes.WebSite&&e._protected.Integration.isOnRightDomain()})),e._protected.RunModes.registerBehavior("UnregisterServiceWorker",(function(t){return t===e._protected.RunModes.Modes.ServiceWorker||e._protected.RunModes.Behaviors.RegisterServiceWorker})),e._protected.RunModes.registerBehavior("CanRegisterServiceWorker",(function(t){return[e._protected.RunModes.Modes.Frame,e._protected.RunModes.Modes.WebSite,e._protected.RunModes.Modes.Popup].indexOf(t)>=0&&!!navigator.serviceWorker&&!!self.isSecureContext})),e._protected.RunModes.registerBehavior("RefreshPushToken",(function(t){var n=e._protected.Helper.detectBrowser();return"Chrome"===n.name&&t===e._protected.RunModes.Modes.Frame&&parseInt(n.version)>=71?e._protected.Integration.areTopWindowAndSelfOnRightDomain():e._protected.RunModes.Behaviors.SubscribeToPush&&t!==e._protected.RunModes.Modes.Popup})),e._protected.RunModes.registerBehavior("SubscribeToPush",(function(t){return e._protected.RunModes.Behaviors.RegisterServiceWorker||t===e._protected.RunModes.Modes.ServiceWorker&&e._protected.Helper.supportsVAPID()})),e._protected.RunModes.registerBehavior("UnsubscribeToPush",(function(t){return t===e._protected.RunModes.Modes.ServiceWorker||e._protected.RunModes.Behaviors.RegisterServiceWorker})),e._protected.RunModes.registerBehavior("OptionsSource",(function(t){return t===e._protected.RunModes.Modes.WebSite||t===e._protected.RunModes.Modes.Popup})),e._protected.RunModes.registerBehavior("Analytics",(function(e){return!1})),e._protected.RunModes.registerBehavior("ReadCurrentOrigin",(function(t){return[e._protected.RunModes.Modes.Frame,e._protected.RunModes.Modes.Popup,e._protected.RunModes.Modes.ServiceWorker,e._protected.RunModes.Modes.Slave].indexOf(t)>=0||t===e._protected.RunModes.Modes.WebSite&&e._protected.Integration.isOnRightDomain()}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){const{EventAttributionManager:t,ReportingDataUtil:o}=n(5);var r="[events      ]";e._protected.Events=new function(){this.WonderPushTrackEventEvent=function(t){return{event:t,name:e._protected.Events.WonderPushTrackEventEvent.TYPE,type:e._protected.Events.WonderPushTrackEventEvent.TYPE}},this.WonderPushTrackEventEvent.TYPE="trackEvent",this.WonderPushNotificationOpenedEvent=function(t){return{event:t,name:e._protected.Events.WonderPushNotificationOpenedEvent.TYPE,type:e._protected.Events.WonderPushNotificationOpenedEvent.TYPE}},this.WonderPushNotificationOpenedEvent.TYPE="notificationOpened",this.WonderPushSessionEvent=function(t){return{name:e._protected.Events.WonderPushSessionEvent.TYPE,type:e._protected.Events.WonderPushSessionEvent.TYPE,state:t}},this.WonderPushSessionEvent.TYPE="session",this.WonderPushSubscriptionEvent=function(t){return{name:e._protected.Events.WonderPushSubscriptionEvent.TYPE,type:e._protected.Events.WonderPushSubscriptionEvent.TYPE,state:t}},this.WonderPushSubscriptionEvent.TYPE="subscription",this.NewAppOpen=function(t){return{type:e._protected.Events.NewAppOpen.TYPE,visitCount:t}},this.NewAppOpen.TYPE="newAppOpen",this.NewPageView=function(){return{type:e._protected.Events.NewPageView.TYPE}},this.NewPageView.TYPE="newPageView",this.MethodCall=function(t,n){return{type:e._protected.Events.MethodCall.TYPE,method:t,methodArg:n}},this.MethodCall.TYPE="methodCall",this.fire=function(t){t.WonderPushSDK=e.this,e._protected.Helper.fireEvent(e._protected.gscope,"WonderPushEvent",t)},this.fireOnParentWindow=e._protected.Integration.proxifyToParentWindow("WonderPushSDK._protected.Events.fireOnParentWindow",(function(t){e._protected.Events.fire(t)})),this.listen=function(t){var n=self._wp_worker_addEventListener||function(t,n){e._protected.Helper.listenEvent(e._protected.gscope,t,n)};try{n("WonderPushEvent",t)}catch(t){console.warn(r,"Cannot listen to WonderPushEvent")}},this.unlisten=function(t){var n=self._wp_worker_removeEventListener||function(t,n){e._protected.Helper.unlistenEvent(e._protected.gscope,t,n)};try{n("WonderPushEvent",t)}catch(t){console.warn(r,"Cannot remove listener to WonderPushEvent")}},this.sendEvent=function(t,n,r,i,a){e._protected.Events.getCurrentAttribution().then(s=>{var c={};n=n||{};var p={};for(var u in n)n.hasOwnProperty(u)&&(p[u]=n[u]);o.assignEventData(p,s),p.type=t,p.actionDate=p.actionDate||e._protected.Time.getRealTime(),p.location=p.location||e._protected.Geo.getGeolocation(),p.location||delete p.location,r&&"object"==typeof r&&(p.custom=r),c.body=JSON.stringify(p),e._protected.Events.fireOnParentWindow(new e._protected.Events.WonderPushTrackEventEvent(p)),e._protected.Storage.getModuleInitializationPromise().then(()=>e._protected.Storage.bulk([{test:{key:e._protected.Constants.EVENTS_STORAGE_KEY,operationsCb:t=>{t=(t=Array.isArray(t)?t:[]).filter(e=>e.type!==p.type);const n=JSON.parse(JSON.stringify(p));return n.collapsing="last",t.push(n),[{put:{key:e._protected.Constants.EVENTS_STORAGE_KEY,value:t}}]}}}]));const d=a&&a.useMeasurementsApi?e._protected.Options.getMeasurementsApiUrlPrefix()+"/events":"/events",l=()=>a&&a.useBeacon?e._protected.Consent.awaitUserConsent().then(()=>e.this.Rest.postBeacon(d,c,i)):a&&a.postImmediately?e._protected.Consent.awaitUserConsent().then(()=>e.this.Rest.post(d,c,void 0)):(e.this.Rest.postEventually(d,c,void 0),Promise.resolve());if(a&&a.useMeasurementsApi){c.clientId=e._protected.Options.getWebKey(),c.devicePlatform="Web";const t=e._protected.Options.getUserId();return t&&(c.userId=t),e._protected.Init.getDeviceId().then(e=>(c.deviceId=e,l()))}return l()})},this.getCurrentAttribution=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Events.getCurrentAttribution",(function(){return new t(e._protected.Storage).currentAttribution()})),this.getAllEvents=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Events.getAllEvents",(function(){return e._protected.Storage.getModuleInitializationPromise().then(()=>e._protected.Storage.get(e._protected.Constants.EVENTS_STORAGE_KEY,[]).then(e=>e.map(e=>(e.creationDate||(e.creationDate=e.actionDate),e))))}))}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o,r;o=[n(63)],void 0===(r=function(e){return function(t){var n=new t._protected.Promise.Deferred,o=function(){if(t._protected.RunModes.Behaviors.Stylesheets){const n=t._protected.Options.getStylesheetUrl();n&&"wonderpush.min.css"!==n?t._protected.Integration.injectStylesheetLink(n):t._protected.Integration.injectStylesheetInline(e.toString())}if(a(),t._protected.RunModes.Behaviors.ModeWebSite){var n=t._protected.gscope._wp_loaderScriptUrl;if(n){delete t._protected.gscope._wp_loaderScriptUrl;var o=(n.match(/by\.wonderpush\.com\/sdk\/([0-9\.]*)\//)||[])[1];o&&t._protected.Integration.getFrameReadyPromise().then((function(){t._protected.Integration.callOnCustomDomain("WonderPushSDK._protected.Storage.set",["sdkLoaderUrlVersion",o])}))}}(t._protected.RunModes.Behaviors.ModeFrame||t._protected.RunModes.Behaviors.ModeWebSite&&t._protected.Integration.isOnRightDomain())&&t._protected.Storage.set("sdkVersion",t._protected.Constants.SDK_VERSION)},r=function(e){var n,o=t._protected.Options.getCustomDomain()||("undefined"!=typeof registration?registration.scope:void 0)||location.origin;try{n=new URL(o)}catch(r){o.indexOf(".")<0&&"localhost"!==o&&(o+=t._protected.Constants.DEFAULT_DOMAIN_SUFFIX),o.endsWith("/")||(o+="/"),o="full"===e?"https://"+o+t._protected.Constants.PARTNER_DOMAIN_DEFAULT_URL_SUFFIX+t._protected.Constants.SDK_VERSION+"/":"short"===e?"https://"+o+t._protected.Constants.PARTNER_DOMAIN_DEFAULT_URL_SUFFIX+t._protected.Constants.SDK_SHORT_VERSION+"/":"https://"+o+t._protected.Constants.PARTNER_DOMAIN_DEFAULT_URL_SUFFIX,n=new URL(o)}return n.protocol="https:","/"!==n.href.slice(-1)&&(n=new URL(n.href+"/")),n},i=function(e){return r(e).href};t._protected.Integration.getCurrentOperatingOrigin=function(){return t._protected.RunModes.Behaviors.ReadCurrentOrigin?location.origin:null},t._protected.Integration.getHomeUrlObject=function(){return r()},t._protected.Integration.getServiceWorkerUrl=function(){var e=new URL(t._protected.Options.getServiceWorkerUrl(),i("none"));return e.protocol="https:",e.href},t._protected.Integration.getFrameUrl=function(){var e=new URL(t._protected.Options.getFrameUrl(),i("full"));return e.protocol="https:",e.href},t._protected.Integration.getRedirectionPageUrl=function(e){var n=new URL(t._protected.Options.getRedirectionPageUrl(e),i("full"));return n.protocol="https:",n.href},t._protected.Integration.getManifestInjectedPromise=function(){return n.promise};var a=function(){if(t._protected.RunModes.Behaviors.Manifest&&!document.head.querySelector('link[rel=manifest][href^="'+t._protected.Integration.getHomeOrigin()+'"]')){var e=document.createElement("link");e.rel="manifest",e.href=((o=new URL(t._protected.Options.getManifestUrl(),i("full"))).protocol="https:",o.href),document.head.appendChild(e)}var o;n.resolve()};t._protected.Integration.isOnFederatedDomain=function(){return location.origin===new URL(t._protected.Constants.FEDERATED_FRAME_URL).origin},t.preInstantiationPromise.then((function(){t._protected.Integration.getModuleInitializationPromise().then(o)}))}}.apply(t,o))||(e.exports=r)},function(e,t,n){var o=n(6),r=n(64),i=n(65);(t=o(!1)).i(r),t.i(i),t.push([e.i,"\n",""]),e.exports=t},function(e,t,n){(t=n(6)(!1)).push([e.i,"BODY.modal-open {\n  overflow: hidden;\n}\n\n.wp-modal {\n  z-index: 10000;\n  position: fixed;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background-color: rgba(0, 0, 0, 0.75);\n  overflow: auto;\n}\n\n.wp-modal > .wp-modal-wrapper-outer {\n  display: flex;\n  height: 100%;\n}\n\n.wp-modal > .wp-modal-wrapper-outer > .wp-modal-wrapper-inner {\n  margin: auto;\n  max-height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n.wp-modal > .wp-modal-wrapper-outer > .wp-modal-wrapper-inner > .wp-modal-block {\n  display: flex;\n  flex-direction: column;\n  max-width: 30em;\n  max-height: 50em;\n  border: 1px solid #E0E0E0;\n  border-radius: 2px;\n  box-shadow: 0 0.2em 2em black;\n  background-color: #FFF;\n  color: #333;\n  margin: 1em;\n}\n\n.wp-modal-block > .wp-modal-title {\n  border-bottom: 2px solid #10ACFF;\n  color: #10ACFF;\n  padding: 0.7em 0.6em;\n  line-height: 1.2em;\n  font-size: 125%;\n  flex-shrink: 0;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n\n.wp-modal-title > .wp-modal-title-icon {\n  background-size: 2em 2em;\n  background-position: 50% 50%;\n  background-repeat: no-repeat;\n  width: 2em;\n  height: 2em;\n  flex-shrink: 0;\n  flex-grow: 0;\n  margin-right: 0.7em;\n}\n\n.wp-modal-title > .wp-modal-title-text {\n  flex-grow: 1;\n}\n\nwp-modal-block > .wp-modal-content {\n  overflow: auto;\n}\n\n.wp-modal-content > .wp-modal-text {\n  padding: 0.7em 0.6em;\n}\n\n.wp-modal-block > .wp-modal-buttons {\n  flex-shrink: 0;\n  display: flex;\n  flex-direction: row;\n  border-top: 1px solid #E0E0E0;\n}\n\n.wp-modal-buttons > .wp-modal-button {\n  flex: 1;\n  -moz-user-select: none;\n  border-right: 1px solid #E0E0E0;\n  cursor: pointer;\n  font-weight: normal;\n  line-height: 1.2em;\n  padding: 0.7em 0.6em;\n  text-align: center;\n  vertical-align: middle;\n  white-space: nowrap;\n}\n\n.wp-modal-buttons > .wp-modal-button:hover {\n  background-color: #f0f0f0;\n}\n\n.wp-modal-buttons > .wp-modal-button:last-child {\n  border-right: 0;\n}\n",""]),e.exports=t},function(e,t,n){(t=n(6)(!1)).push([e.i,".wp-popup {\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  font-family: arial;\n  text-align: center;\n  padding-left: 10px;\n  padding-right: 10px;\n}\n.wp-popup .wp-popup-content {\n  display: flex;\n  flex-flow: column;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  margin: 0 auto;\n  max-width: 350px;\n  min-width: 231px;\n}\n.wp-popup .wp-popup-title {\n  font: bold 18px arial;\n  margin-bottom: 12px;\n}\n.wp-popup .wp-popup-message {\n  font: 15px arial;\n  color: #777;\n  margin-bottom: 25px;\n}\n.wp-popup .wp-popup-example {\n  background-color: #fff;\n  height: 80px;\n  box-shadow: 0 0 20px #888888;\n  margin-bottom: 20px;\n  flex-flow: row nowrap;\n  display: flex;\n  align-self: stretch;\n}\n\n/* When used inside the notification example */\n.wp-popup .wp-popup-example .wp-popup-icon {\n  flex-basis: 80px;\n  width: 80px;\n  height: 80px;\n  flex-grow: 0;\n  flex-shrink: 0;\n  background-color: #efefef;\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: 50% 50%;\n}\n\n/* When used directly on the popup */\n.wp-popup #logo.wp-popup-icon {\n  background-size: contain;\n  background-repeat: no-repeat;\n  background-position: 50% 50%;\n}\n\n.wp-popup .wp-popup-example-text {\n  text-align: left;\n  flex: 1 auto;\n  padding: 10px 17px 8px 17px;\n  display: flex;\n  flex-flow: column nowrap;\n}\n.wp-popup .wp-popup-example-text>div {\n  flex: 0 auto;\n}\n\n.wp-popup .wp-popup-example-text .wp-popup-example-title {\n  font: 13px arial;\n  color: #3c3c3c;\n  margin-bottom: 5px;\n}\n.wp-popup .wp-popup-example-text .wp-popup-example-message {\n  flex-grow: 1;\n  font: 12px arial;\n  color: #3c3c3c;\n}\n.wp-popup .wp-popup-example-text .wp-popup-example-url {\n  font: 10px arial;\n  color: #9d9d9d;\n}\n.wp-popup .wp-popup-disclaimer {\n  font: 10px arial;\n  font-style: italic;\n  color: #b0b0b0;\n}\n.wp-popup .wp-popup-buttons {\n  padding: 20px;\n}\n\n.wp-popup .wp-popup-buttons .wp-popup-negative-button {\n  border: none;\n  background: none;\n  color: #777;\n  text-decoration: underline;\n  padding: 15px;\n  font-size:12px;\n  cursor: pointer;\n}\n.wp-popup .wp-popup-buttons .wp-popup-positive-button {\n  border: none;\n  background: #1a73e8;\n  color: white;\n  font-weight: bold;\n  text-decoration: none;\n  border-radius: 5px;\n  padding: 15px;\n  cursor: pointer;\n  font-size:20px;\n}",""]),e.exports=t},function(e,t,n){var o;void 0===(o=function(){return function(e){var t=e._protected.Consulate.createConsulate("federated");e._protected.Federated=new function(){this.ensureSetup=function(){if(e._protected.RunModes.Behaviors.ContextWindow){if(e._protected.RunModes.Behaviors.ModeSlave,e._protected.RunModes.Behaviors.Federated)throw new e._protected.Errors.InternalWrongTargetError("Must not create a frame on federated domain from a frame on federated domain");if(!t.isSetup()){var o=e._protected.Options.exportInitial(),r={_mode:e._protected.RunModes.Modes.Slave};"debug"in o&&(r.debug=o.debug),t.setup(n(),r)}}},this.getReadyPromise=function(){return t.getReadyPromise()},this.call=function(n,o){return e._protected.Federated.ensureSetup(),e._protected.Federated.getReadyPromise().then((function(){return e._protected.Integration.callOnSlave(t.getPostMessageTarget(),n,o)}))};var n=function(){return e._protected.Constants.FEDERATED_FRAME_URL}}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Storage.getDatabaseName=function(){return e._protected.RunModes.Behaviors.Federated?(e._protected.Helper.debug("[storage     ]","using federated database"),"WP_federated"):"WP_"+e._protected.Options.getWebKey()},e._protected.CustomDomainStorage=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.CustomDomainStorage",{getModuleInitializationPromise:e._protected.Storage.getModuleInitializationPromise,getDatabaseName:e._protected.Storage.getDatabaseName,getKeyValueStorageStoreName:e._protected.Storage.getKeyValueStorageStoreName,getMutexStoreName:e._protected.Storage.getMutexStoreName,get:e._protected.Storage.get,set:e._protected.Storage.set,rm:e._protected.Storage.rm,listObjectStores:e._protected.Storage.listObjectStores,deleteDatabase:e._protected.Storage.deleteDatabase})}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){let t=new e._protected.Promise.DynamicPromise;const n=new e._protected.Promise.Deferred;return e._protected.Consent={},e._protected.Consent.getUserConsent=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Consent.getUserConsent",(function(){return e._protected.Storage.get("userConsent").then(e=>{e=e||{};const{state:t}=e;return t})})),e._protected.Consent.hasUserConsent=function(){return e._protected.Consent.getUserConsent().then(t=>{const n=e._protected.Options.getRequiresUserConsent();return void 0!==t?t:!n})},e._protected.Consent.setUserConsent=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Consent.setUserConsent",(function(t){e._protected.Helper.debug("[consent     ]","[setUserConsent]",t);const n={state:!!t,updateDate:+new Date};return e._protected.Storage.set("userConsent",n).then(()=>{e._protected.Integration.broadcast(e._protected.Constants.BROADCAST_TYPE_SET_USER_CONSENT,n)})})),e._protected.Consent.awaitUserConsent=function(){return t.promise},e._protected.Consent.getModuleInitializationPromise=()=>n.promise,e.preInstantiationPromise.then(()=>Promise.all([e._protected.Integration.getModuleInitializationPromise(),e._protected.Options.getModuleInitializationPromise()])).then(()=>{n.resolve(),e._protected.RunModes.Behaviors.ModeWebSite&&e._protected.Blocker.category("ready").add("consent"),e._protected.Consent.hasUserConsent().then(n=>{n?(e._protected.Blocker.category("ready").remove("consent"),t.setResolved()):t.setPending()}),e._protected.Integration.addBroadcastListener(e._protected.Constants.BROADCAST_TYPE_SET_USER_CONSENT,()=>{e._protected.Consent.hasUserConsent().then(n=>{n?(t.setResolved(),e._protected.Blocker.category("ready").remove("consent")):t.setPending()})})}),n.promise}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e.prototype.SessionState={INIT_FAILED:-1,INIT_UNSTARTED:0,INIT_INPROGRESS:1,INIT_SUCCESS:2},Object.freeze(e.prototype.SessionState)}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t,n,o=[],r=Object.freeze({supportLevels:{optOut:{accessToken:!1,internalEvents:!1,customEvents:!1},optIn:{accessToken:!0,internalEvents:!0,customEvents:!1}}});t=function(){a(),e._protected.Config.addConfigProcessor((function(t){n=t;var o=t.options||{},r=o.defaults||{},i=o.override||{};"string"==typeof e._protected.Options.getNotificationIcon()&&"string"==typeof r.notificationIcon&&e._protected.Options.getNotificationIcon().startsWith("http://")&&r.notificationIcon.startsWith("https://")&&(i.notificationIcon=r.notificationIcon)})),e._protected.Blocker.category("accessToken").add("config"),e._protected.Blocker.category("integration").add("config"),e._protected.Config.getModuleInitializationPromise().then((function(){e._protected.RunModes.Behaviors.AccessToken&&e._protected.Integration.isOnRightDomain()&&c(),e._protected.Blocker.category("accessToken").remove("config"),e._protected.Blocker.category("integration").remove("config")}))};var i=function(){if(!e._protected.Config.isConfigLoaded())throw new e._protected.Errors.InternalConfigUnavailableError("Config not loaded yet");switch(e.prototype.Notification.getSubscriptionState()){default:case e.prototype.SubscriptionState.UNSUPPORTED:case e.prototype.SubscriptionState.UNSUBSCRIBED:case e.prototype.SubscriptionState.NOT_SUBSCRIBED:return"optOut";case e.prototype.SubscriptionState.SUBSCRIBED:return"optIn"}},a=function(){e._protected.Events.listen((function(e){n&&"subscription"===(e.detail||{}).name&&s()}))},s=function(){e._protected.RunModes.Behaviors.AccessToken&&e._protected.Integration.isOnRightDomain()&&c()},c=function(){var e=function(){var e=i();return(n.supportLevels||{})[e]||r.supportLevels[e]}(),t=i(),o=[];e.accessToken||o.push("config_"+t+"_accessToken"),p(o)},p=function(t){var n;for(n=0;n<t.length;++n)o.indexOf(t[n])>=0||e._protected.Blocker.category("accessToken").add(t[n]);for(n=0;n<o.length;++n)t.indexOf(o[n])>=0||e._protected.Blocker.category("accessToken").remove(o[n]);o=t.slice()};e._protected.Config.getPluginsRegistry=function(){return n&&n.pluginsRegistry||{}},e._protected.Config.getInAppConfig=function(){return e._protected.Config.getModuleInitializationPromise().then(()=>e._protected.Config.remoteConfigManager.read()).then(e=>e&&e.data&&e.data.inAppConfig||{campaigns:[]})},t()}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o,r;o=[n(19),n(20)],void 0===(r=function(e,t){return function(e){var t,n=new e._protected.Promise.Deferred;return e._protected.Session=new function(){t=function(){e.preInstantiationPromise.then((function(){e._protected.Blocker.category("accessToken").add("currentSession"),Promise.all([e._protected.Options.getModuleInitializationPromise(),e._protected.Storage.getModuleInitializationPromise()]).then((function(){n.resolve(),e._protected.Blocker.category("accessToken").remove("currentSession")}))}))},this.getModuleInitializationPromise=function(){return n.promise},this.listUsedUserIds=function(){return e._protected.Storage.get("sessions",{}).then((function(e){return Object.keys(e).map((function(e){return""===e?null:e}))}))},this.getSession=function(t){return t||(t=""),e._protected.Storage.get("sessions",{}).then((function(e){return e[t]?e[t]:{}}))},this.getCurrentSession=function(){return e._protected.Session.getSession(e._protected.Options.getUserId()).then((function(e){return e}))},this.deleteSession=function(t){return t||(t=""),e._protected.Storage.get("sessions",{}).then((function(n){return delete n[t],e._protected.Storage.set("sessions",n)}))},this.setSession=function(t){return e._protected.Storage.get("sessions",{}).then((function(n){return n[t.userId||""]=t,e._protected.Storage.set("sessions",n)}))},this.reset=function(){return e._protected.Storage.rm("sessions")},this.serialize=function(){return e._protected.Storage.get("sessions",{}).then((function(e){return JSON.stringify(e)}))},this.deserialize=function(t){var n=JSON.parse(t||"{}");e._protected.Storage.set("sessions",n)}},t(),n.promise}}.apply(t,o))||(e.exports=r)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t=function(t,n,o){return n=n||{},(o?Promise.resolve(o):e._protected.Session.getSession(t)).then((function(t){n.sdkVersion="Web-"+e.this.Constants.SDK_VERSION;var o=t.lang||e._protected.gscope.navigator.language;return n.lang=e._protected.Helper.inArray(o,e._protected.Constants.VALID_LANGUAGE_CODES)?o:e._protected.Constants.DEFAULT_LANGUAGE_CODE,t.accessToken&&(n.accessToken=t.accessToken),t.userId&&(n.userId=t.userId),n}))},n=function(t){return t&&(t.startsWith("https://")||t.startsWith("http://"))?t:(t&&t.length>0&&"/"!==t.charAt(0)&&(t="/"+t),e._protected.Options.getApiUrlPrefix()+t)},o=function(e){var t=[];for(var n in e)t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")};e.prototype.Rest=new function(){this.get=function(t,n,o,r){return e._protected.Rest.get(e._protected.Options.getUserId(),t,n,o,r)},this.post=function(t,n,o,r,i){return e._protected.Rest.post(e._protected.Options.getUserId(),t,n,o,r,i)},this.postEventually=function(t,n,o){return e._protected.Rest.postEventually(e._protected.Options.getUserId(),t,n,o)},this.postBeacon=function(r,i,a){return e.prototype.getInitializationPromise().then((function(){return t(e._protected.Options.getUserId(),i,a).then((function(e){var t=n(r),i=o(e);return navigator.sendBeacon(t,new Blob([i],{type:"application/x-www-form-urlencoded"}))}))}))},this.delete=function(t,n,o,r){return e._protected.Rest.delete(e._protected.Options.getUserId(),t,n,o,r)},this.fetch=function(e,t,n,o){return"GET"===e?this.get(t,n,void 0,{fetch:!0}):"POST"===e?this.post(t,n,o,void 0,{fetch:!0}):"PUT"===e?this.put(t,n,o,void 0,{fetch:!0}):"PATCH"===e?this.patch(t,n,o,void 0,{fetch:!0}):"DELETE"===e?this.delete(t,n,void 0,{fetch:!0}):Promise.reject("Unsupported method "+e+" for fetch")},this.put=function(t,n,o,r,i){return e._protected.Rest.put(e._protected.Options.getUserId(),t,n,r,i)},this.patch=function(t,n,o,r,i){return e._protected.Rest.patch(e._protected.Options.getUserId(),t,n,r,i)}},e._protected.Rest=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Rest",new function(){this.destroy=function(){},this.get=function(r,i,a,s,c){return t(r,a).then((function(t){var r=n(i),a=o(t);return a&&(r=r+"?"+a),e._protected.Request.request("GET",r,"",void 0,{},s,c)}))},this.post=function(r,i,a,s,c,p){return t(r,a).then((function(t){var r=n(i),a=o(t);return e._protected.Request.request("POST",r,a,s,{"Content-type":"application/x-www-form-urlencoded"},c,p)}))},this.postEventually=function(r,i,a,s){return e.prototype.getInitializationPromise().then((function(){return t(r,a).then((function(t){if(t.accessToken){var r=n(i),a=o(t);return e._protected.Request.requestEventually("POST",r,a,s,{"Content-type":"application/x-www-form-urlencoded"})}e._protected.Helper.error("[rest        ]","We have no accessToken! Cannot call WonderPush API.")}))}))},this.delete=function(r,i,a,s,c){return t(r,a).then((function(t){var r=n(i),a=o(t);return a&&(r=r+"?"+a),e._protected.Request.request("DELETE",r,"",void 0,{},s,c)}))},this.fetch=function(e,t,n,o,r){return"GET"===t?this.get(e,n,o,void 0,{fetch:!0}):"POST"===t?this.post(e,n,o,r,void 0,{fetch:!0}):"PUT"===t?this.put(e,n,o,r,void 0,{fetch:!0}):"PATCH"===t?this.patch(e,n,o,r,void 0,{fetch:!0}):"DELETE"===t?this.delete(e,n,o,void 0,{fetch:!0}):Promise.reject("Unsupported method "+t+" for fetch")},this.fetchJson=function(e,t,n,o,r){return this.fetch(e,t,n,o,r).then((function(e){return e.json()}))},this.put=function(r,i,a,s,c,p){return t(r,a).then((function(t){var r=n(i),a=o(t);return e._protected.Request.request("PUT",r,a,s,{"Content-type":"application/x-www-form-urlencoded"},c,p)}))},this.patch=function(r,i,a,s,c,p){return t(r,a).then((function(t){var r=n(i),a=o(t);return e._protected.Request.request("PATCH",r,a,s,{"Content-type":"application/x-www-form-urlencoded"},c,p)}))}})}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){const{EventAttributionManager:t,ReportingDataUtil:o}=n(5);var r;e.prototype.subscribeToNotifications=function(t){return e._protected.Notification.setNotificationEnabled(!0,t)},e.prototype.isSubscribedToNotifications=function(){return Promise.resolve(e.prototype.getNotificationEnabled())},e.prototype.unsubscribeFromNotifications=function(){return e._protected.Notification.setNotificationEnabled(!1)},e.prototype.isAllowedSubscriptionDomain=function(t){return Promise.resolve(e._protected.Notification.isAllowedSubscriptionDomain(t))},e.prototype.trackEvent=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.trackEvent",(function(t,n){return"string"!=typeof t||""===t||"@"===t.charAt(0)?Promise.reject(new e.prototype.Errors.InvalidArgumentError("Bad event type")):(e._protected.Events.sendEvent(t,null,n),Promise.resolve())})),e.prototype.getProperties=function(){return e._protected.Installation.getProperties()},e.prototype.putProperties=function(t){return e._protected.Installation.putProperties(t)},e.prototype.setProperty=function(t,n){return e._protected.Installation.setProperty(t,n)},e.prototype.unsetProperty=function(t){return e._protected.Installation.unsetProperty(t)},e.prototype.addProperty=function(t,n){return e._protected.Installation.addProperty.apply(null,arguments)},e.prototype.removeProperty=function(t,n){return e._protected.Installation.removeProperty.apply(null,arguments)},e.prototype.getPropertyValue=function(t){return e._protected.Installation.getPropertyValue(t)},e.prototype.getPropertyValues=function(t){return e._protected.Installation.getPropertyValues(t)},e.prototype.addTag=function(t){return e._protected.Installation.addTag.apply(null,Array.from(arguments))},e.prototype.removeTag=function(t){return e._protected.Installation.removeTag.apply(null,Array.from(arguments))},e.prototype.removeAllTags=function(){return e._protected.Installation.removeAllTags()},e.prototype.getTags=function(){return e._protected.Installation.getTags()},e.prototype.hasTag=function(t){return e._protected.Installation.hasTag(t)},e.prototype.useGeolocation=function(t){return e.prototype.Geo.useGeolocation(t)},e.prototype.showSubscriptionDialog=function(){const t=e.prototype.Plugins.get("optin-dialog");return t?(t.showDialog(),Promise.resolve()):Promise.resolve()},e.prototype.showSubscriptionBell=function(t){const n=e.prototype.Plugins.get("optin-bell");return n?(t?n.showBell():n.hideBell(),Promise.resolve()):Promise.resolve()},e.prototype.showSubscriptionSwitch=function(t,n){const o=e._protected.Options.getPlugins(),r=e.prototype.Plugins.get("optin-switch"),{document:i}=e._protected.gscope;if(!t||!r||!i)return Promise.resolve();const a=i.createElement("div");a.id=o["optin-switch"]&&o["optin-switch"].switchElementId||"wonderpush-subscription-switch";for(const e in n)a.setAttribute("data-"+e,n[e]);return t.appendChild(a),r.setupSubscriptionSwitch(),Promise.resolve()},e.prototype.showTagSwitches=function(t,n){const o=e._protected.Options.getPlugins(),r=e.prototype.Plugins.get("tag-switch"),{document:i}=e._protected.gscope;return t&&r&&i?Array.isArray(n)?(n.forEach(e=>{const n=i.createElement("div");n.classList.add(o["tag-switch"]&&o["tag-switch"].switchElementClass||"wonderpush-tag-switch");for(const t in e)n.dataset[t]=e[t];t.appendChild(n)}),r.setupTagSwitch(),Promise.resolve()):(console.warn("WonderPush.showTagSwitches() expects an array as second argument"),Promise.resolve()):Promise.resolve()},e.prototype.showTagSwitch=e.prototype.showTagSwitches,e.prototype.setInAppMessagingDisplayCallback=function(t){e._protected.InAppMessaging.setDisplayCallback(t)},e.prototype.getDisplayedInAppMessage=function(){return e._protected.InAppMessaging.getDisplayedInAppMessage()},e.prototype.getUserConsent=function(){return e._protected.Consent.getUserConsent()},e.prototype.setUserConsent=function(t){return e._protected.Consent.setUserConsent(t)},e.prototype.clearAllData=function(){return e.prototype.Data.clearAll()},e.prototype.clearEventsHistory=function(){return e.prototype.Data.clearEventsHistory()},e.prototype.clearPreferences=function(){return e.prototype.Data.clearPreferences()},e.prototype.downloadAllData=function(){return e.prototype.Data.downloadExport()},e.prototype.addPageView=function(){return e.prototype.newPageLoaded(),Promise.resolve()},e.prototype.getSessionState=function(){return e._protected.Init.getSessionState()},e.prototype.getNotificationIcon=function(){return e._protected.Options.getNotificationIcon()},e.prototype.isNativePushNotificationSupported=function(){return e._protected.Notification.isNativePushNotificationSupported()},e.prototype.askNativePushNotificationPermission=function(){e.prototype.setNotificationEnabled(!0).catch((function(e){console.warn(e)}))},e.prototype.unsubscribeFromPushNotification=function(){return e.prototype.setNotificationEnabled(!1)},e.prototype.isRegistrationInProgress=function(){return e._protected.Notification.isRegistrationInProgress()},e.prototype.setNotificationEnabled=function(t,n){return e._protected.Notification.setNotificationEnabled(t,n)},e.prototype.getNotificationEnabled=function(){return e.prototype.Notification.getSubscriptionState()===e.prototype.SubscriptionState.SUBSCRIBED},e.prototype.isOnRightDomain=function(){return e._protected.Integration.isOnRightDomain()},e.preInstantiationPromise.then((function(){return e.prototype.getInitializationPromise()})).then((function(){return e._protected.Integration.callOnCustomDomain("WonderPushSDK._protected.Session.getCurrentSession")})).then((function(e){r=e})),e.prototype.trackEventOnUnload=function(t,n){return"string"!=typeof t||""===t||"@"===t.charAt(0)?Promise.reject(new e.prototype.Errors.InvalidArgumentError("Bad event type")):e._protected.Events.sendEvent(t,null,n,r,{useBeacon:!0})},e._protected.trackEventWithInternalData=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.trackEventWithInternalData",(function(t,n,o){if("string"!=typeof t||""===t||"@"===t.charAt(0))throw new e.prototype.Errors.InvalidArgumentError("Bad event type");e._protected.Events.sendEvent(t,n,o)})),e._protected.trackInternalEvent=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.trackInternalEvent",(function(t,n,o){if("@"!==t.charAt(0))throw new e.prototype.Errors.InvalidArgumentError("This method must only be called for internal events, starting with an '@'");e._protected.Events.sendEvent(t,n,o)})),e._protected.trackInternalEventWithMeasurementsApi=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.trackInternalEventWithMeasurementsApi",(function(t,n,o){if("@"!==t.charAt(0))throw new e.prototype.Errors.InvalidArgumentError("This method must only be called for internal events, starting with an '@'");e._protected.Events.sendEvent(t,n,o,void 0,{useMeasurementsApi:!0,postImmediately:!0})})),e._protected.trackInternalEventWithAppropriateApi=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.trackInternalEventWithAppropriateApi",(function(t,n,o,r){const i=e._protected.Options.getUserId();return Promise.all([e._protected.Session.getSession(i),r&&r.overrideNotificationReceiptOnly?e._protected.Storage.get("_overrideNotificationReceipt",!1):Promise.resolve(!0)]).then(([r,i])=>r&&r.accessToken&&i?e._protected.trackInternalEvent(t,n,o):e._protected.trackInternalEventWithMeasurementsApi(t,n,o))})),e.prototype.getUserId=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.getUserId",(function(){return e._protected.Session.getCurrentSession().then((function(e){return e.userId}))})),e.prototype.getInstallationId=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.getInstallationId",(function(){return e._protected.Session.getCurrentSession().then((function(e){return e.installationId}))})),e.prototype.getPushToken=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.getPushToken",(function(){return e._protected.Installation.getCachedInstallationPushToken()})),e.prototype.getDeviceId=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.getDeviceId",(function(){return e._protected.Init.getDeviceId()})),e.prototype.getInstallation=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.getInstallation",(function(){return e._protected.Helper.warn("WonderPush","WonderPushSDK.getInstallation() is deprecated. Please use WonderPushSDK.getInstallationCustomProperties()."),Promise.all([e._protected.Session.getCurrentSession(),e._protected.JsonSyncInstallationCustom.getInstallationCustomPropertiesForUser(e._protected.Options.getUserId()),e._protected.Init.getDeviceId(),e._protected.Installation.getCachedInstallationPushToken()]).then((function(e){var t=e[0],n=e[1],o=e[2],r=e[3];return{id:t.installationId,userId:t.userId,device:{id:o},pushToken:{data:r},custom:n}}))})),e.prototype.getInstallationCustomProperties=function(){return e._protected.Installation.getProperties()},e.prototype.putInstallationCustomProperties=function(t){return e._protected.Installation.putProperties(t)},e.prototype.getAttendance=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.getAttendance",(function(){return e._protected.Storage.bulk([{get:{key:"visitPageViews",defaultValue:1}},{get:{key:"pageViews",defaultValue:1}},{get:{key:"visitCount",defaultValue:1}}]).then((function(e){return{visitPageViews:e.results.byKey.visitPageViews,pageViews:e.results.byKey.pageViews,visitCount:e.results.byKey.visitCount}}))})),e._protected.onInteraction=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.onInteraction",(function(n){const r=new t(e._protected.Storage);return e._protected.Storage.bulk([{get:{key:"lastInteractionDate",defaultValue:0}},{get:{key:"lastAppOpenDate",defaultValue:0}},{get:{key:"lastAppOpenInfoJson",defaultValue:{}}},{get:{key:"lastAppCloseDate",defaultValue:0}},{get:{key:"lastReceivedNotificationInfoJson",defaultValue:{}}},{get:{key:"lastOpenedNotificationInfoJson",defaultValue:{}}}]).then((function(t){var a=[],s=t.results.byKey,c=s.lastInteractionDate,p=s.lastAppOpenDate,u=s.lastAppOpenInfoJson,d=s.lastAppCloseDate,l=s.lastReceivedNotificationInfoJson.actionDate||Number.MAX_SAFE_INTEGER,f=s.lastOpenedNotificationInfoJson,g=f.actionDate||Number.MAX_SAFE_INTEGER,h=e._protected.Time.getRealTime(),m=h-c>=e._protected.Constants.DIFFERENT_SESSION_REGULAR_MIN_TIME_GAP||l>c&&h-c>=e._protected.Constants.DIFFERENT_SESSION_NOTIFICATION_MIN_TIME_GAP;if(n)m||a.push(e._protected.Storage.set("lastInteractionDate",h));else{if(m){if(d<p){var v=e._protected.Helper.plainObjectCopy(u),_=c;v.actionDate=_,v.openedTime=_-p,a.push(e._protected.Storage.set("lastAppCloseDate",_))}var y={};y.actionDate=h,l<=h&&(y.lastReceivedNotificationTime=h-l),h-g<6e4&&(o.assignEventData(y,o.extract(f)),a.push(e._protected.Storage.rm("lastOpenedNotificationInfoJson"))),a.push(i()),a.push(e._protected.Storage.set("lastAppOpenDate",h)),a.push(e._protected.Storage.set("lastAppOpenInfoJson",y))}else r.renewCurrentAttribution(e._protected.Constants.DIFFERENT_SESSION_REGULAR_MIN_TIME_GAP);a.push(e._protected.Storage.set("lastInteractionDate",h))}return e._protected.ensureAppOpenSent(),Promise.all(a).then((function(){}))}))})),e._protected.reportBeforeUnload=e._protected.Integration.proxifyToServiceWorker("WonderPushSDK._protected.reportBeforeUnload",(function(){const t=new e._protected.Promise.Deferred;return setTimeout(()=>{self.clients.matchAll({includeUncontrolled:!0,type:"window"}).then(n=>{n.length||e._protected.extendPresence(0,{force:!0}),t.resolve()})},5e3),t.promise})),e._protected.getLastPresenceInfo=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.getLastPresenceInfo",(function(){return e._protected.Storage.get("lastPresenceInfo",void 0)})),e._protected.extendPresence=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.extendPresence",(function(t,n={}){return self.isSecureContext?e._protected.Storage.bulk([{test:{key:"lastPresenceInfo",defaultValue:{},operationsCb:function(o){const r=new Date,i=o.untilDate?o.untilDate-r.getTime():0;if(!n.force&&i>e._protected.Constants.PRESENCE_UPDATE_SAFETY_MARGIN){const o=i-e._protected.Constants.PRESENCE_UPDATE_SAFETY_MARGIN;return void setTimeout(()=>e._protected.extendPresence(t,n),o)}let a;a=i<0?r:o.fromDate?new Date(o.fromDate):r;const s=new Date(r.getTime()+t),c={fromDate:a.getTime(),untilDate:s.getTime(),elapsedTime:s.getTime()-a.getTime()};if(n&&n.skipEvent||e._protected.trackInternalEvent("@PRESENCE",{presence:c}),n.autoRenew){const o=t-e._protected.Constants.PRESENCE_UPDATE_SAFETY_MARGIN;setTimeout(()=>e._protected.extendPresence(t,n),o)}return[{put:{key:"lastPresenceInfo",value:c}}]}}}]):Promise.resolve()})),e._protected.ensureAppOpenSent=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.ensureAppOpenSent",(function(){const t=(t,n,o)=>e._protected.Storage.bulk([{test:{key:"lastAppOpenDate",defaultValue:0,operationsCb:function(r){return[{test:{key:n,defaultValue:0,operationsCb:function(i){if(i<r)return[{test:{key:"lastAppOpenInfoJson",operationsCb:function(i){const a=new Date,s=e._protected.Constants.PRESENCE_ANTICIPATED_TIME_MS,c=self.isSecureContext?{fromDate:a.getTime(),elapsedTime:s,untilDate:new Date(a.getTime()+s).getTime()}:{},p=Object.assign({},i,{presence:c});o?e._protected.trackInternalEventWithMeasurementsApi(t,p):e._protected.trackInternalEvent(t,p);const u=[{put:{key:n,value:r}}];return self.isSecureContext&&u.push({put:{key:"lastPresenceInfo",value:c}}),u}}}]}}}]}}}]),n={autoRenew:!0,skipEvent:!0};return e._protected.extendPresence(e._protected.Constants.PRESENCE_ANTICIPATED_TIME_MS,n),t("@VISIT","lastVisitSentDate",!0),e.prototype.getInitializationPromise().then((function(){return n.skipEvent=!1,t("@APP_OPEN","lastAppOpenSentDate")})).catch((function(e){})).then((function(){}))})),e.prototype.newPageLoaded=function(){e._protected.newPageLoadedProxifiedIncrements().then(()=>(e._protected.Events.fire(new e._protected.Events.NewPageView),e._protected.Plugins.runRegisteredTriggersCheck()))},e._protected.newPageLoadedProxifiedIncrements=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.newPageLoadedProxifiedIncrements",(function(){Promise.all([e._protected.onInteraction(!1),e._protected.Integration.incrementPageViews(),e._protected.incrementVisitPageViews()])})),e.prototype.newUserInteraction=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.newUserInteraction",(function(){e._protected.onInteraction(!1).then(()=>e._protected.Plugins.runRegisteredTriggersCheck())}));var i=function(){return e._protected.Storage.getModuleInitializationPromise().then((function(){return e._protected.Storage.bulk([{test:{key:"visitCount",defaultValue:0,operationsCb:function(e){return{put:{key:"visitCount",value:++e}}}}},{put:{key:"visitPageViews",value:1}}])}))};return e._protected.incrementVisitPageViews=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.incrementVisitPageViews",(function(){return e._protected.Storage.getModuleInitializationPromise().then((function(){return e._protected.Storage.bulk([{test:{key:"visitPageViews",defaultValue:0,operationsCb:function(e){return{put:{key:"visitPageViews",value:++e}}}}}])}))})),e.instantiationPromise.then(()=>e._protected.Events.fire(new e._protected.Events.NewPageView)),e._protected.Config.getModuleInitializationPromise().then((function(){if((e._protected.RunModes.Behaviors.ModeFrame||e._protected.RunModes.Behaviors.ModeWebSite&&e._protected.Integration.isOnRightDomain())&&window.isSecureContext&&window.addEventListener("beforeunload",()=>e._protected.reportBeforeUnload()),e._protected.RunModes.Behaviors.ModeWebSite){var t=function(){e._protected.onInteraction(!0)};return window.addEventListener("hashchange",(function(){e._protected.onInteraction(!1)})),window.addEventListener("beforeunload",t),window.addEventListener("unload",t),e._protected.incrementVisitPageViews().catch((function(){})).then((function(){return e._protected.onInteraction(!1)}))}}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t=null,n=null,o=null;e.prototype.Geo={},e.prototype.Geo.useGeolocation=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.Geo.useGeolocation",(function(n){e._protected.Constants.GEOLOCATION_SUPPORTED&&r().then((function(o){"auto"===n&&(n="granted"===o),n?t||(t=navigator.geolocation.watchPosition(a,s,e._protected.Constants.GEOLOCATION_OPTIONS),navigator.geolocation.getCurrentPosition(a,s,e._protected.Constants.GEOLOCATION_OPTIONS_FIRST_FIX)):t&&(navigator.geolocation.clearWatch(t),t=void 0)}))})),e.prototype.Geo.fake=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.Geo.fake",(function(e){e?"lat"in e&&"lon"in e&&(o={lat:e.lat,lon:e.lon}):o=null})),e._protected.Geo={},e._protected.Geo.getGeolocation=function(){return o?{lat:o.lat,lon:o.lon}:!n||new Date-n.timestamp>e._protected.Constants.GEOLOCATION_MAXIMUM_AGE?null:{lat:n.coords.latitude,lon:n.coords.longitude}};var r=function(){return e._protected.Storage.get("geolocationPermission","prompt")},i=function(t){return e._protected.Storage.set("geolocationPermission",t)},a=function(t){i("granted"),!t||new Date-t.timestamp>e._protected.Constants.GEOLOCATION_MAXIMUM_AGE||(!n||t.timestamp>n.timestamp)&&(n=t)},s=function(t){t.code===t.PERMISSION_DENIED&&(i("denied"),e.prototype.Geo.useGeolocation(!1))};e._protected.RunModes.Behaviors.GeolocationPermission&&e._protected.Config.getModuleInitializationPromise().then((function(){var t=function(){e._protected.Consent.hasUserConsent().then(t=>{t?e.prototype.Geo.useGeolocation(e._protected.Options.getGeolocation()):(e.prototype.Geo.useGeolocation(!1),n=null)})};e._protected.Integration.addBroadcastListener(e._protected.Constants.BROADCAST_TYPE_SET_USER_CONSENT,()=>{t()}),t()}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o,r;o=[n(76)],void 0===(r=function(e){return function(t){t._protected.Installation={},t._protected.Installation.updateInstallationCoreProperties=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.updateInstallationCoreProperties",(function(){return t.prototype.getInitializationPromise().then((function(){return t._protected.Session.getCurrentSession().then((function(e){return t._protected.Installation.Profile.getCoreProperties().then((function(n){if(n)return t._protected.Storage.bulk([{test:{key:"installationCoreProperties",defaultValue:null,operationsCb:function(o){if(t._protected.RunModes.Behaviors.ContextServiceWorker&&null===o)return;o=o||{date:0,json:"{}"};var r=JSON.parse(o.json),i={};t._protected.RunModes.Behaviors.ContextServiceWorker&&t._protected.Helper.mergeObjectInplaceRecursive(i,r);const a=(n.application||{}).integrator;return t._protected.Helper.stripObject(n),t._protected.Helper.mergeObjectInplaceRecursive(i,n),t._protected.Helper.stripObject(i),void 0!==a&&(i.application||(i.application={}),i.application.integrator=a),t._protected.JsonUtil.equal(i,r)&&o.userId===e.userId&&o.installationId===e.installationId&&+new Date<o.date+t._protected.Constants.INSTALLATION_CORE_PROPERTIES_CACHE?void 0:(t.this.Rest.postEventually("/installation",{body:JSON.stringify(i),overwrite:"false"}),{put:{key:"installationCoreProperties",value:{json:JSON.stringify(i),installationId:e.installationId,userId:e.userId,date:+new Date}}})}}}])}))}))}))})),t._protected.Installation.getInstallationFromServer=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.getInstallationFromServer",(function(){return t.this.getInitializationPromise().then((function(){var e=new t._protected.Promise.Deferred,n=function(){e.reject()},o={onload:function(t){e.resolve(t&&t.json&&t.json()||this.responseJSON)},onerror:n,ontimeout:n,onabort:n};return t.this.Rest.get("/installation",{},o,{}),e.promise}))})),t._protected.Installation.addInstallationPushToken=function(e,n){e=t._protected.Helper.plainObjectCopy(e),t._protected.Notification.getManuallyUnsubscribed().then((function(n){n||(e?t._protected.Notification.setSubscriptionState(t.prototype.SubscriptionState.SUBSCRIBED):t._protected.Notification.setSubscriptionState(t.prototype.SubscriptionState.NOT_SUBSCRIBED))}));var o=!0,r=t._protected.Integration.getCurrentOperatingOrigin(),i=null,a=null,s=null,c=null,p=null,u=null;let d;return e?(i=e.subscriptionId&&-1===e.endpoint.indexOf(e.subscriptionId)?e.endpoint+"/"+e.subscriptionId:e.endpoint,a=e.expirationTime,"object"==typeof e.keys&&(s=e.keys.p256dh,c=e.keys.auth),"object"==typeof e.options&&(p=e.options.applicationServerKey,u=e.options.userVisibleOnly)):o=t._protected.Blocker.category("accessToken").unblocked(),(o?t.prototype.getInitializationPromise():Promise.resolve()).then((function(){return t._protected.Session.getCurrentSession().then((function(e){return t._protected.Storage.bulk([{test:{key:"pushTokenCache",defaultValue:{pushTokenOrigin:null,pushTokenData:null,pushTokenExpirationDate:null,pushTokenP256dh:null,pushTokenAuth:null,pushTokenApplicationServerKey:null,pushTokenUserVisibleOnly:null,userId:e.userId,installationId:e.installationId,date:+new Date},operationsCb:function(l){if(16002288e5<=l.date&&l.date<=16002684e5&&(n=!0),n||l.pushTokenOrigin!==r||l.pushTokenData!==i||l.pushTokenExpirationDate!==a||l.pushTokenP256dh!==s||l.pushTokenAuth!==c||l.pushTokenApplicationServerKey!==p||l.pushTokenUserVisibleOnly!==u||l.userId!==e.userId||l.installationId!==e.installationId||!(+new Date<l.date+t._protected.Constants.INSTALLATION_PUSH_TOKEN_CACHE))return o&&(d=t.this.Rest.postEventually("/installation",{overwrite:"false",body:JSON.stringify({pushToken:{origin:r,data:i,expirationDate:a,p256dh:s,auth:c,applicationServerKey:p,userVisibleOnly:u}})},void 0)),{put:{key:"pushTokenCache",value:{pushTokenOrigin:r,pushTokenData:i,pushTokenExpirationDate:a,pushTokenP256dh:s,pushTokenAuth:c,pushTokenApplicationServerKey:p,pushTokenUserVisibleOnly:u,userId:e.userId,installationId:e.installationId,date:+new Date}}}}}}])}))})).then(()=>Promise.resolve(d))},t._protected.Installation.getCachedInstallationPushToken=function(){return t._protected.Storage.get("pushTokenCache",{pushTokenData:null}).then((function(e){return e.pushTokenData}))},t._protected.Installation.removeInstallationPushToken=function(){t._protected.Installation.addInstallationPushToken(null)},t._protected.Installation.getProperties=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.getProperties",(function(){return t._protected.JsonSyncInstallationCustom.getInstallationCustomPropertiesForUser(t._protected.Options.getUserId()).then(e=>(Object.keys(e).forEach(t=>{("string"!=typeof t||t.indexOf("_")<0)&&delete e[t]}),e))})),t._protected.Installation.putProperties=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.putProperties",(function(e){return e?e instanceof Object?(e=t._protected.Helper.plainObjectCopy(e),Object.keys(e).forEach(n=>{("string"!=typeof n||n.indexOf("_")<0)&&(t._protected.Helper.warn("[installation]","Dropping installation property with no prefix:",n,"=",e[n]),delete e[n])}),t._protected.JsonSyncInstallationCustom.putInstallationCustomPropertiesForUser(t._protected.Options.getUserId(),e)):(console.error("WonderPushSDK.putProperties() expects an object as argument, got ",e),Promise.reject(new t.prototype.Errors.InvalidArgumentError("WonderPushSDK.putProperties() expects an object as argument"))):Promise.resolve()})),t._protected.Installation.setProperty=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.setProperty",(function(e,n){return e?t._protected.Installation.putProperties({[e]:n}):Promise.resolve()})),t._protected.Installation.unsetProperty=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.unsetProperty",(function(e){return e?t._protected.Installation.putProperties({[e]:null}):Promise.resolve()})),t._protected.Installation.addProperty=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.addProperty",(function(e,n){if(!e||null==n)return Promise.resolve();const o=Array.isArray(n)?n:Array.from(arguments).slice(1);return t._protected.Installation.getPropertyValues(e).then(n=>(o.forEach(e=>{null!=e&&n.indexOf(e)<0&&n.push(e)}),t._protected.Installation.putProperties({[e]:n})))})),t._protected.Installation.removeProperty=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.removeProperty",(function(e,n){if(!e||null==n)return Promise.resolve();const o=Array.isArray(n)?n:Array.from(arguments).slice(1);return t._protected.Installation.getPropertyValues(e).then(n=>(o.forEach(e=>{const t=n.indexOf(e);t>=0&&n.splice(t,1)}),t._protected.Installation.putProperties({[e]:n})))})),t._protected.Installation.getPropertyValue=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.getPropertyValue",(function(e){return e?t._protected.Installation.getProperties().then(t=>{let n=t[e];return Array.isArray(n)&&(n=n[0]),null!=n||(n=null),n}):Promise.resolve(null)})),t._protected.Installation.getPropertyValues=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.getPropertyValues",(function(e){return e?t._protected.Installation.getProperties().then(t=>{let n=t[e];return null!=n||(n=[]),Array.isArray(n)||(n=[n]),n}):Promise.resolve(null)})),t._protected.Installation.addTag=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.addTag",(function(e){const n=(Array.isArray(e)?e:Array.from(arguments)).filter(e=>"string"==typeof e);return t._protected.Installation.getTags().then(e=>{const o=Array.from(new Set(e.concat(n)));return o.sort(),t._protected.JsonSyncInstallationCustom.putInstallationCustomPropertiesForUser(t._protected.Options.getUserId(),{tags:o}).then(()=>{})})})),t._protected.Installation.removeTag=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.removeTag",(function(e){const n=new Set(Array.isArray(e)?e:Array.from(arguments));return t._protected.Installation.getTags().then(e=>{const o=e.filter(e=>!n.has(e));return t._protected.JsonSyncInstallationCustom.putInstallationCustomPropertiesForUser(t._protected.Options.getUserId(),{tags:o}).then(()=>{})})})),t._protected.Installation.removeAllTags=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.removeAllTags",(function(){return t._protected.JsonSyncInstallationCustom.putInstallationCustomPropertiesForUser(t._protected.Options.getUserId(),{tags:null}).then(()=>{})})),t._protected.Installation.getTags=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.getTags",(function(){return t._protected.JsonSyncInstallationCustom.getInstallationCustomPropertiesForUser(t._protected.Options.getUserId()).then(e=>{let t=(e||{}).tags;return Array.isArray(t)||(t=[]),t.sort(),t})})),t._protected.Installation.hasTag=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Installation.hasTag",(function(e){return t._protected.Installation.getTags().then(t=>t.indexOf(e)>=0)})),e(t)}}.apply(t,o))||(e.exports=r)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Installation.Profile={},e._protected.Installation.Profile.getCoreProperties=function(t){return Promise.all([t?void 0:e._protected.Init.getFederatedDeviceId(),new Promise((function(t){return e._protected.RunModes.Behaviors.ModeWebSite?t(e._protected.Helper.getLocales()):e._protected.RunModes.Behaviors.ModeFrame?t(e._protected.Promise.timeout(e._protected.Integration.callOnParentWindow("WonderPushSDK._protected.Helper.getLocales",[]),100,e._protected.Helper.getLocales(),!0)):t([])})).then((function(e){return e[0]})),e._protected.Notification.getManuallyUnsubscribed(),e._protected.Notification.getTrustedOrCachedNotificationPermissionState()]).then((function(t){var n=t[0],o=t[1];const r=t[2],i=t[3];n&&(n="0:"+n);let a=void 0;const s={};return i!==e._protected.Notification.PERMISSION_UNKNOWN&&(a=i===e._protected.Notification.PERMISSION_GRANTED,s.osNotificationsVisible=a),s.subscriptionStatus=r||!1===a?"optOut":"optIn",s.subscribedToNotifications=!r,{application:{version:e._protected.Options.getApplicationVersion(),integrator:e._protected.Options.getIntegrator()||null,sdkVersion:e.this.Constants.SDK_VERSION,domain:function(){if(!e._protected.RunModes.Behaviors.ContextServiceWorker&&!e._protected.RunModes.Behaviors.ModeSlave){if(e._protected.RunModes.Behaviors.ContextFrame||e._protected.RunModes.Behaviors.ModePopup)try{return new URL(document.referrer).hostname}catch(e){}return location.hostname}}()},preferences:s,device:{federatedId:n,osVersion:e._protected.Helper.detectBrowser().version||null,brand:e._protected.Helper.detectBrowser().name||null,model:navigator.userAgent,screenWidth:"undefined"!=typeof screen&&screen.width||void 0,screenHeight:"undefined"!=typeof screen&&screen.height||void 0,configuration:{timeZone:function(){var e;if(!e&&Intl){var t=Intl.DateTimeFormat();t&&t.resolvedOptions&&(e=t.resolvedOptions().timeZone)}if(!e){var n={GMT:"GMT",EAT:"Africa/Addis_Ababa",CET:"Africa/Algiers",WAT:"Africa/Kinshasa",CAT:"Africa/Lubumbashi","CEST CET":"Europe/Berlin",SAST:"Africa/Johannesburg",EET:"Africa/Tripoli","HADT HAST":"America/Adak","AKDT AKST":"America/Anchorage",BRT:"America/Bahia",ART:"America/Buenos_Aires",EST:"America/Panama",AMT:"America/Manaus","AMST AMT":"America/Campo_Grande",MST:"America/Phoenix","PDT PST":"America/Los_Angeles","EDT EST":"America/New_York",ACT:"America/Rio_Branco","ADT AST":"America/Halifax",PST:"America/Metlakatla",FNT:"America/Noronha","CLST CLT":"America/Santiago","BRST BRT":"America/Sao_Paulo","NDT NST":"America/St_Johns",AWST:"Australia/West","NZDT NZST":"Pacific/Auckland",AQTT:"Asia/Aqtobe",TMT:"Asia/Ashgabat",ICT:"Asia/Bangkok",IST:"Asia/Kolkata",BDT:"Asia/Dhaka",GST:"Asia/Dubai",HKT:"Asia/Hong_Kong",WIB:"Asia/Jakarta","IDT IST":"Asia/Jerusalem",XJT:"Asia/Urumqi",NPT:"Asia/Katmandu",YAKT:"Asia/Yakutsk",MYT:"Asia/Kuala_Lumpur",WITA:"Asia/Makassar",KST:"Asia/Seoul",UZT:"Asia/Tashkent",SGT:"Asia/Singapore","IRDT IRST":"Asia/Tehran",BTT:"Asia/Thimphu",JST:"Asia/Tokyo",ULAT:"Asia/Ulaanbaatar",VLAT:"Asia/Vladivostok","AEDT AEST":"Australia/Victoria","ACDT ACST":"Australia/South",AEST:"Australia/Queensland",ACST:"Australia/North","LHDT LHST":"Australia/Lord_Howe","EASST EAST":"Pacific/Easter","GMT IST":"Europe/Dublin",UCT:"Etc/UCT",UTC:"UTC","BST GMT":"Europe/London",MSK:"Europe/Moscow",HST:"Pacific/Honolulu",MHT:"Pacific/Majuro","CHADT CHAST":"Pacific/Chatham",CHUT:"Pacific/Chuuk",ChST:"Pacific/Guam",SST:"Pacific/Samoa",PONT:"Pacific/Pohnpei"},o=[["America/Mexico_City",1396771200,360,300],["America/Chicago",1394352e3,360,300],["America/Havana",1394341200,300,240],["America/Denver",1394355600,420,360],["America/Chihuahua",1396774800,420,360],["America/Puerto_Rico",1420070400,240,240],["Asia/Baghdad",1420070400,-180,-180],["America/Guatemala",1420070400,360,360],["Asia/Chongqing",1420070400,-480,-480],["Africa/Cairo",1400191200,-120,-180],["Asia/Gaza",1395957600,-120,-180],["Asia/Istanbul",1396227600,-120,-180],["Europe/Athens",1396141200,-120,-180],["Africa/Casablanca",1396144800,0,-60],["Europe/Lisbon",1396141200,0,-60]];e=function(){for(var e=[],t=0;t<12;++t){var r=new Date(2014,t).toString().replace(/^.*\((.+)\)$/,"$1");-1===e.indexOf(r)&&e.push(r)}var i=e.sort().join(" ");if(i in n)return n[i];for(var a=0;a<o.length;++a){var s=o[a];if(new Date(1e3*s[1]-1).getTimezoneOffset()===s[2]&&new Date(1e3*s[1]).getTimezoneOffset()===s[3])return s[0]}return null}()}return e}(),locale:o},platform:"Web"}}}))}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e.prototype.SubscriptionState={DENIED:-3,UNSUPPORTED:-2,UNSUBSCRIBED:-1,UNDETERMINED:0,NOT_SUBSCRIBED:1,SUBSCRIBED:2},Object.freeze(e.prototype.SubscriptionState)}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){const{ReportingDataUtil:t}=n(5);var o="[notification]",r=new e._protected.Promise.Deferred,i="undefined"!=typeof Notification,a=null;e.prototype.Notification=new function(){this.requestPopupToFinalizeRegistration=function(t){return e._protected.Notification.setNotificationEnabled(!0)};var t={modalBoxIcon:null,modalBoxTitle:null,modalBoxMessage:"We will send you personalized notifications.<br/>You can always unsubscribe at any time.",modalBoxButton:"Got it!",modalBoxCancellable:!0,externalBoxWidth:500,externalBoxHeight:500,externalBoxLogoUrl:null,externalBoxLogoWidth:90,externalBoxLogoHeight:90,externalBoxProcessingMessage:"Subscribing...",externalBoxSuccessMessage:"Thanks for subscribing!",externalBoxFailureMessage:"Sorry, something went wrong.",externalBoxTooLongHint:"Poor connection or private browsing?",externalBoxCloseHint:"Close",externalBoxCloseDelay:e._protected.Constants.POPUP_AUTOCLOSE_SLEEP};this.setOptInOptions=function(n){e._protected.Helper.mergeObjectInplaceRecursive(t,n)},this.getOptInOptions=function(){var n=e._protected.Helper.plainObjectCopy(t);return n&&"Inscription en cours..."===n.externalBoxProcessingMessage&&(n=e._protected.Helper.assign({externalBoxMessage:"Nous aimerions vous envoyer des notifications",externalBoxExampleTitle:"Notification exemple",externalBoxExampleMessage:"Ceci est un exemple de notification",externalBoxDisclaimer:"Vous pouvez vous dsinscrire  n'importe quel moment.",negativeButtonText:"Plus tard",positiveButtonText:"Je m'inscris"},n)),n};var n=function(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent},o={requestPopupToFinalizeRegistration_icon:null,requestPopupToFinalizeRegistration_title:null,requestPopupToFinalizeRegistration_text:null,requestPopupToFinalizeRegistration_buttonLabel:null,requestPopupToFinalizeRegistration_popupContent_processing:null,requestPopupToFinalizeRegistration_popupContent_success:null,requestPopupToFinalizeRegistration_popupContent_failure:null};Object.defineProperties(this,{requestPopupToFinalizeRegistration_icon:{set:function(t){e.prototype.Notification.setOptInOptions({modalBoxIcon:t}),o.requestPopupToFinalizeRegistration_icon=t},get:function(){return o.requestPopupToFinalizeRegistration_icon}},requestPopupToFinalizeRegistration_title:{set:function(t){e.prototype.Notification.setOptInOptions({modalBoxTitle:t}),o.requestPopupToFinalizeRegistration_title=t},get:function(){return o.requestPopupToFinalizeRegistration_title}},requestPopupToFinalizeRegistration_text:{set:function(t){e.prototype.Notification.setOptInOptions({modalBoxMessage:t}),o.requestPopupToFinalizeRegistration_text=t},get:function(){return o.requestPopupToFinalizeRegistration_text}},requestPopupToFinalizeRegistration_buttonLabel:{set:function(t){e.prototype.Notification.setOptInOptions({modalBoxButton:t}),o.requestPopupToFinalizeRegistration_buttonLabel=t},get:function(){return o.requestPopupToFinalizeRegistration_buttonLabel}},requestPopupToFinalizeRegistration_popupContent_processing:{set:function(t){e.prototype.Notification.setOptInOptions({externalBoxProcessingMessage:n(t),externalBoxTooLongMessage:n(t)}),o.requestPopupToFinalizeRegistration_popupContent_processing=t},get:function(){return o.requestPopupToFinalizeRegistration_popupContent_processing}},requestPopupToFinalizeRegistration_popupContent_success:{set:function(t){e.prototype.Notification.setOptInOptions({externalBoxSuccessMessage:n(t)}),o.requestPopupToFinalizeRegistration_popupContent_success=t},get:function(){return o.requestPopupToFinalizeRegistration_popupContent_success}},requestPopupToFinalizeRegistration_popupContent_failure:{set:function(t){e.prototype.Notification.setOptInOptions({externalBoxFailureMessage:n(t)}),o.requestPopupToFinalizeRegistration_popupContent_failure=t},get:function(){return o.requestPopupToFinalizeRegistration_popupContent_failure}}}),e._protected.RunModes.Behaviors.OptionsSource?e._protected.Config.getModuleInitializationPromise().then((function(){e.prototype.Notification.setOptInOptions({modalBoxIcon:e._protected.Options.getNotificationIcon(),modalBoxTitle:e._protected.Options.getApplicationName(),externalBoxLogoUrl:e._protected.Options.getNotificationIcon()}),e.prototype.Notification.setOptInOptions(e._protected.Options.getOptInOptions()),o.requestPopupToFinalizeRegistration_icon=e._protected.Options.getNotificationIcon(),o.requestPopupToFinalizeRegistration_title=e._protected.Options.getApplicationName(),o.requestPopupToFinalizeRegistration_text="We will send you personalized notifications.<br/>You can always change your preferences later.",o.requestPopupToFinalizeRegistration_buttonLabel="Got it!",o.requestPopupToFinalizeRegistration_popupContent_processing='<div style="font-family: sans-serif; text-align: center;"><p><img id="logo" width="90" height="90" border="0" src="'+e._protected.Options.getNotificationIcon()+'"/></p><p>Subscribing...</p></div>',o.requestPopupToFinalizeRegistration_popupContent_toolong='<div style="font-family: sans-serif; text-align: center;"><p><img id="logo" width="90" height="90" border="0" src="'+e._protected.Options.getNotificationIcon()+'"/></p><p>Subscribing...</p><p><small>Poor connection or private browsing?</small></p></div>',o.requestPopupToFinalizeRegistration_popupContent_success='<div style="font-family: sans-serif; text-align: center;"><p><img id="logo" width="90" height="90" border="0" src="'+e._protected.Options.getNotificationIcon()+'"/></p><p>Thanks for subscribing!</p><p><a href="#" onclick="javascript:window.close();"><small>Close</small></a></p></div>',o.requestPopupToFinalizeRegistration_popupContent_failure='<div style="font-family: sans-serif; text-align: center;"><p><img id="logo" width="90" height="90" border="0" src="'+e._protected.Options.getNotificationIcon()+'"/></p><p>Sorry, something went wrong.</p><p><a href="#" onclick="javascript:window.close();"><small>Close</small></a></p></div>',r.resolve()})):r.resolve(),this.getSubscriptionState=function(){return a}},e._protected.Notification=new function(){this.PERMISSION_GRANTED="granted",this.PERMISSION_DENIED="denied",this.PERMISSION_DEFAULT="default",this.PERMISSION_UNKNOWN="unknown",this.getModuleInitializationPromise=function(){return r.promise},this.getTrustedNotificationPermissionState=function(){let t;return(t=navigator.permissions&&navigator.permissions.query?navigator.permissions.query({name:"notifications"}).then(e=>e.state).catch(t=>(e._protected.Helper.warn(o,'[getTrustedNotificationPermissionState] navigator.permissions.query({name: "notifications"}) rejected',t),e._protected.Notification.PERMISSION_UNKNOWN)):e._protected.RunModes.Behaviors.ModeServiceWorker&&"undefined"!=typeof Notification?Promise.resolve(Notification.permission):Promise.resolve(e._protected.Notification.PERMISSION_UNKNOWN)).then(t=>{if("prompt"===t&&(t=e._protected.Notification.PERMISSION_DEFAULT),e._protected.RunModes.Behaviors.ModeServiceWorker)return t;var n="undefined"!=typeof Notification?Notification.permission:e._protected.Notification.PERMISSION_UNKNOWN,o=e._protected.Helper.detectBrowser(),r=parseInt(o.version.substr(0,o.version.indexOf(".")));return!1!==e._protected.gscope.isSecureContext&&e._protected.Integration.areTopWindowAndSelfOnRightDomain()||"Chrome"===o.name&&r>=62&&n===e._protected.Notification.PERMISSION_DENIED&&(n=e._protected.Notification.PERMISSION_UNKNOWN),n})},this.getTrustedOrCachedNotificationPermissionState=function(){return e._protected.Notification.getTrustedNotificationPermissionState().then((function(t){return t===e._protected.Notification.PERMISSION_UNKNOWN?e._protected.Notification.getTrustedNotificationPermissionStateCached().then((function(t){var n=e._protected.Notification.PERMISSION_UNKNOWN;return t.checkVersion>=2&&(n=t.permission),n})):Promise.resolve(t)}))},this.getTrustedNotificationPermissionStateCached=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Notification.getTrustedNotificationPermissionStateCached",(function(){var t={permission:e._protected.Notification.PERMISSION_UNKNOWN,date:+new Date};return e._protected.Storage.get("notificationPermissionStateCached",t).then((function(e){return!e.checkVersion||e.checkVersion<2||"denied"===e.permission&&e.checkVersion<=3&&"Chrome"===e.browserName&&e.browserVersionMajor>=62&&e.framed&&e.isSecureContext?t:e}))})),this.updateTrustedNotificationPermissionCacheIfPossible=function(){var t=+new Date;return e._protected.Integration.isOnRightDomain()?e._protected.Notification.getTrustedNotificationPermissionState().then((function(n){if(n===e._protected.Notification.PERMISSION_UNKNOWN)return!1;var o=e._protected.Helper.detectBrowser(),r={permission:n,date:t,checkVersion:4,sdkVersion:e.prototype.Constants.SDK_VERSION,browserName:o.name,browserVersion:o.version,browserVersionMajor:parseInt(o.version.substr(0,o.version.indexOf("."))),userAgent:navigator.userAgent,isSecureContext:e._protected.gscope.isSecureContext,framed:void 0!==e._protected.gscope.parent&&e._protected.gscope!==e._protected.gscope.parent,origin:location.origin,runMode:e._protected.RunModes.getCurrentModeNotForBehaviorTestingPurpose()},i=!1;return e._protected.Storage.getModuleInitializationPromise().then((function(){return e._protected.Storage.bulk([{test:{key:"notificationPermissionStateCached",defaultValue:{permission:null,date:0},operationsCb:function(e){if(!(r.date<e.date))return i=!0,{put:{key:"notificationPermissionStateCached",value:r}}}}}])})).catch((function(e){})).then((function(){return i}))})):Promise.resolve(!1)},this.refreshSubscriptionState=function(){e._protected.Integration.isOnRightDomain()&&(e._protected.Notification.isNativePushNotificationSupported()?Promise.all([e._protected.Notification.getManuallyUnsubscribed(),e._protected.Notification.getTrustedOrCachedNotificationPermissionState()]).then((function([t,n]){if(n===e._protected.Notification.PERMISSION_DENIED)e._protected.Notification.setSubscriptionState(e.prototype.SubscriptionState.DENIED);else if(t)e._protected.Notification.setSubscriptionState(e.prototype.SubscriptionState.UNSUBSCRIBED);else{const t=function(t){t?e._protected.Notification.setSubscriptionState(e.prototype.SubscriptionState.SUBSCRIBED):e._protected.Notification.setSubscriptionState(e.prototype.SubscriptionState.NOT_SUBSCRIBED)},n=function(e){};e._protected.RunModes.Behaviors.CanRegisterServiceWorker&&e._protected.Integration.isOnRightDomain()?e._protected.ServiceWorkerClient.getPushSubscriptionAndRegisterServiceWorkerIfNecessary().then(t,n):e._protected.RunModes.Behaviors.ContextServiceWorker||navigator.serviceWorker&&navigator.serviceWorker.controller&&e._protected.Integration.isOnRightDomain()?e._protected.ServiceWorkerClient.getPushSubscriptionFromServiceWorker().then(t,n):e._protected.Installation.getCachedInstallationPushToken().then((function(t){if(!t)return Promise.reject();e._protected.Notification.setSubscriptionState(e.prototype.SubscriptionState.SUBSCRIBED)}),(function(e){return Promise.reject()})).catch((function(){e._protected.Notification.setSubscriptionState(e.prototype.SubscriptionState.NOT_SUBSCRIBED)}))}})):e._protected.Notification.setSubscriptionState(e.prototype.SubscriptionState.UNSUPPORTED))},this.setSubscriptionState=function(t){var n=a;a=t,e._protected.Blocker.category("ready").remove("refreshSubscriptionState"),n!==a&&(e._protected.Events.fire(e._protected.Events.WonderPushSubscriptionEvent(t)),e._protected.RunModes.Behaviors.ModeFrame&&e._protected.Notification.setSubscriptionStateOnParentWindow(t),e._protected.RunModes.Behaviors.ModeServiceWorker?e._protected.Notification.setSubscriptionStateOnServiceWorkerClients(t):(e._protected.RunModes.Behaviors.ModeFrame||e._protected.RunModes.Behaviors.ModeWebSite&&e._protected.Integration.isOnRightDomain())&&e._protected.Helper.supportsServiceWorker()&&e._protected.Notification.setSubscriptionStateOnServiceWorker(t))},this.setSubscriptionStateOnParentWindow=e._protected.Integration.proxifyToParentWindow("WonderPushSDK._protected.Notification.setSubscriptionStateOnParentWindow",(function(t){e._protected.Notification.setSubscriptionState(t)})),this.setSubscriptionStateOnServiceWorker=e._protected.Integration.proxifyToServiceWorker("WonderPushSDK._protected.Notification.setSubscriptionStateOnServiceWorker",(function(t){e._protected.Notification.refreshSubscriptionState()})),this.setSubscriptionStateOnServiceWorkerClients=e._protected.Integration.proxifyToServiceWorkerClients("WonderPushSDK._protected.Notification.setSubscriptionStateOnServiceWorkerClients",(function(t){e._protected.Notification.setSubscriptionState(t)})),this.setManuallyUnsubscribed=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Notification.setManuallyUnsubscribed",(function(t){return e._protected.Notification.getManuallyUnsubscribed().then((function(n){if(!!t!=!!n)return e._protected.Storage.set("unsubscribed",t).then(()=>e._protected.Installation.Profile.getCoreProperties()).then(n=>(e.this.Rest.postEventually("/installation/",{body:JSON.stringify({preferences:n.preferences}),overwrite:"false"}),t?e._protected.Notification.setSubscriptionState(e.prototype.SubscriptionState.UNSUBSCRIBED):e._protected.Notification.refreshSubscriptionState()))}))})),this.getManuallyUnsubscribed=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Notification.getManuallyUnsubscribed",(function(){return e._protected.Storage.get("unsubscribed",!1).then((function(e){return!!e}))})),this.isNativePushNotificationSupported=function(){return i&&e._protected.Helper.supportsPushManager()},this.needUserGestureToAskPermission=function(){var t=e._protected.Helper.detectBrowser();return"Firefox"===t.name&&parseInt(t.version)>=71},this.askPermission=function(){var t=new e._protected.Promise.Deferred;return e._protected.Notification.isNativePushNotificationSupported()?e._protected.Integration.isOnRightDomain()?e._protected.RunModes.Behaviors.NotificationPermission?(e._protected.ServiceWorkerClient.registerServiceWorker(),Notification.requestPermission((function(n){e._protected.Notification.updateTrustedNotificationPermissionCacheIfPossible().then((function(){return"denied"===(n=Notification.permission)?t.reject(new e.prototype.Errors.PermissionError("User denied notification permission","notification",n)):"granted"!==n?t.reject(new e.prototype.Errors.UserCancellationError("User neither granted or denied notification permission")):void t.resolve(n)}))})),t.promise):(t.reject(new e._protected.Errors.InternalWrongTargetError),t.promise):(t.reject(new e._protected.Errors.InternalWrongDomainError),t.promise):(t.reject(new e.prototype.Errors.PushNotificationsNotSupportedError),t.promise)},this.askPermissionAndRegisterInWindow=function(){var t,n,o=new e._protected.Promise.Deferred;if(!e._protected.Integration.isOnRightDomain())return o.reject(new e._protected.Errors.InternalWrongDomainError),o.promise;var r=function(e){t=+new Date,n=e},i=function(){e._protected.Analytics.sendEvent("askPermissionAndRegisterInWindow",n,null,+new Date-t)};return r("askPermission"),e._protected.Notification.askPermission().then((function(t){return i(),r("setManuallyUnsubscribed"),e._protected.Integration.callOnCustomDomain("WonderPushSDK._protected.Notification.setManuallyUnsubscribed",[!1])})).then((function(){return i(),r("registerForPushNotifications"),e._protected.Integration.callOnCustomDomain("WonderPushSDK._protected.ServiceWorkerClient.registerForPushNotifications")})).then((function(t){return i(),r("addInstallationPushToken"),e._protected.Integration.callOnCustomDomain("WonderPushSDK._protected.Installation.addInstallationPushToken",[t])})).then((function(){i(),o.resolve()})).catch((function(r){e._protected.Analytics.sendEvent("askPermissionAndRegisterInWindow",n+"-error",r&&r.name,+new Date-t),o.reject(r)})),o.promise},this.openPopupAskPermissionAndRegister=function(t){var n=new e._protected.Promise.Deferred,o=new URL(e._protected.Integration.getFrameUrl()),r=e._protected.Options.exportInitial();r._mode=e._protected.RunModes.Modes.Popup,o.search="?wonderpushPopupUI=permission&wonderpushInitOpts="+encodeURIComponent(JSON.stringify(r));var i=e.prototype.Notification.getOptInOptions();const a=e._protected.Integration.openPopup(o.href,{width:i.externalBoxWidth,height:i.externalBoxHeight,center:"window"});if(!a)return void n.reject(new e.prototype.Errors.PopupError("Cannot open popup"));const s=Math.max(i.externalBoxCloseDelay,1e3);return e._protected.Integration.probeWindowObject(a,e._protected.Integration.getTargetOrigin(),{type:"isReady"},e=>e.data instanceof Object&&"readiness"===e.data.type&&e.data.ready).then(()=>{e._protected.Integration.callOnPopupWindow(a,"WonderPushSDK._protected.PopupUI.waitForSubscription").then(()=>(n.resolve(),setTimeout((function(){a.close()}),s),e._protected.Integration.callOnCustomDomain("WonderPushSDK._protected.Notification.refreshSubscriptionState")),t=>{t instanceof e.prototype.Errors.UserCancellationError?a.close():setTimeout((function(){a.close()}),s),n.reject(t)})}).catch(e=>n.reject(e)),n.promise},this.presentModal=function(t,n){var o=e.prototype.Notification.getOptInOptions(),r={icon:o.modalBoxIcon,title:o.modalBoxTitle,text:o.modalBoxMessage,buttons:[{label:o.modalBoxButton,onclick:function(e,n){t(e)}}],cancellable:o.modalBoxCancellable,oncancel:function(t){n(new e.prototype.Errors.UserCancellationError("Modal cancelled by user"))}};e._protected.Modal.show(r)};var n=!1;this.isRegistrationInProgress=function(){return n},this.setNotificationEnabled=function(t,o){return e._protected.Notification.isNativePushNotificationSupported()?n?Promise.reject(new e.prototype.Errors.RegistrationInProgressError("Registration already in progress")):new Promise((function(r,i){var a=function(e){n=!1,i(e)},s=function(e){n=!1,r(e)},c=e.prototype.Notification.getSubscriptionState();if(t&&c===e.prototype.SubscriptionState.SUBSCRIBED)s();else if(t||c!==e.prototype.SubscriptionState.UNSUBSCRIBED)if(t)if(e._protected.Notification.isAllowedSubscriptionDomain(window.location.origin)){n=!0;var p=e._protected.Integration.isOnRightDomain();if(p&&!1!==e._protected.gscope.isSecureContext)e._protected.Notification.askPermissionAndRegisterInWindow().then((function(){s()}),(function(e){a(e)}));else if(p&&!1===e._protected.gscope.isSecureContext&&e._protected.Helper.warn("Although on custom domain (location.href =",e._protected.gscope.location.href,"), isSecureContext is",e._protected.gscope.isSecureContext),o)e._protected.Notification.openPopupAskPermissionAndRegister(o).then(s,a);else{if(!e._protected.RunModes.Behaviors.Modal)return;e._protected.Notification.presentModal((function(t){e._protected.Notification.openPopupAskPermissionAndRegister(t).then(s,a)}),(function(e){a(e)}))}}else e._protected.Helper.warn("Current origin is not allowed to subscribe");else e._protected.ServiceWorkerClient.unsubscribeFromPush().then((function(){s()}),(function(t){a(new e._protected.Errors.InternalStorageError("Failed to store unsubscription"))}));else s()})):Promise.resolve()},this.isAllowedSubscriptionDomain=function(t){if((t=t||window.location.origin).startsWith("https://")||t.startsWith("http://")||(t="https://"+t),t===e._protected.Integration.getHomeOrigin())return!0;let n=e._protected.Options.getAllowedSubscriptionDomains();return null==n||(Array.isArray(n)||(n=[]),-1!==(n=n.map(t=>{const n=t.match(/^\/(.*)\/([gimsuy]*)$/);if(null!==n)try{return new RegExp(n[1],n[2])}catch(n){e._protected.Helper.warn(o,"Failed to construct regex from",t)}const r=t.match(/^(https?:\/\/)?([^\/]+)(?:\/.*)?$/);if(null===r)return/^$/;let[i,a,s,c]=r;return a||(a="https?:\\/\\/"),s=(s=e._protected.Helper.escapeRegExp(s)).replace(/\\\*/g,"[^.\\/]+"),new RegExp(`^${a}${s}(\\/.*)?$`)})).findIndex(e=>e.test(t)))},this.handleActions=function(t,n){if(Array.isArray(n)){const o=[];n.forEach((function(n){try{if(!(n instanceof Object))return;switch(n.type){case e._protected.Constants.ACTION_LINK:n.url&&o.push(n);break;case e._protected.Constants.ACTION_METHOD:d(n);break;case e._protected.Constants.ACTION_TRACK_EVENT:l(t,n);break;case e._protected.Constants.ACTION_UPDATE_INSTALLATION:g(n);break;case e._protected.Constants.ACTION_SUBSCRIBE_TO_NOTIFICATIONS:f(n);break;case e._protected.Constants.ACTION_ADD_PROPERTY:h(n);break;case e._protected.Constants.ACTION_REMOVE_PROPERTY:m(n);break;case e._protected.Constants.ACTION_RESYNC_INSTALLATION:v(n);break;case e._protected.Constants.ACTION_ADD_TAG:s(n);break;case e._protected.Constants.ACTION_REMOVE_TAG:c(n);break;case e._protected.Constants.ACTION_REMOVE_ALL_TAGS:p(n);break;case e._protected.Constants.ACTION__OVERRIDE_NOTIFICATION_RECEIPT:_(n);break;default:console.log("Unhandled action type ",n.type," for action ",n)}}catch(e){console.error("Unexpected error while handling action ",n,e)}})),o.length&&o.length<n.length?setTimeout(()=>u(o[0]),500):o.length&&u(o[0])}};var u=function(e){const{url:t}=e||{};t&&"undefined"!=typeof window&&(window.location=t)},d=function(t){const{method:n,methodArg:o}=t||{};if(n){const t=new e._protected.Events.MethodCall(n,o);e._protected.Events.fire(t)}},l=function(n,o){var r=o.event||{};e._protected.trackEventWithInternalData(r.type,t.withEventData({},n),r.custom)},f=function(t){e.prototype.subscribeToNotifications(t.domEvent)},g=function(t){var n=t.installation&&t.installation.custom?t.installation.custom:t.custom;n&&Object.keys(n).length&&(t.appliedServerSide?e._protected.JsonSyncInstallationCustom.receiveDiffForUser(e._protected.Options.getUserId(),n):e._protected.JsonSyncInstallationCustom.putInstallationCustomPropertiesForUser(e._protected.Options.getUserId(),n))},h=function(t){var n=t.installation&&t.installation.custom?t.installation.custom:t.custom;n&&Object.keys(n).length&&Object.keys(n).forEach(t=>{const o=n[t];e._protected.Installation.addProperty(t,o)})},m=function(t){var n=t.installation&&t.installation.custom?t.installation.custom:t.custom;n&&Object.keys(n).length&&Object.keys(n).forEach(t=>{const o=n[t];e._protected.Installation.removeProperty(t,o)})},v=function(t){var n=function(t){var n=t.installation,o=n?n.custom:null;if(!o){if(!n)return;o={}}t.reset?e._protected.JsonSyncInstallationCustom.receiveStateForUser(e._protected.Options.getUserId(),o,!!t.force):e._protected.JsonSyncInstallationCustom.receiveServerStateForUser(e._protected.Options.getUserId(),o),e._protected.Installation.updateInstallationCoreProperties(),e._protected.ServiceWorker.resendPushToken(!0);var r={preferences:{subscriptionStatus:e.prototype.Notification.getSubscriptionState()===e.prototype.SubscriptionState.UNSUBSCRIBED?"optOut":"optIn"}};e.this.Rest.postEventually("/installation",{body:JSON.stringify(r),overwrite:!1})};t.installation?n(t):e._protected.Installation.getInstallationFromServer().then((function(e){Object.keys(e).forEach((function(t){t.startsWith("_")&&delete e[t]})),t.installation=e,n(t)}),(function(e){}))},_=function(t){var n=t.force;e._protected.Helper.log(o,"OVERRIDE notification receipt:",n),e._protected.Storage.set("_overrideNotificationReceipt",n)}};var s=function(t){const n=t.tags;e._protected.Installation.addTag(n)},c=function(t){const n=t.tags;e._protected.Installation.removeTag(n)},p=function(t){e._protected.Installation.removeAllTags()};return Promise.all([e._protected.Integration.getModuleInitializationPromise(),e._protected.Consent.awaitUserConsent()]).then((function(){e._protected.Notification.updateTrustedNotificationPermissionCacheIfPossible()})),e._protected.Blocker.category("ready").add("refreshSubscriptionState"),e._protected.Integration.getModuleInitializationPromise().then((function(){if(e._protected.Integration.isOnRightDomain()&&(e._protected.Notification.refreshSubscriptionState(),"undefined"!=typeof navigator&&navigator.permissions&&navigator.permissions.query))try{navigator.permissions.query({name:"notifications"}).then((function(t){t&&t.addEventListener("change",(function(){e._protected.Notification.refreshSubscriptionState(),Promise.all([e._protected.Consent.hasUserConsent(),e._protected.Session.getCurrentSession()]).then(([t,n])=>{t&&n&&n.accessToken&&e._protected.Installation.Profile.getCoreProperties().then(t=>{e.this.Rest.post("/installation/",{body:JSON.stringify({preferences:t.preferences}),overwrite:"false"})})})}))}))}catch(e){}})),r.promise}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){const{EventAttributionManager:t,ReportingDataUtil:o}=n(5);if(e._protected.RunModes.Behaviors.ContextServiceWorker&&e._protected.Helper.supportsPushManager()){var r="[sw          ]",i=e._protected.gscope;e._protected.ServiceWorker.resendPushToken=function(t){return e.instantiationPromise.then((function(){return e.prototype.getInitializationPromise().then((function(){return e._protected.ServiceWorkerClient.refreshPushToken(registration).then((function(){}),(function(n){e._protected.ServiceWorkerClient.getPushSubscriptionFromServiceWorker().then((function(n){e._protected.Installation.addInstallationPushToken(n,t)}),(function(e){}))}))}))}))},e._protected.ServiceWorker.checkForCustomDomainChange=function(){return e.instantiationPromise.then((function(){return e.prototype.getInitializationPromise().then((function(){e._protected.Integration.getCurrentOperatingOrigin()!==e._protected.Integration.getHomeOrigin()&&Promise.all([e._protected.Init.getDeviceId(),e._protected.Init.getFederatedDeviceId(),e._protected.Storage.get("customDomainMigrationInfo")]).then((function(t){var n=t[0],o=t[1],r=t[2]||{};n===o||r.deviceId===n&&r.federatedDeviceId===o||(e._protected.trackInternalEvent("@WEB_CUSTOM_DOMAIN_MIGRATION"),r.deviceId=n,r.federatedDeviceId=o,r.eventDate=+new Date,e._protected.Storage.set("customDomainMigrationInfo",r))}))}))}))};var a=function(t){var n;if("data"in t&&t.data&&"object"==typeof t.data&&"json"in t.data){var r;console.info("[WonderPush] Received push data:",t.data.text());try{r=t.data.json(),console.info("[WonderPush] Parsed push data:",r)}catch(t){console.error("[WonderPush] Push data was not valid JSON",t)}r&&"object"==typeof r&&("_wp"in r?n=Promise.resolve(r):r.data&&"object"==typeof r.data&&"_wp"in r.data&&(n=Promise.resolve(r.data))),n||(console.error("[WonderPush] Failed to find the data in the PushEvent!"),n=Promise.reject())}else{var i=function(t,n){var o=(n=n||0)?e._protected.Constants.GET_DELIVERIES_ERROR_WAIT_MS:0;return o+=e._protected.Constants.GET_DELIVERIES_RANDOM_WAIT_MIN_MS+Math.random()*(e._protected.Constants.GET_DELIVERIES_RANDOM_WAIT_MAX_MS-e._protected.Constants.GET_DELIVERIES_RANDOM_WAIT_MIN_MS),e._protected.Promise.DelayedStartPromise((function(t,n){e.this.Rest.fetch("GET","/deliveries",{status:"pending"}).then(t,n)}),o).then((function(e){if(200!==e.status)throw console.error("Failed to fetch last notification, got status ",e.status,e.statusText,":",e),e;return e}),(function(e){throw e.status&&e.statusText?console.error("Failed to fetch last notification, got status ",e.status,e.statusText,":",e):console.error("Failed to fetch last notification:",e),e})).catch((function(e){if(t>0)return console.log("Will retry"),i(t-1,n+1);throw e}))};n=e.this.getInitializationPromise().then((function(){return i(e._protected.Constants.GET_DELIVERIES_TRIES-1)})).then((function(t){return t.json().then((function(t){if(t.deliveries.length>0){const e=t.deliveries[t.deliveries.length-1].data;return console.info("[WonderPush] Fetched push data:",e),e}throw new e.prototype.Errors.NotificationPayloadError("No received notification")}))}))}return n.then((function(t){if(t){if(t._wp&&t._wp.receiveActions){const n=o.extract(t._wp);e._protected.Notification.handleActions(n,t._wp.receiveActions)}return c(t).then((function(){p(t)}))}console.error("Got empty notification!")}),(function(e){console.error("Failed to display a notification",e)}))},s=function(t){return console.log("pushsubscriptionchange event",t),t.newSubscription?e._protected.Installation.addInstallationPushToken(t.newSubscription):e._protected.ServiceWorkerClient.refreshPushToken(registration).then((function(e){console.log("Push subscription renewed",e)}),(function(e){throw console.error("Failed to renew push subscription during the handling of a pushsubscriptionchange event",e),e}))},c=function(t){var n=t._wp||{};const a=o.extract(n);var s=n.alert||{},c=s.title||t.alertTitle||e._protected.Options.getApplicationName(),p=e._protected.Helper.plainObjectCopy(s);delete p.title,delete p.data,void 0!==p.body&&null!==p.body||(p.body=t.alert),void 0!==p.requireInteraction&&null!==p.requireInteraction||(p.requireInteraction=!0),p.icon||(p.icon=e._protected.Options.getNotificationIcon());var u=e._protected.Helper.detectBrowser();if("Chrome"===u.name&&"Macintosh"===u.platform&&parseInt(u.version)>=59){if(e._protected.Integration.getHomeOrigin().endsWith(e._protected.Constants.DEFAULT_DOMAIN_SUFFIX)){var d=[];c&&c!==e._protected.Options.getApplicationName()&&d.push(c),c=e._protected.Options.getApplicationName(),p.body&&d.push(p.body),d.length>0?p.body=d.join(" - "):delete p.body}p.image&&(p.icon=p.image,delete p.image)}return p.image&&"undefined"!=typeof Notification&&!Notification.prototype.hasOwnProperty("image")&&(p.icon=p.image,delete p.image),p.icon&&navigator.userAgent.indexOf("Linux")>=0&&"Firefox"===u.name&&parseInt(u.version)<50&&delete p.icon,"undefined"!=typeof Notification&&Notification.prototype.hasOwnProperty("data")?(p.data=t,null===p.tag?delete p.tag:"tag"in s||"string"!=typeof a.campaignId||(p.tag=a.campaignId)):p.tag=JSON.stringify(t),console.info("[WonderPush] Displaying notification. title:",c,p),i.registration.showNotification(c,p).then((function(e){}),(function(t){e._protected.Helper.error(r,"showNotification(",c,",",JSON.stringify(p),") rejected",t)}))},p=function(t){const n=(t||{})._wp||{};var i={actionDate:e._protected.Time.getRealTime()};o.assignEventData(i,o.extract(n)),e._protected.Storage.set("lastReceivedNotificationInfoJson",i);var a=n.receipt;return e._protected.Storage.bulk([{get:{key:"pushTokenCache",defaultValue:{}}},{get:{key:"_overrideNotificationReceipt",defaultValue:null}},{get:{key:e._protected.Constants.LAST_RECEIVED_NOTIFICATION_CHECK_DATE_STORAGE_KEY,defaultValue:null}}]).then((function(t){var o=t.results.byKey.pushTokenCache,s=t.results.byKey[e._protected.Constants.LAST_RECEIVED_NOTIFICATION_CHECK_DATE_STORAGE_KEY];const c=n[e._protected.Constants.LAST_RECEIVED_NOTIFICATION_CHECK_DELAY_PAYLOAD_KEY]||e._protected.Constants.DEFAULT_LAST_RECEIVED_NOTIFICATION_CHECK_DELAY;if("number"!=typeof s||+new Date-s>c){const t=+new Date;e.this.Rest.postEventually("/installation",{body:JSON.stringify({[e._protected.Constants.LAST_RECEIVED_NOTIFICATION_CHECK_DATE_INSTALLATION_KEY]:t}),overwrite:"false"}).then(()=>e._protected.Storage.set(e._protected.Constants.LAST_RECEIVED_NOTIFICATION_CHECK_DATE_STORAGE_KEY,t)).catch(t=>e._protected.Helper.warn(r,"Could not report last received notification check date",t))}var p=t.results.byKey._overrideNotificationReceipt;null!=p&&(a=p),o.pushTokenP256dh&&o.pushTokenAuth||(a=!0),a?e._protected.trackInternalEvent("@NOTIFICATION_RECEIVED",i):e._protected.trackInternalEventWithMeasurementsApi("@NOTIFICATION_RECEIVED",i)})),t},u=function(n){return new Promise((function(r,a){var s;if(n.notification.tag,"undefined"!=typeof Notification&&Notification.prototype.hasOwnProperty("data"))s=n.notification.data;else try{s=JSON.parse(n.notification.tag)}catch(e){}s&&"object"==typeof s||(s={});var c,p=s._wp||{},u=p.targetUrl,f=p.actions,g=p.locationFilter,h=(p.alert||{}).actions||[];"string"==typeof n.action&&(c=h.filter((function(e){return e&&"object"==typeof e&&e.action===n.action}))[0]),c&&(u=c.targetUrl||u,g=c.locationFilter||g,f=c.actions||f),p.inApp&&p.inApp.content&&(e._protected.InAppMessaging.forceDisplayOnNextEvent(["ON_FOREGROUND"],p.inApp),g="about:blank"),n.notification.close();const m=o.extract(p);var v={actionDate:e._protected.Time.getRealTime()};if(o.assignEventData(v,m),c&&(v.buttonLabel=c.title),new t(e._protected.Storage).setCurrentAttribution(m,e._protected.Constants.DIFFERENT_SESSION_REGULAR_MIN_TIME_GAP),e._protected.Storage.set("lastOpenedNotificationInfoJson",v),e._protected.trackInternalEvent("@NOTIFICATION_OPENED",v),e._protected.Notification.handleActions(m,f),u&&u.startsWith("wonderpush://")){if("wonderpush://notificationOpen/noop"===u)return;if("wonderpush://notificationOpen/broadcast"===u)return void e._protected.Events.fire(e._protected.Events.WonderPushNotificationOpenedEvent(n));u=void 0}clients.matchAll({type:"window"}).then((function(t){var n=new RegExp((g||{}).regex||"^"+e._protected.Helper.escapeRegExp("string"==typeof g?g:new URL(u||e._protected.Options.getDefaultNotificationUrl()||i.registration.scope,i.registration.scope).href),(g||{}).flags);return t.filter((function(e){return!!e.url.match(n)}))})).then((function(e){var t=e;return e.some((function(e){return!!e.focused&&(t=[e],!0)})),t})).then((function(t){return t.length<2?t:SDK._protected.Promise.allTimeout(t.map((function(t){return new Promise((function(n,o){var r=new MessageChannel;r.port2.onmessage=function(e){var t=e.data&&"getLastFocusTimestamp"===e.data.type?e.data.data:0;n(t)},t.postMessage({sdk:e._protected.sdkName,type:"getLastFocusTimestamp"},[r.port1])}))})),e._protected.Constants.SW_PING_TIMEOUT_MS,0).then((function(e){var n=-1,o=0;return e.forEach((function(e,t){e>o&&(n=t,o=e)})),n<0?[]:[t[n]]}))})).then((function(e){if(e<1)return Promise.reject();l(e[0],s,"Sending notification to the most recently focused client").then(r)})).catch((function(){d(s,u).then(r,a)}))}))},d=function(t,n){return clients.openWindow?(n=n||e._protected.Options.getDefaultNotificationUrl()||i.registration.scope,clients.openWindow(n).catch((function(t){if(t.code===t.SECURITY_ERR){var o=e._protected.Integration.getRedirectionPageUrl(n);return clients.openWindow(o.href)}})).then((function(n){if(n){var o=e._protected.Integration.probeWindowObject({postMessage:(e,t,o)=>{n.postMessage(e,o)}},e._protected.Integration.getTargetOrigin(),{type:"isReady"},e=>e.data instanceof Object&&"readiness"===e.data.type&&e.data.ready);return e._protected.Promise.timeout(o,e._protected.Constants.SW_MAX_PAGELOAD_MS).then((function(){return l(n,t,"Sending notification to new client")}),(function(){console.log("Waited "+e._protected.Constants.SW_MAX_PAGELOAD_MS/1e3+"s for the newly opened window to be ready before sending it the clicked notification, aborting. (Normal if opening an external website.)")}))}}))):Promise.reject(new e.prototype.Errors.InternalError("Cannot open new client window to display notification"))},l=function(t,n,o){var r=function(){o&&console.log(o),t.postMessage({sdk:e._protected.sdkName,type:"nativeNotificationOpen",data:n})};return t.focus().then(r,r)};e._protected.ServiceWorker.addEventListener("install",(function(t){return e.instantiationPromise.then((function(){return i.skipWaiting()}))})),e._protected.ServiceWorker.addEventListener("activate",(function(e){return i.clients.claim()})),e._protected.ServiceWorker.addEventListener("push",(function(t){return e.instantiationPromise.then((function(){return a(t)}))})),e._protected.ServiceWorker.addEventListener("pushsubscriptionchange",(function(t){return e.instantiationPromise.then((function(){return s(t)}))})),e._protected.ServiceWorker.addEventListener("notificationclick",(function(t){return e.instantiationPromise.then((function(){return u(t)}))})),e._protected.ServiceWorker.resendPushToken(),e._protected.ServiceWorker.checkForCustomDomainChange(),"undefined"!=typeof navigator&&navigator.permissions&&navigator.permissions.query&&navigator.permissions.query({name:"notifications"}).then(t=>{t&&t.addEventListener("change",t=>{const n=t.target instanceof PermissionStatus?t.target:void 0;if(n&&"granted"===(n.state||n.status)){const t=()=>{e._protected.Init.getSessionState()===e.this.SessionState.INIT_INPROGRESS&&(e._protected.Notification.refreshSubscriptionState(),setTimeout(t,3e3))};setTimeout(t,3e3)}})})}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t,n="[sw-client   ]";let o=!1;var r;e.instantiationPromise.then(()=>{o=!0}),t=function(){e._protected.Integration.getModuleInitializationPromise().then((function(){e._protected.RunModes.Behaviors.ModeWebSite&&i(),e._protected.RunModes.Behaviors.RegisterServiceWorker&&e._protected.Helper.supportsServiceWorker()&&e._protected.Helper.supportsPushManager()&&"https:"===location.protocol&&e.instantiationPromise.then((function(){a()}))}))};var i=function(){addEventListener("focus",p),document.hasFocus()&&p()},a=function(){e._protected.Notification.getTrustedOrCachedNotificationPermissionState().then((function(t){t===e._protected.Notification.PERMISSION_GRANTED&&e._protected.ServiceWorkerClient.registerServiceWorker().then((function(t){return e._protected.Notification.getManuallyUnsubscribed().then((function(n){n||(e._protected.RunModes.Behaviors.RefreshPushToken?e._protected.ServiceWorkerClient.refreshPushToken(t).then((function(){}),(function(e){})):e._protected.ServiceWorkerClient.getPushSubscriptionAndRegisterServiceWorkerIfNecessary().then(t=>{e._protected.Installation.addInstallationPushToken(t)}))}))}))}))};e._protected.ServiceWorkerClient.refreshPushToken=function(t){return e._protected.gscope.isSecureContext,e._protected.Notification.getTrustedNotificationPermissionState().then((function(n){return n!==e._protected.Notification.PERMISSION_GRANTED?(n!==e._protected.Notification.PERMISSION_UNKNOWN&&e._protected.Installation.removeInstallationPushToken(),Promise.reject(new e.prototype.Errors.PermissionError("Notification permission is not granted","notification",n))):e._protected.Integration.getManifestInjectedPromise().then((function(){return s(t)})).then((function(t){return t?(e._protected.Installation.addInstallationPushToken(t),t):Promise.reject(new e.prototype.Errors.InternalError("Could not get push token"))})).catch((function(e){throw e}))}))};var s=function(t){if(!t||!t.pushManager)return Promise.reject(new e.prototype.Errors.InvalidArgumentError("No valid registration given"));if(!t.active)return new e._protected.Promise.Poll(()=>t.active,1e4,50).wait().then(()=>s(t));var o={userVisibleOnly:!0,applicationServerKey:e._protected.Helper.arrayBufferFromBase64UrlSafe(e._protected.Options.getApplicationServerKey()||"")};o.applicationServerKey||delete o.applicationServerKey;var r=2*e._protected.Constants.PUSH_MANAGER_SUBSCRIBE_TOO_LONG,i=3*e._protected.Constants.PUSH_MANAGER_SUBSCRIBE_TOO_LONG,a=new e._protected.Locking.ExpiringUnfairNamedGlobalMutex("pushManager.subscribe",r),c=+new Date;return a.acquire({interval:500,timeout:i}).then((function(){var r,i=!1;return setTimeout((function(){i||console.warn("Subscribing to push notifications seems to take too long Are you on a slow network or using private browsing?")}),e._protected.Constants.PUSH_MANAGER_SUBSCRIBE_TOO_LONG),e._protected.Promise.do(e._protected.Storage.get("pushTokenCache",{}).then((function(e){r=e.date})).then((function(){return t.pushManager.getSubscription()})).catch((function(t){return e._protected.Helper.warn(n,"[subscribeAppropriately] pushManager.getSubscription() rejected",t),null})).then((function(t){if(t){const i=e._protected.Helper.plainObjectCopy(t.options),a=e._protected.Helper.plainObjectCopy(o);if("userVisibleOnly"in PushSubscriptionOptions.prototype||delete a.userVisibleOnly,t.options&&!e._protected.JsonUtil.equal(i,a)||t.expirationTime&&((new Date).getTime()>=t.expirationTime||r&&(new Date).getTime()>(t.expirationTime+r)/2))return e._protected.Helper.info(n,"[subscribeAppropriately] We'll unsubscribe the existing subscription to update its applicationServerKey"),t.unsubscribe().then((function(e){}),(function(t){e._protected.Helper.warn(n,"[subscribeAppropriately] existingSubscription.unsubscribe() rejected",t)}))}})).then((function(){return t.pushManager.subscribe(o)})).then((function(t){return e._protected.Analytics.sendEvent("serviceWorkerClient","subscribeAppropriately",null,+new Date-c),t}),(function(t){e._protected.Helper.error(n,"[subscribeAppropriately] pushManager.subscribe(",o,") rejected",t);var r="";throw t&&(t.name&&(r+=t.name),t.message&&(r+=": "+t.message)),e._protected.Analytics.sendEvent("serviceWorkerClient","subscribeAppropriately-error",r,+new Date-c),t})),(function(){i=!0,a.release()}))}),(function(e){throw e}))};e._protected.ServiceWorkerClient.registerForPushNotifications=function(){return e._protected.Integration.isOnRightDomain()?(!1===e._protected.gscope.isSecureContext&&e._protected.Helper.log(n,"[registerForPushNotifications] isSecureContext=false, likely because of opener, continuing anyway"),e._protected.RunModes.Behaviors.ContextServiceWorker?Promise.reject(new e._protected.Errors.InternalWrongTargetError):"granted"!==Notification.permission?Promise.reject(new e.prototype.Errors.PermissionError("registerForPushNotifications called without permission granted")):navigator.serviceWorker?e._protected.ServiceWorkerClient.registerServiceWorker().then((function(e){return s(e)})).then((function(e){return e})).catch((function(e){throw e})):new Promise((e,t)=>{})):Promise.reject(new e._protected.Errors.InternalWrongDomainError)};const c=e._protected.ServiceWorkerClient.registerServiceWorker;e._protected.ServiceWorkerClient.registerServiceWorker=function(){if(!e._protected.RunModes.Behaviors.CanRegisterServiceWorker)return Promise.reject("Cannot register service worker from here.");var t=e._protected.Integration.getServiceWorkerUrl();return navigator.serviceWorker&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.scriptURL&&navigator.serviceWorker.controller.scriptURL!==t&&(e._protected.Helper.warn(n,"[registerServiceWorker] Existing service worker detected! Registering",t,"in place of",navigator.serviceWorker.controller.scriptURL),e._protected.Helper.warn(n,"[registerServiceWorker] Push notifications and offline support might not work."),e._protected.Helper.warn(n,"[registerServiceWorker] Please follow this guide: https://docs.wonderpush.com/docs/service-worker-integration")),c.apply(this,arguments)},e._protected.ServiceWorkerClient.unsubscribeFromPush=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.ServiceWorkerClient.unsubscribeFromPush",(function(){return e._protected.Notification.setManuallyUnsubscribed(!0).then((function(){return!0})).catch((function(){return!1}))}));var p=function(){e._protected.ServiceWorkerClient._focusHandlerCalled()};e._protected.ServiceWorkerClient._focusHandlerCalled=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.ServiceWorkerClient._focusHandlerCalled",(function(){r=+new Date})),e._protected.ServiceWorkerClient.addMessageEventListener((function(t){if(("undefined"==typeof ServiceWorkerMessageEvent||t instanceof ServiceWorkerMessageEvent)&&t.data instanceof Object&&t.data.sdk===e._protected.sdkName)switch(t.data.type){case"getLastFocusTimestamp":"ports"in t&&t.ports.length>0&&t.ports[0].postMessage({type:"getLastFocusTimestamp",data:r});break;case"isReady":t.ports&&t.ports.length>0&&t.ports[0].postMessage({type:"readiness",ready:o});break;case"nativeNotificationOpen":var n=((t.data||{}).data||{})._wp||{};n.targetUrl&&(n.targetUrl.startsWith("wonderpush://")||window.location.href===n.targetUrl||(window.location=n.targetUrl))}})),t()}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o,r;o=[n(10)],void 0===(r=function(e){return function(t){t._protected.Modal=new function(){var n=null,o=function(t,n){n instanceof Node?t.appendChild(n):n&&(t.innerHTML=e.sanitize(n))};this.show=t._protected.Integration.proxifyToParentWindow("WonderPushSDK._protected.Modal.show",(function(r){if(t._protected.RunModes.Behaviors.Visible&&(r=r||{},!n)){modal=document.createElement("div"),modal.classList.add("wp-modal");var i=document.createElement("div");i.classList.add("wp-modal-wrapper-outer"),!1!==r.cancellable&&i.addEventListener("click",(function(e){e.target===i&&("function"==typeof r.oncancel&&r.oncancel.call(this,e),t._protected.Modal.close())})),modal.appendChild(i);var a=document.createElement("div");a.classList.add("wp-modal-wrapper-inner"),i.appendChild(a);var s=document.createElement("div");if(s.classList.add("wp-modal-block"),a.appendChild(s),r.title){var c=document.createElement("div");if(c.classList.add("wp-modal-title"),s.appendChild(c),r.icon){var p=document.createElement("div");p.classList.add("wp-modal-title-icon"),p.style.backgroundImage='url("'+encodeURI(r.icon)+'")',c.appendChild(p)}var u=document.createElement("div");u.classList.add("wp-modal-title-text"),o(u,r.title),c.appendChild(u)}var d=document.createElement("div");if(d.classList.add("wp-modal-content"),s.appendChild(d),r.content)o(d,r.content);else if(r.text){var l=document.createElement("div");l.classList.add("wp-modal-text"),d.appendChild(l),o(l,r.text)}if(r.buttons&&r.buttons.length>0){var f=document.createElement("div");f.classList.add("wp-modal-buttons"),s.appendChild(f);for(var g=function(e){return function(n){"function"==typeof e.onclick&&e.onclick.call(this,n,e),t._protected.Modal.close()}},h=0;h<r.buttons.length;++h){var m=r.buttons[h],v=document.createElement("div");for(var _ in m.attributes||{})v.setAttribute(_,m.attributes[_]);v.classList.add("wp-modal-button"),o(v,m.label),v.outerHTML=e.sanitize(v.outerHTML),v.addEventListener("click",g(m)),f.appendChild(v)}}return document.body.classList.add("modal-open"),document.body.appendChild(modal),n=modal,modal}})),this.close=t._protected.Integration.proxifyToParentWindow("WonderPushSDK._protected.Modal.close",(function(){document.body.classList.remove("modal-open"),document.documentElement.classList.remove("modal-open"),n&&(n.parentNode.removeChild(n),n=null)}))}}}.apply(t,o))||(e.exports=r)},function(e,t,n){var o,r;o=[n(10)],void 0===(r=function(e){return function(t){var n=new t._protected.Promise.Deferred;return t._protected.PopupUI=new function(){var o,r,i=new t._protected.Promise.Deferred;let a=!t._protected.Notification.needUserGestureToAskPermission();Promise.all([t._protected.Integration.getModuleInitializationPromise(),t._protected.Notification.getModuleInitializationPromise()]).then((function(){var e=t._protected.Integration.getFrameUrl();o=new URL(e).origin,r=t.prototype.Notification.getOptInOptions(),n.resolve()}));const s=function(t){const n=t(),o=document.getElementById("whole-content");o.innerHTML=e.sanitize(n);const r=e=>{e.addEventListener("click",(function(e){e.preventDefault(),window.close()}))};o.querySelectorAll(".wonderpush-close-button").forEach(r),o.querySelectorAll(".wp-popup-negative-button").forEach(r),o.querySelectorAll(".wp-popup-positive-button").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),this.subscribeToNotifications(e)})})}.bind(this);var c=function(e,n){var o=t.prototype.Notification.getOptInOptions();return'<div class="wp-popup"><div class="wp-popup-content"><div id="logo" class="wp-popup-icon" style="width: '+o.externalBoxLogoWidth+"px; height:"+o.externalBoxLogoHeight+"px;"+(o.externalBoxLogoUrl?" background-image: url("+o.externalBoxLogoUrl+");":"")+'"></div><p>'+e+"</p>"+(n?"<p><small>"+n+"</small></p>":"")+"</div></div>"};const p=this.permissionUI=function(){var e=r.externalBoxTitle||t._protected.Options.getApplicationName(),n=void 0===r.externalBoxMessage?"We'd like to send you notifications":r.externalBoxMessage,i=r.externalBoxExampleTitle||"Example notification",s=r.externalBoxExampleMessage||"This is an example notification",c=o.replace(/^https?\:\/\//,""),p=r.externalBoxDisclaimer||"You can always unsubscribe at anytime.";const u=t._protected.Options.getNotificationIcon();return'<div class="wp-popup"><div class="wp-popup-content"><div class="wp-popup-title">'+e+"</div>"+(n?'<div class="wp-popup-message">'+n+"</div>":"")+'<div class="wp-popup-example"><div class="wp-popup-icon"'+(u?' style="background-image: url('+u+')"':"")+'></div><div class="wp-popup-example-text"><div class="wp-popup-example-title">'+i+'</div><div class="wp-popup-example-message">'+s+'</div><div class="wp-popup-example-url">'+c+'</div></div></div><div class="wp-popup-disclaimer">'+p+"</div>"+(a?"":'<div class="wp-popup-buttons"><button class="wp-popup-negative-button">'+(r.negativeButtonText||"Later")+'</button><button class="wp-popup-positive-button">'+(r.positiveButtonText||"Subscribe")+"</button></div>")+"</div></div>"};this.subscribeToNotifications=()=>{t.this.subscribeToNotifications().then(()=>{this.presentSuccessUI(),i.resolve()},e=>{e instanceof t.prototype.Errors.UserCancellationError||this.presentFailureUI(),i.reject(e)})},this.presentPermissionUI=()=>{s(p),a&&this.subscribeToNotifications()},this.waitForSubscription=()=>i.promise;const u=this.processingUI=function(){var e=t.prototype.Notification.getOptInOptions();return c(e.externalBoxProcessingMessage)};this.presentProcessingUI=s.bind(this,u);const d=this.timeoutUI=function(){var e=t.prototype.Notification.getOptInOptions();return c(e.externalBoxProcessingMessage,e.externalBoxTooLongHint)};this.presentTimeoutUI=s.bind(this,d);const l=this.successUI=function(){var e=t.prototype.Notification.getOptInOptions(),n='<a href="#" class="wonderpush-close-button">'+e.externalBoxCloseHint+"</a>";return c(e.externalBoxSuccessMessage,n)};this.presentSuccessUI=s.bind(this,l);const f=this.failureUI=function(){var e=t.prototype.Notification.getOptInOptions(),n='<a href="#" class="wonderpush-close-button">'+e.externalBoxCloseHint+"</a>";return c(e.externalBoxFailureMessage,n)};this.presentFailureUI=s.bind(this,f),this.getModuleInitializationPromise=function(){return n.promise}},n.promise}}.apply(t,o))||(e.exports=r)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.JsonUtil=new function(){this.stripNulls=function(t){t instanceof Object&&!Array.isArray(t)&&Object.keys(t).forEach((function(n){var o=t[n];null==o?delete t[n]:e._protected.JsonUtil.stripNulls(o)}))},this.deepCopy=function(e){if(void 0!==e)return null===e?null:JSON.parse(JSON.stringify(e))},this.equal=function(e,t){if(!e||!t)return e==t;var n=this.diff(e,t);return n&&0===Object.keys(n).length},this.merge=function(t,n,o){if(o=!1!==o,t&&n)for(var r in n){var i=n[r];if(r in t)if(Array.isArray(i))t[r]=e._protected.JsonUtil.deepCopy(i);else if(i instanceof Object){var a=t[r];Array.isArray(a)||"object"!=typeof a?t[r]=e._protected.JsonUtil.deepCopy(i):e._protected.JsonUtil.merge(a,i,o)}else null==i&&o?delete t[r]:t[r]=i;else o&&null==i||(t[r]=e._protected.JsonUtil.deepCopy(i))}},this.diff=function(t,n){if("object"!=typeof t||"object"!=typeof n||Array.isArray(t)||Array.isArray(n))throw new e.prototype.Errors.InvalidArgumentError("diff only accept objects as arguments");if(null==n)return null;if(null==t)return e._protected.JsonUtil.deepCopy(n);var o,r,i={};for(o in t){r=o in n?n[o]:null;var a=t[o];if(a!==r)if(Array.isArray(r))if(Array.isArray(a)&&r.length===a.length){for(var s=!1,c=0;c<a.length;++c)if(null==a[c]||null==r[c]||"object"!=typeof a[c]||"object"!=typeof r[c]||Array.isArray(t)||Array.isArray(n)){if(a[c]!==r[c]){s=!0;break}}else{var p=e._protected.JsonUtil.diff(a[c],r[c]);if(0!==Object.keys(p).length){s=!0;break}}s&&(i[o]=e._protected.JsonUtil.deepCopy(r))}else i[o]=e._protected.JsonUtil.deepCopy(r);else null==a||null==r||"object"!=typeof a||"object"!=typeof r||Array.isArray(a)||Array.isArray(r)?i[o]="object"==typeof r?e._protected.JsonUtil.deepCopy(r):r:(i[o]=e._protected.JsonUtil.diff(a,r),0===Object.keys(i[o]).length&&delete i[o])}for(o in n)o in t||(r=n[o],i[o]=e._protected.JsonUtil.deepCopy(r));return i}}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t=e._protected.JsonUtil;e._protected.JsonSyncCallbackBuilder=function(){var e=this,t={save:function(e){return Promise.resolve()},schedulePatchCall:function(){return Promise.resolve()},serverPatchInstallation:function(e){}};e.onSave=function(n){return t.save=n,e},e.onSchedulePatchCall=function(n){return t.schedulePatchCall=n,e},e.onServerPatchInstallation=function(n){return t.serverPatchInstallation=n,e},e.build=function(){return t}},e._protected.JsonSync=function(n,o,r,i,a,s,c,p){if(!n)throw new e.prototype.Errors.InvalidArgumentError("callbacks cannot be null");o=t.deepCopy(o||{}),r=t.deepCopy(r||{}),i=t.deepCopy(i||{}),a=t.deepCopy(a||{}),s=t.deepCopy(s||{}),c=!!c,p="number"==typeof p?p:0,t.stripNulls(o),t.stripNulls(r);var u=function(){var e={_syncStateVersion:1};return e.sdkState=o,e.serverState=r,e.putAccumulator=i,e.inflightDiff=a,e.inflightPutAccumulator=s,e.scheduledPatchCall=c,e.inflightPatchCallDeadline=p,Promise.resolve(n.save(e))},d=function(){return 0!==p},l=function(){return d()&&+new Date>p},f=function(){return c=!0,u().then((function(){return Promise.resolve(n.schedulePatchCall())}))};this.callPatch_onSuccess=function(){return p=0,s={},t.merge(r,a,!0),a={},u()},this.callPatch_onFailure=function(){return p=0,t.merge(s,i,!1),i=s,s={},f()},this.getSdkState=function(){return t.deepCopy(o)},this.hasInflightPatchCall=d,this.hasInflightPatchCallTimedout=l,this.hasScheduledPatchCall=function(){return c},this.performScheduledPatchCall=function(){return c?function(){if(d())return c?u():f();c=!1;try{a=t.diff(r,o)}catch(t){e._protected.Helper.error("[jsonsync    ]","[callPatch] Failed to diff server state and sdk state to send installation custom diff",r,o,t),a={}}if(!Object.keys(a).length)return u();p=+new Date+e._protected.Constants.JSON_SYNC_MAX_INFLIGHT_TIME,s=t.deepCopy(i),i={};var l=u();return l.then((function(){n.serverPatchInstallation(a)})),l}():Promise.resolve()},this.put=function(e){return e||(e={}),t.merge(o,e,!0),t.merge(i,e,!1),f()},this.receiveDiff=function(e){return e||(e={}),t.merge(r,e,!0),this.put(e)}.bind(this),this.receiveState=function(e,n){return e||(e={}),r=t.deepCopy(e),t.stripNulls(r),o=t.deepCopy(r),n?i={}:(t.merge(o,a,!0),t.merge(o,i,!0)),f()},this.receiveServerState=function(e){return e||(e={}),r=t.deepCopy(e),t.stripNulls(r),f()},this.save=u;var g=new Promise(function(e,t){l()?e(this.callPatch_onFailure()):this.hasScheduledPatchCall()?e(f()):e()}.bind(this));this.ready=function(){return g}},e._protected.JsonSync.fromSavedState=function(t,n){return n||(n={}),n._syncStateVersion,new e._protected.JsonSync(t,n.sdkState,n.serverState,n.putAccumulator,n.inflightDiff,n.inflightPutAccumulator,null==n.scheduledPatchCall||n.scheduledPatchCall,n.inflightPatchCallDeadline)}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t="[jsonsyncinst]";e._protected.JsonSyncInstallationCustom=function(r,s){var c=function(){return e.prototype.getInitializationPromise().then((function(){return n((function(){return o(r).then((function(e){return u=0,e.sync.performScheduledPatchCall()}))}))}))}.bind(this);this.flush=function(){null!==p&&(clearTimeout(p),p=null),c()};var p=null,u=0;r=r||null;var d=(new e._protected.JsonSyncCallbackBuilder).onServerPatchInstallation((function(n){return function(n){var o={body:JSON.stringify({custom:n}),overwrite:!1},s={onload:function(e){("function"==typeof e.json?e.json():Promise.resolve(this.responseJSON)).then((function(e){e&&!0===e.success?i(r):a(r)}),(function(e){a(r)}))},onerror:function(e){a(r)},ontimeout:function(e){a(r)},onabort:function(e){a(r)}};e._protected.Session.getSession(r).then(n=>{if(!n.accessToken)return e._protected.Helper.error(t,"We have no accessToken! Cannot call WonderPush API."),void setTimeout(()=>{a(r)},3e4);e._protected.Consent.hasUserConsent().then(t=>t&&e._protected.Rest.post(r,"/installation",o,void 0,s))})}(n)})).onSchedulePatchCall((function(){return function(){null!==p&&(clearTimeout(p),p=null);var t=+new Date;0===u&&(u=t);var n=Math.max(0,Math.min(e._protected.Constants.CACHED_INSTALLATION_CUSTOM_PROPERTIES_MIN_DELAY,u+e._protected.Constants.CACHED_INSTALLATION_CUSTOM_PROPERTIES_MAX_DELAY-t));p=setTimeout(c,n)}()})).onSave((function(t){return function(t){var n=r||"";return e._protected.Storage.get(e._protected.Constants.PER_USER_INSTALLATION_CUSTOM_PROPERTIES_STORAGE_KEY,{}).then((function(o){return o[n]=t,e._protected.Storage.set(e._protected.Constants.PER_USER_INSTALLATION_CUSTOM_PROPERTIES_STORAGE_KEY,o)}))}(t)})).build();this.sync=e._protected.JsonSync.fromSavedState(d,s),this.getSdkState=this.sync.getSdkState,this.put=this.sync.put,this.receiveServerState=this.sync.receiveServerState,this.receiveState=this.sync.receiveState,this.receiveDiff=this.sync.receiveDiff,this.callPatch_onSuccess=this.sync.callPatch_onSuccess,this.callPatch_onFailure=this.sync.callPatch_onFailure;var l=new e._protected.Promise.Deferred;this.sync.ready().then(function(){l.resolve(this)}.bind(this)).catch((function(e){l.reject(e)})),this.ready=function(){return l.promise}};var n=function(n){var o=new e._protected.Locking.ExpiringUnfairNamedGlobalMutex("jsonSyncInstallationCustom",5e3);return o.acquire({timeout:6e3}).then((function(){var e=n();return o.renewWhile({interval:2500,release:!0},e),e}),(function(n){throw e._protected.Helper.error(t,"cannot enter synchronized section",n),n}))};e._protected.JsonSyncInstallationCustom.getInstallationCustomPropertiesForUser=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.JsonSyncInstallationCustom.getInstallationCustomPropertiesForUser",(function(t){return e.instantiationPromise.then((function(){return n((function(){return o(t).then((function(e){return e.getSdkState()}))}))}))})),e._protected.JsonSyncInstallationCustom.putInstallationCustomPropertiesForUser=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.JsonSyncInstallationCustom.putInstallationCustomPropertiesForUser",(function(t,r){return e.instantiationPromise.then((function(){return n((function(){return o(t).then((function(e){return e.put(r)}))}))}))})),e._protected.JsonSyncInstallationCustom.receiveDiffForUser=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.JsonSyncInstallationCustom.receiveDiffForUser",(function(t,r){return e.instantiationPromise.then((function(){return n((function(){return o(t).then((function(e){return e.receiveDiff(r)}))}))}))})),e._protected.JsonSyncInstallationCustom.receiveStateForUser=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.JsonSyncInstallationCustom.receiveStateForUser",(function(t,r,i){return e.instantiationPromise.then((function(){return n((function(){return o(t).then((function(e){return e.receiveState(r,i)}))}))}))})),e._protected.JsonSyncInstallationCustom.receiveServerStateForUser=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.JsonSyncInstallationCustom.receiveServerStateForUser",(function(t,r){return e.instantiationPromise.then((function(){return n((function(){return o(t).then((function(e){return e.receiveServerState(r)}))}))}))})),e._protected.JsonSyncInstallationCustom.deleteForUser=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.JsonSyncInstallationCustom.deleteForUser",(function(t){return e.instantiationPromise.then((function(){return n((function(){return r(t)}))}))}));var o=function(t){return t=t||"",e._protected.Storage.get(e._protected.Constants.PER_USER_INSTALLATION_CUSTOM_PROPERTIES_STORAGE_KEY,{}).then((function(n){return new e._protected.JsonSyncInstallationCustom(t,n[t]||null).ready()}))},r=function(t){return t=t||"",e._protected.Storage.bulk([{test:{key:e._protected.Constants.PER_USER_INSTALLATION_CUSTOM_PROPERTIES_STORAGE_KEY,defaultValue:{},operationsCb:function(n){return delete n[t],[{put:{key:e._protected.Constants.PER_USER_INSTALLATION_CUSTOM_PROPERTIES_STORAGE_KEY,value:n}}]}}}]).then((function(){}))},i=function(t){e._protected.Promise.catchNoop(n((function(){return o(t).then((function(e){return e.callPatch_onSuccess()})).then((function(){}))})))},a=function(t){e._protected.Promise.catchNoop(n((function(){return o(t).then((function(e){return e.callPatch_onFailure()})).then((function(){}))})))},s=null,c=function(){null===s&&e._protected.RunModes.Behaviors.AccessToken&&e._protected.Integration.isOnRightDomain()&&n((function(){return e._protected.Storage.get(e._protected.Constants.PER_USER_INSTALLATION_CUSTOM_PROPERTIES_STORAGE_KEY,{}).then((function(n){Promise.all(Object.keys(n).map((function(o){return new e._protected.JsonSyncInstallationCustom(o||"",n[o]).ready().catch((function(n){e._protected.Helper.error(t,"Failed to initialize JsonSyncInstallationCustom for user",o,":",n)}))})))}))})).catch((function(n){e._protected.Helper.error(t,"Periodic check rejected with",n)})).then((function(){var t=Math.round(e._protected.Constants.REQUEST_VAULT_IDLE_WAIT_MS*(1+.2*Math.random()));s=setTimeout((function(){s=null,c()}),t)}))};Promise.all([e._protected.Locking.getModuleInitializationPromise(),e._protected.Config.getModuleInitializationPromise()]).then((function(){e._protected.RunModes.Behaviors.AccessToken&&e._protected.Integration.isOnRightDomain()&&(e.prototype.getInitializationPromise().then((function(){return e._protected.Storage.get(e._protected.Constants.PER_USER_INSTALLATION_CUSTOM_PROPERTIES_STORAGE_KEY,null)})).then((function(t){var r=e._protected.Options.getUserId();if(!((r||"")in(t||{})))return n((function(){return o(r).then((function(t){return function(t){return e.preInstantiationPromise.then((function(){var n=new e._protected.Promise.Deferred,o=function(){n.reject()},r={onload:function(e){var t=e&&e.json&&e.json()||this.responseJSON;n.resolve(t&&t.custom||{})},onerror:o,ontimeout:o,onabort:o};return e._protected.Rest.get(t,"/installation",{},r,{}),n.promise}))}(r).then((function(e){t.receiveState(e,!1)}))}))}))})),e._protected.Locking.getModuleInitializationPromise().then((function(){c()})))}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){var t="[data        ]";e._protected.Data=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Data",new function(){this.exportAsBlob=function(){var t=[],n=function(e){t.push(JSON.stringify(e)),t.push("\n")};return Promise.all([e._protected.Storage.listObjectStores().then((function(t){return Promise.all(t.map((function(t){return e._protected.Storage.listKeyValuePairs(t).then((function(e){n({indexedDbStoreKeyValuePairs:{[t]:e}})}))})))})),e._protected.Session.listUsedUserIds().then((function(t){return Promise.all(t.map((function(t){return function(t){var o=e._protected.Rest.fetchJson(t,"GET","/authentication/accessToken",{},void 0).then((function(e){return{accessToken:e}})).then(n),r=(null==t||""===t?Promise.resolve(null):e._protected.Rest.fetchJson(t,"GET","/user",{},void 0)).then((function(e){return{user:e}})).then(n),i=e._protected.Rest.fetchJson(t,"GET","/installation",{},void 0).then((function(e){return{installation:e}})).then(n),a=function(o){return function(n){var o=n?e._protected.Helper.decodeQueryString(new URL(n).search):{limit:1e3};return e._protected.Rest.fetchJson(t,"GET","/events",o,void 0)}(o).then((function(e){n({eventsPage:e.data||[]});var t=(e.pagination||{}).next;if(t)return a(t)}))};return Promise.all([o,i,r,a(void 0)])}(t)})))}))]).then((function(){return new Blob(t,{type:"application/json"})}))},this.downloadExport=function(){return Promise.all([e.this.getUserId(),e.this.getInstallationId(),e._protected.Data.exportAsBlob()]).then((function(e){var t=e[0],n=e[1],o=e[2];null!=t||(t="");var r=document.createElement("a");r.href=window.URL.createObjectURL(o),r.download="wonderpush-web-dataexport-"+encodeURIComponent(t).replace("-","%2D")+"-"+encodeURIComponent(n).replace("-","%2D")+"-"+(new Date).toISOString()+".json",document.body.appendChild(r),r.click(),document.body.removeChild(r)})).then((function(){}))},this.clearEventsHistory=function(t){return e._protected.Rest.fetchJson(t,"DELETE","/events",{},void 0).then((function(){}))},this.clearPreferences=function(t){e._protected.JsonSyncInstallationCustom.getInstallationCustomPropertiesForUser(t).then((function(n){return Object.keys(n).forEach((function(e){n[e]=null})),Promise.all([e._protected.JsonSyncInstallationCustom.putInstallationCustomPropertiesForUser(t,n),t?e._protected.Rest.fetchJson(t,"PUT","/user",{body:JSON.stringify({custom:null})},void 0):Promise.resolve()])})).then((function(){}))},this.clearInstallation=function(n){return e._protected.Rest.fetchJson(n,"DELETE","/installation",{},void 0).catch((function(o){e._protected.Helper.error(t,"Failed to delete installation for userId",n,":",o),e._protected.Helper.info(t,"Continuing cleanup anyway")})).then((function(){return Promise.all([e._protected.Session.deleteSession(n),e._protected.JsonSyncInstallationCustom.deleteForUser(n)])})).then((function(){}))},this.clearAllLocalStorage=function(){const t=e._protected.Storage.getKeyValueStorageStoreName();return e._protected.Storage.listKeyValuePairs(t).then((function(t){e._protected.Storage.bulk(t.map((function(e){return{delete:{key:e[0]}}})))}))}}),e.prototype.Data=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK.prototype.Data",new function(){this.exportAsBlob=function(){return e._protected.Data.exportAsBlob()},this.downloadExport=function(){return e._protected.Data.downloadExport()},this.clearEventsHistory=function(){return e._protected.Session.listUsedUserIds().then((function(t){return Promise.all(t.map((function(t){return e._protected.Data.clearEventsHistory(t)})))})).then(()=>{})},this.clearPreferences=function(){return e._protected.Session.listUsedUserIds().then((function(t){return Promise.all(t.map((function(t){return e._protected.Data.clearPreferences(t)})))})).then(()=>{})},this.clearAll=function(){return e._protected.Session.listUsedUserIds().then((function(t){return Promise.all(t.map((function(t){return e._protected.Data.clearInstallation(t)}))).then((function(){return e._protected.Data.clearAllLocalStorage()}))})).then(()=>{})}})}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){if(e._protected.RunModes.Behaviors.ContextWindow){var t,n,o,r="[ui          ]",i=[],a={},s=(t=e._protected.sdkName.toLowerCase(),(o=(n=document.querySelector('HEAD>META[name="'+t+'-integration"]'))?(n.content||n.getAttribute("content")).trim().split(/\s*,\s*/):[]).indexOf("frame")<0&&o.indexOf("popup")<0),c=function(t,n){s||window.postMessage({type:"display",sdk:e._protected.sdkName,[t]:n},window.location.origin)},p=c.bind(null,"text-content");c.bind(null,"main-content"),c.bind(null,"whole-content"),a.clear=function(){p("")},a.close=function(){p("You can now close the window."),window.close()},a.wait=function(e){return new Promise((function(t){setTimeout((function(){t()}),e.ms||1e3)}))},a.reload=function(){p("Reloading");var t=new URL(window.location.href),n=e._protected.Helper.decodeQueryString(location.search);delete n.wonderpushUi,delete n.wonderpushUI,n.wonderpushUI=u(),t.search="",Object.keys(n).forEach((function(e){t.search+=(t.search?"&":"?")+encodeURIComponent(e)+(null===n[e]?"":"="+encodeURIComponent(n[e]))})),e._protected.Helper.info(r,"[reload] Navigating to",t.href),window.location.href=t.href},a.downloadDataExport=function(){return p("Gathering data for export"),e.this.Data.downloadExport().then((function(){p("See downloaded file.")}),(function(e){throw p("An error occurred"),e}))},a.clearEventsHistory=function(){return p("Clearing all events"),e.this.Data.clearEventsHistory().then((function(){p("All events are cleared.")}),(function(e){throw p("An error occurred"),e}))},a.clearPreferences=function(){return p("Clearing preferences"),e.this.Data.clearPreferences().then((function(){p("Preferences are cleared.")}),(function(e){throw p("An error occurred"),e}))},a.clearAllData=function(){return p("Clearing all local and server-side data"),e.this.Data.clearAll().then((function(){p("All local and server-side data is cleared.")}),(function(e){throw p("An error occurred"),e}))},a.optIn=function(){return p("Opt-in you in"),e.this.setNotificationEnabled(!0).then((function(){p("You are now opted in.")}),(function(e){throw p("An error occurred"),e}))},a.optOut=function(){return p("Opt-in you out"),e.this.setNotificationEnabled(!1).then((function(){p("You are now opted out.")}),(function(e){throw p("An error occurred"),e}))},a.addTag=function(){const t=window.location.search.split(/[\?&]/);let n=[];for(const o of t){if(!o)continue;const t=o.split("="),r=t[0];"wonderpushOptIn"===r&&e.this.subscribeToNotifications(),"tag"===r&&decodeURIComponent(t[1]||"").split(",").forEach(e=>{e&&n.push(e)})}e.this.addTag(n),p("Added "+n.length+" tag"+(1===n.length?"":"s")+": "+n.join(", "))},a.invalidateConfig=function(){return p("Invalidating cached configuration"),e.this.Developer.invalidateConfig().then((function(){p("Cached configuration now invalidated")}),(function(e){throw p("An error occurred"),e}))},a.copyInstallationId=function(){e.prototype.getInstallationId().then(t=>{const n=document.createElement("div");n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.right="0",n.style.bottom="0",n.style.display="flex",n.style.flexDirection="column",n.style.alignItems="center",n.style.background="white",n.style.justifyContent="center",n.style.font="13px arial";const o=e=>{const t=document.createElement("input");t.type="text",t.value=e,t.style.border="none",t.style.background="transparent",t.style.width="100%",t.style.textAlign="center",n.appendChild(t);const o=document.createElement("button");o.addEventListener("click",()=>{t.focus(),t.select(),document.execCommand("copy"),t.blur(),r.style.display="inline"}),o.textContent="Copy to clipboard",o.style.marginTop="10px",n.appendChild(o);const r=document.createElement("span");r.textContent="Copied!",r.style.display="none",n.appendChild(r)};if(t)o(t);else{const t=document.createElement("span");t.textContent="You do not have an Installation ID. Please make sure you have subscribed to push notifications.";const r=document.createElement("button");r.textContent="Subscribe to notifications",r.addEventListener("click",t=>{e.prototype.subscribeToNotifications(t).then(()=>e.prototype.getInstallationId()).then(e=>{n.innerHTML="",e?o(e):n.innerText="An error occurred, please try again."})}),n.appendChild(t),n.appendChild(r)}(document.getElementById("main-content")||document.body).appendChild(n)})};var u=function(){return i.map((function(e){return e.originalCall})).join(";")},d=function(){var e=i.shift();return void 0===e?Promise.resolve():Promise.resolve(e()).then(d)};WonderPush.ready((function(){var t=e._protected.Helper.decodeQueryString(location.search),n=t.wonderpushUI||t.wonderpushUi;(i=(n||"").split(";").map((function(t){var n=t.split("?");n.length>2&&n.push(n.splice(1).join("?"));var o=n[0],i=e._protected.Helper.decodeQueryString(n[1]);if(!a.hasOwnProperty(o))return null;var s=function(){return e._protected.Helper.info(r,"Launching UI",o,i,""),Promise.resolve(a[o](i)).then((function(){e._protected.Helper.info(r,"Launching UI",o,"done")}),(function(t){e._protected.Helper.info(r,"Launching UI",o,"failed:",t)}))};return s.originalCall=t,s})).filter((function(e){return e instanceof Function}))).length&&i.unshift(a.clear.bind(null,{})),d()}))}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o,r;o=[n(89)],void 0===(r=function(e){return function(t){var n,o="[plugins     ]",r={},i={},a={},s={},c={};t.prototype.Plugins=new function(){this.get=function(e){return t._protected.Plugins.get(e)},this.getVersion=function(e){return t._protected.Plugins.getVersion(e)}};var p=function(e){this.getLocales=function(){return t._protected.Helper.getLocales()},this.Storage=new function(){this.get=t._protected.Plugins.pluginStorageGet.bind(null,e.name),this.set=t._protected.Plugins.pluginStorageSet.bind(null,e.name)},this.loadStylesheet=function(){if(window)for(var t=new URL(".",e.url),n=0;n<arguments.length;n++){var o=arguments[n];if(o){var r=new URL(o,t);if(!o.match(/^https?\:/)&&r.href.startsWith(t.href)){var i=window.document.createElement("link");i.rel="stylesheet",i.href=r.href,window.document.head.appendChild(i)}else this.logError("Invalid stylesheet: stylesheets must be relative to the plugin file.")}}else this.logError("No window to add stylesheet to.")}.bind(this),this.logTrace=t._protected.Helper.trace.bind(null,"[plugin      ]","["+e.name+"]"),this.logDebug=t._protected.Helper.debug.bind(null,"[plugin      ]","["+e.name+"]"),this.log=t._protected.Helper.log.bind(null,"[plugin      ]","["+e.name+"]"),this.logInfo=t._protected.Helper.info.bind(null,"[plugin      ]","["+e.name+"]"),this.logWarn=t._protected.Helper.warn.bind(null,"[plugin      ]","["+e.name+"]"),this.logError=t._protected.Helper.error.bind(null,"[plugin      ]","["+e.name+"]"),this.checkTriggers=function(e,n,o){n=n||function(){},o=o||function(){},t._protected.Plugins.checkTriggersForPlugin(this,e).then(e=>{e?n():o()})}.bind(this),this.waitTriggers=function(e){return t._protected.Plugins.checkTriggersForPlugin(this,e).then(n=>n?Promise.resolve():t._protected.Plugins.registerTriggersCheck(this,e))}.bind(this),this.resetTriggers=function(){return Promise.all([this.getAttendance(),this.Storage.get("_triggersInfo")]).then(function(e){var t=e[0],n=e[1]._triggersInfo||{};return n.resetDate=(new Date).getTime(),n.resetVisits=t.visitCount,n.resetPages=t.pageViews,this.Storage.set("_triggersInfo",n).then((function(){}))}.bind(this))}.bind(this),this.snoozeTriggers=function(e){return"number"==typeof e&&(e+=(new Date).getTime()),this.Storage.get("_triggersInfo").then(function(t){var n=t._triggersInfo||{};return n.snoozeUntilDate=e,this.Storage.set("_triggersInfo",n).then((function(){}))}.bind(this))}.bind(this)};p.prototype=new t.constructor,t._protected.Plugins=new function(){var p=function(e,n){this.key=e,this.options=n;var o=e.match(/^([-_a-zA-Z0-9]+)(?::(\d+(?:\.\d+(?:\.\d+)?)?))?$/);if(o){var r=[];this.name=o[1],o[2]?(r=o[2].split(".").map((function(e){return""+parseInt(e)})),this.version=r.join(".")):(this.version="latest",r=[this.version]),3===r.length?this.url=new URL(t._protected.Constants.PLUGIN_ROOT_URL+this.name+"/"+this.version+"/"+this.name+".js"):this.url=new URL(t._protected.Constants.PLUGIN_ROOT_URL+this.name+"/"+this.version)}else{var i;try{i=new URL(e.endsWith(".js")?e:e+".js")}catch(n){throw Error('Invalid plugin name (allowed characters: a-z, A-Z, 0-9, "-", "_") or version (3 dot-separated digits): '+e)}if(i.pathname.endsWith("/"))throw Error("Invalid plugin URL (should end with the name of your plugin, not /): "+e);if("https:"!==i.protocol)throw Error("Invalid plugin URL (HTTP is not supported, please use HTTPS): "+e);this.name=i.pathname.replace(/^(?:.*\/)?([^\/]*?)(?:\.js)?$/,"$1"),this.url=i,this.version=i}this.resolveVersion=function(){if("string"!=typeof this.version||3===this.version.split(".").length)return Promise.resolve(this);var e=this;return new Promise((function(n,o){var r=function(t){(t&&t.text?t.text():Promise.resolve("string"==typeof t?t:this.responseText)).then((function(t){t=t.trim(),n(new p(e.name+":"+t,e.options))}))},i=function(n){console.error("Failed to resolve full version for plugin "+e.name+":"+e.version,n),o(new t.prototype.Errors.InternalError("Failed to resolve full version for plugin "+e.name+":"+e.version))};const a=c&&c[e.name],s=a&&a.shortVersions,u=s&&s[e.version];u?r(u):t._protected.Request.request("GET",e.url.href,null,null,null,{onload:r,onerror:i,ontimeout:i,onabort:i})}))}.bind(this)};n=function(){e(t);t._protected.Blocker.category("ready").add("plugin");var n=[t._protected.Config,t._protected.Integration];Promise.all(n.map((function(e){return e.getModuleInitializationPromise()}))).then((function(){!function(){c=t._protected.Config.getPluginsRegistry(),Object.keys(s).forEach(e=>{const n=s[e].loaderByVersion||{};Object.keys(n).forEach(n=>{const o=n.split("."),r=o[0],i=`${o[0]}.${o[1]}`;e in c||(c[e]={}),c[e].shortVersions||(c[e].shortVersions={}),["latest",r,i].forEach(o=>{const r=c[e].shortVersions[o];(!r||t._protected.Helper.compareVersions(n,r)>0)&&(c[e].shortVersions[o]=n)})})});var e,n,a=function(e){var n={"optin-switch":{switchElementId:e.switchElementId||t._protected.Constants.SUBSCRIPTION_SWITCH_ELEMENT_ID_DEFAULT},"tag-switch":{}};if("visits"===e.mode?n["optin-dialog"]={triggers:{minVisits:void 0!==e.minVisits?e.minVisits:t._protected.Constants.SUBSCRIPTION_MIN_VISITS_DEFAULT}}:"pages"===e.mode?n["optin-dialog"]={triggers:{minPages:void 0!==e.minPages?e.minPages:t._protected.Constants.SUBSCRIPTION_MIN_PAGES_DEFAULT}}:"direct"===e.mode&&(n["optin-dialog"]={triggers:{}}),n["optin-dialog"]&&n["optin-dialog"].triggers){n["optin-dialog"].triggers.delay=void 0!==e.delay?e.delay:t._protected.Constants.SUBSCRIPTION_DELAY_DEFAULT,n["optin-dialog"].triggers.snooze=void 0!==e.snooze?e.snooze:t._protected.Constants.SUBSCRIPTION_SNOOZE_DEFAULT;var o=t.prototype.Notification.getOptInOptions();o&&"Recevez dsormais nos news en temps rel.<br/>Vous pouvez vous dsinscrire  n'importe quel moment."===o.modalBoxMessage&&(n["optin-dialog"].title="Voulez-vous recevoir nos news en temps rel ?",n["optin-dialog"].message="Vous pouvez vous dsinscrire  n'importe quel moment.",n["optin-dialog"].positiveButton="S'enregistrer",n["optin-dialog"].negativeButton="Plus tard")}return n}(t._protected.Options.getSubscriptionOptions()),d=t._protected.Options.getPlugins();if(t._protected.RunModes.Behaviors.ContextWindow?e=function(e){var t=document.createElement("script");t.src=e.url,t.charset="utf-8",document.body.appendChild(t)}:t._protected.RunModes.Behaviors.ContextServiceWorker,e){const t=e;e=function(e){const n=s[e.name],o=n&&n.loaderByVersion,r=o&&o[e.version];r?r():t(e)}}for(var l in e&&t._protected.RunModes.Behaviors.Plugins||(e=function(e){f[e.name].resolve()},d={},a={}),WonderPush.registerPlugin=function(e,n){var o,i;"function"==typeof n?o=n:"object"==typeof n&&("function"==typeof n.window&&(o=n.window),"function"==typeof n.serviceWorker&&(i=n.serviceWorker)),t._protected.RunModes.Behaviors.ModeWebSite?r[e]=o:t._protected.RunModes.Behaviors.ModeServiceWorker&&(r[e]=i);var a=f[e];a&&a.resolve()},i=u(d),a)l in i||(n=new p(l,a[l]),i[n.name]=n);!function(e){const n=[{initOption:"subscriptionNative",pluginName:"optin-automatic"},{initOption:"subscriptionDialog",pluginName:"optin-dialog"},{initOption:"subscriptionBell",pluginName:"optin-bell"},{initOption:"subscriptionSwitch",pluginName:"optin-switch",defaultValue:{}}];for(const o of n){let n=e[o.pluginName],r=t._protected.Options.get(o.initOption);void 0===r&&(r=o.defaultValue),void 0!==r&&(n||(e[(n=new p(o.pluginName)).name]=n),n.options=r)}}(i);var f={};Object.keys(i).forEach((function(n){try{var r=i[n];f[r.name]=new t._protected.Promise.Deferred,r.options?r.resolveVersion().then((function(t){i[t.name]=t,e(t)}),(function(e){console.error("Cannot load plugin "+r.name+" at "+r.url.href,e)})):f[r.name].resolve()}catch(e){t._protected.Helper.error(o,e.message)}})),Promise.all(Object.keys(f).map((function(e){return f[e].promise}))).then((function(){delete WonderPush.registerPlugin,t._protected.Blocker.category("ready").remove("plugin")}))}()}))};var u=function(e){var n={};for(var r in e)if(e.hasOwnProperty(r))try{var a=new p(r,e[r]);if(a.name in i){t._protected.Helper.error(o,"Multiple plugin versions specified for "+a.name),t._protected.Helper.error(o,"We had "+i[a.name].version+" and saw "+a.version),console.error(new t.prototype.Errors.PluginError("Multiple plugin versions specified for "+a.name));continue}n[a.name]=a}catch(e){t._protected.Helper.error(o,e.message)}return n};this.mergeOptionsPlugins=function(e,n){for(var o=[{}],r=0;r<arguments.length;r++)o.push(u(arguments[r]||{}));return function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];t[o.key]=o.options}return t}(t._protected.Helper.assign.apply(null,o))},this.get=function(e){return a[e]},this.getVersion=function(e){var t=(i[e]||{}).version;return t instanceof URL&&(t=new URL(t.href)),t},this.pluginStorageGet=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Plugins.pluginStorageGet",(function(e){var n=Array.prototype.slice.call(arguments);return n.shift(),t._protected.Storage.get("pluginsStorage:"+e,{}).then((function(e){var t={};return n.forEach((function(n){t[n]=e[n]})),t}))})),this.pluginStorageSet=t._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.Plugins.pluginStorageSet",(function(e){var n;return 3!==arguments.length||arguments[1]instanceof Object?n=arguments[1]:(n={})[arguments[1]]=arguments[2],t._protected.Storage.bulk([{test:{key:"pluginsStorage:"+e,defaultValue:{},operationsCb:function(o){return t._protected.Helper.assign(o,n),[{put:{key:"pluginsStorage:"+e,value:o}}]}}}]).then((function(){}))})),this.preregisterInlinedPlugin=function(e,t,n){s[e]||(s[e]={loaderByVersion:{}}),s[e].loaderByVersion[t]=n};var d=[];this.registerTriggersCheck=function(e,n){const o=new function(e,n){this.pluginSdk=e,this.config=n,this.resolve=void 0,this.removable=!1,this.promise=new Promise(e=>{this.resolve=e});var o=()=>{this.resolve&&(this.pluginSdk.logDebug("[checkTriggers] finally passed, resolving promise"),this.resolve(),this.resolve=void 0),this.removable=!0};this.runCheck=()=>t._protected.Plugins.checkTriggersForPlugin(this.pluginSdk,this.config).then(e=>(e&&o(),e))}(e,n);return d.push(o),o.promise},this.runRegisteredTriggersCheck=function(){return Promise.all(d.map(e=>e.runCheck())).then(()=>{d=d.filter(e=>!e.removable)})},this.checkTriggersForPlugin=function(e,n){e.logDebug("[checkTriggers] config =",n),n?!0===n?n={}:(n.autoReset=null==n.autoReset||n.autoReset,n.delay=null!=n.delay?n.delay:0,n.snooze=null!=n.snooze?n.snooze:432e5):n={manual:!0};var o=null,r=null,i=null,a=t.prototype.getAttendance().then((function(e){o=e})),s=e.Storage.get("_triggersInfo").then((function(e){r=e._triggersInfo||{}})),c=t._protected.Integration.callOnCustomDomain("WonderPushSDK._protected.Notification.getTrustedOrCachedNotificationPermissionState").then((function(e){i=e===t._protected.Notification.PERMISSION_DENIED}));return Promise.all([a,s,c]).then((function(){var a=!0;t._protected.Notification.isAllowedSubscriptionDomain(window.location.origin)||(e.logDebug("[checkTriggers] rejects (allowedSubscriptionDomains)",{domain:window.location.origin,allowed:t._protected.Options.getAllowedSubscriptionDomains()}),a=!1),i&&(e.logDebug("[checkTriggers] rejects (permission)",{permissionDenied:i}),a=!1);var s=t.prototype.Notification.getSubscriptionState();return s!==t.prototype.SubscriptionState.NOT_SUBSCRIBED&&(e.logDebug("[checkTriggers] rejects (subscription state)",{subscriptionState:s}),a=!1),n.manual&&(e.logDebug("[checkTriggers] rejects (manual)",{manual:n.manual}),a=!1),(!0===r.snoozeUntilDate||"number"==typeof r.snoozeUntilDate&&r.snoozeUntilDate>(new Date).getTime())&&(e.logDebug("[checkTriggers] rejects (snoozeUntilDate)",{snoozeUntilDate:r.snoozeUntilDate}),a=!1),n.snooze&&r.resetDate&&r.resetDate+n.snooze>(new Date).getTime()&&(e.logDebug("[checkTriggers] rejects (snooze)",{snooze:n.snooze,resetDate:r.resetDate}),a=!1),n.minVisits&&o.visitCount<n.minVisits&&(e.logDebug("[checkTriggers] rejects (visits < minVisits)",{visits:o.visitCount,minVisits:n.minVisits}),a=!1),n.minVisitsSinceReset&&r.resetVisits&&o.visitCount-r.resetVisits<n.minVisitsSinceReset&&(e.logDebug("[checkTriggers] rejects (visitsSinceReset < minVisitsSinceReset)",{visitsSinceReset:o.visitCount-r.resetVisits,minVisitsSinceReset:n.minVisitsSinceReset}),a=!1),n.minPages&&o.pageViews<n.minPages&&(e.logDebug("[checkTriggers] rejects (pages < minPages)",{pages:o.pageViews,minPages:n.minPages}),a=!1),n.minPagesSinceReset&&r.resetPages&&o.pageViews-r.resetPages<n.minPagesSinceReset&&(e.logDebug("[checkTriggers] rejects (pagesSinceReset < minPagesSinceReset)",{pagesSinceReset:o.pageViews-r.resetPages,minPagesSinceReset:n.minPagesSinceReset}),a=!1),n.minVisitPages&&o.visitPageViews<n.minVisitPages&&(e.logDebug("[checkTriggers] rejects (visitPages < minVisitPages)",{visitPages:o.visitPageViews,minVisitPages:n.minVisitPages}),a=!1),e.logDebug("[checkTriggers]",a?"passed":"rejected"),a}),(function(t){return e.logError("[checkTriggers] failed to check",t),!1})).then(e=>t._protected.Promise.delay(Promise.resolve(e),e&&n.delay&&n.delay>0?n.delay:0)).then(t=>(t&&n.autoReset&&e.resetTriggers(),t))}},n(),t.preInstantiationPromise.then((function(){t._protected.Init.addWillBecomeReadyCallback((function(){Object.keys(i).forEach((function(e){var t=r[e];if(t){var n=i[e];a[e]=new t(new p(n),n.options),delete r[e]}}))}))}))}}.apply(t,o))||(e.exports=r)},function(e,t,n){var o,r;o=[n(90),n(91),n(92),n(93),n(94)],void 0===(r=function(){var e=Array.prototype.slice.call(arguments);return function(t){e.forEach(e=>e(t))}}.apply(t,o))||(e.exports=r)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Plugins.preregisterInlinedPlugin("optin-automatic","1.0.1",(function(){WonderPush.registerPlugin("optin-automatic",(function(e,t){e.waitTriggers?e.waitTriggers(t.triggers).then((function(){e.subscribeToNotifications()})):e.checkTriggers(t.triggers,(function(){e.subscribeToNotifications()}))}))}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Plugins.preregisterInlinedPlugin("optin-dialog","1.3.11",(function(){WonderPush.registerPlugin("optin-dialog",(function(e,t){if(!e.isNativePushNotificationSupported())return{showDialog:function(){},hideDialog:function(){}};function n(e){return r.hasOwnProperty(i)&&r[i][e]?r[i][e]:e}var o,r={fr:{"Would you like to subscribe to push notifications?":"Souhaitez-vous vous inscrire aux notifications?","You can always unsubscribe at any time.":"Vous pouvez vous dsinscrire  tout moment.",Subscribe:"Je m'inscris",Later:"Plus tard","Web push by WonderPush":"Push web par WonderPush"},es:{"Would you like to subscribe to push notifications?":"Desea suscribirse a las notificaciones push?","You can always unsubscribe at any time.":"Siempre puede darse de baja en cualquier momento",Subscribe:"Me suscribo",Later:"Ms tarde","Web push by WonderPush":"Push web por WonderPush"},it:{"Would you like to subscribe to push notifications?":"Vuoi iscriverti alle notifiche push?","You can always unsubscribe at any time.":"Puoi annullare l'iscrizione in qualsiasi momento",Subscribe:"Mi iscrivo",Later:"Pi tardi","Web push by WonderPush":"Push web di WonderPush"},de:{"Would you like to subscribe to push notifications?":"Mchten Sie Push-Benachrichtigungen abonnieren?","You can always unsubscribe at any time.":"Sie knnen sich jederzeit abmelden.",Subscribe:"Register",Later:"Spter","Web push by WonderPush":"Web push von WonderPush"},pt:{"Would you like to subscribe to push notifications?":"Deseja se inscrever para receber notificaes?","You can always unsubscribe at any time.":"Voc pode cancelar a qualquer momento.",Subscribe:"Register",Later:"Mais tarde","Web push by WonderPush":"Push web da WonderPush"},nl:{"Would you like to subscribe to push notifications?":"Wilt u zich abonneren op pushmeldingen?","You can always unsubscribe at any time.":"U kunt zich altijd op elk gewenst moment afmelden.",Subscribe:"Abonneren",Later:"Later"},pl:{"Would you like to subscribe to push notifications?":"Czy chcesz subskrybowa powiadomienia push?","You can always unsubscribe at any time.":"Zawsze moesz zrezygnowa z subskrypcji w dowolnym momencie.",Subscribe:"Subskrybuj",Later:"Pniej"}},i=(e.getLocales&&e.getLocales()||[]).map((function(e){return e.split(/[-_]/)[0]}))[0]||(navigator.language||"").split("-")[0],a=void 0!==t.title?t.title:n("Would you like to subscribe to push notifications?"),s=void 0!==t.message?t.message:n("You can always unsubscribe at any time."),c=t.positiveButton||n("Subscribe"),p=t.negativeButton||n("Later"),u=t.style,d=void 0!==t.icon?t.icon:e.getNotificationIcon(),l=!!t.hidePoweredBy,f=void 0!==t.closeSnooze&&t.closeSnooze,g=void 0!==t.negativeSnooze?t.negativeSnooze:6048e5,h=t.triggers;(o=document.createElement("style")).type="text/css",o.appendChild(document.createTextNode(".wp-optin-dialog-container{z-index:10000;width:420px;max-width:100%;box-sizing:border-box;background-image:linear-gradient(to bottom,#eae9ea,#eeedee);position:fixed;top:0;left:50%;transform:translateX(-50%);padding:15px 20px 10px 20px;border:1px solid #dfdfdf;box-shadow:0 0 20px #888}.wp-optin-dialog-container .wp-optin-dialog-body{display:flex;flex-direction:row}.wp-optin-dialog-container .wp-optin-dialog-icon{flex-shrink:0;flex-basis:64px;width:64px;height:64px;background-size:contain;background-repeat:no-repeat;background-position:50% 50%;margin-right:20px}.wp-optin-dialog-container .wp-optin-dialog-text{display:flex;flex-direction:column;flex-grow:1}.wp-optin-dialog-container .wp-optin-dialog-text .wp-optin-dialog-title{font:bold 16px arial;margin-bottom:15px}.wp-optin-dialog-container .wp-optin-dialog-text .wp-optin-dialog-message{font:12px arial}.wp-optin-dialog-container .wp-optin-dialog-buttons{display:flex;flex-direction:row;margin-top:1em}.wp-optin-dialog-container .wp-optin-dialog-powered-by{flex-grow:1;align-self:flex-end;font:10px arial;color:#333;opacity:.8;background-position:bottom right;background-repeat:no-repeat;text-decoration:none;margin-right:.5em}.wp-optin-dialog-container .wp-optin-dialog-button{flex-grow:1;border-radius:4px;border:1px solid #d3d3d3;background:#fff;text-decoration:none;font:15px arial;color:#333;text-align:center;display:flex;min-width:5em;padding:.25em .5em}.wp-optin-dialog-container .wp-optin-dialog-button label{cursor:inherit;margin:auto}.wp-optin-dialog-container .wp-optin-dialog-button.wp-optin-dialog-positiveButton{border-color:#46a4f3;color:#fff;background-image:linear-gradient(to bottom,#62b3f4,#0486f6);margin-left:.5em}.wp-optin-dialog-container .wp-optin-dialog-close{position:absolute;top:4px;right:4px;width:10px;height:10px;text-decoration:none;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIE1hY2ludG9zaCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1MDVDQUVGMDQzOUIxMUU3ODE2N0YyM0EyNDc4QTZCNyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1MDVDQUVGMTQzOUIxMUU3ODE2N0YyM0EyNDc4QTZCNyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjI4NjdCN0UxNDM5QTExRTc4MTY3RjIzQTI0NzhBNkI3IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjI4NjdCN0UyNDM5QTExRTc4MTY3RjIzQTI0NzhBNkI3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+JRvgJAAAAEdJREFUeNpiYmBgOAPEDP///8eKYfIMuBQiK8CqEEUBVABFIYYJSDoZsCkAyTGhmQhSYIJsNQNON6C5Eacv0K0+Q8iNAAEGAG9QVX0F8yI2AAAAAElFTkSuQmCC);background-size:cover;background-repeat:no-repeat;background-position:50% 50%}")),document.head.appendChild(o);var m,v,_=!1;e.waitTriggers?e.waitTriggers(h).then(function(){this.showDialog()}.bind(this)):e.checkTriggers(h,function(){this.showDialog()}.bind(this)),this.hideDialog=function(){v&&m.dispatchEvent(new Event("wonderpush-webplugin-optin-dialog.hide",{bubbles:!0,cancelable:!0}))&&(v(),_=!1,m=v=void 0)}.bind(this),this.showDialog=function(){var o=this;if(_)e.logDebug("Registration already in progress");else{_=!0;var r="wp-optin-dialog-",i=document.createElement("div");if(i.className=r+"container",t.backgroundColor&&(i.style.backgroundColor=t.backgroundColor,i.style.backgroundImage="none",i.style.borderColor=t.backgroundColor),i.style.color=t.textColor||"black",u)for(var h in u)i.style[h]=u[h];v=function(){i.parentNode.removeChild(i)},m=i;var y=document.createElement("div");if(y.className=r+"body",i.appendChild(y),d){var w=document.createElement("div");w.className=r+"icon",w.style.backgroundImage="url("+d.replace("(","%28").replace(")","%29")+")",y.appendChild(w)}var b=document.createElement("div");if(b.className=r+"text",y.appendChild(b),a){var S=document.createElement("div");S.className=r+"title",S.innerHTML=a,b.appendChild(S)}if(s){var E=document.createElement("div");E.className=r+"message",E.innerHTML=s,b.appendChild(E)}var I=document.createElement("div");if(I.className=r+"buttons",i.appendChild(I),!l){var C=document.createElement("a");C.innerHTML=n("Web push by WonderPush"),C.href="https://docs.wonderpush.com/docs/manage-your-data-and-unsubscribe-from-web-push-notifications",C.className=r+"powered-by",C.setAttribute("title","Web and mobile push notifications"),I.appendChild(C)}var T={positiveButton:{label:c,backgroundColor:t.positiveButtonBackgroundColor||void 0,color:t.positiveButtonTextColor||void 0,click:function(t){t.target.dispatchEvent(new Event("wonderpush-webplugin-optin-dialog.positiveButton.click",{bubbles:!0,cancelable:!0}))&&(e.subscribeToNotifications(t),o.hideDialog())}},negativeButton:{label:p,backgroundColor:t.negativeButtonBackgroundColor||void 0,color:t.negativeButtonTextColor||void 0,click:function(t){void 0!==g&&!1!==g&&e.snoozeTriggers&&e.snoozeTriggers(g),t.target.dispatchEvent(new Event("wonderpush-webplugin-optin-dialog.negativeButton.click",{bubbles:!0,cancelable:!0}))&&o.hideDialog()}}};["negativeButton","positiveButton"].forEach((function(e){var t=document.createElement("a");t.href="#",t.className=r+"button "+r+e,T[e].backgroundColor&&(t.style.backgroundColor=T[e].backgroundColor,t.style.backgroundImage="none",t.style.borderColor=T[e].backgroundColor),T[e].color&&(t.style.color=T[e].color),t.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation(),T[e].click(t)})),I.appendChild(t);var n=document.createElement("label");n.innerHTML=T[e].label,t.appendChild(n)}));var P=document.createElement("a");i.appendChild(P),P.href="#",P.className=r+"close",P.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation(),void 0!==f&&!1!==f&&e.snoozeTriggers&&e.snoozeTriggers(f),t.target.dispatchEvent(new Event("wonderpush-webplugin-optin-dialog.closeButton.click",{bubbles:!0,cancelable:!0}))&&o.hideDialog()})),document.body.dispatchEvent(new Event("wonderpush-webplugin-optin-dialog.show",{bubbles:!0,cancelable:!0}))?document.body.appendChild(i):(_=!1,m=v=void 0)}}.bind(this)}))}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Plugins.preregisterInlinedPlugin("optin-switch","1.0.3",(function(){WonderPush.registerPlugin("optin-switch",(function(e,t){if(!e.isNativePushNotificationSupported())return{setupSubscriptionSwitch:function(){}};var n;(n=document.createElement("style")).type="text/css",n.appendChild(document.createTextNode(".wp-switch{position:relative;display:inline-block;vertical-align:middle;width:auto;height:auto;padding:.2em;border-radius:1.25em;box-shadow:inset 0 -1px rgba(0,0,0,.05),inset 0 1px 1px rgba(0,0,0,.05);cursor:pointer;background-image:linear-gradient(to bottom,rgba(0,0,0,.2),rgba(255,255,255,.3) 1.5em)}.wp-switch-input{display:none}.wp-switch-label{position:relative;display:block;height:2em;font-size:60%;text-transform:uppercase;background:#eceeef;border-radius:inherit;box-shadow:inset 0 1px 2px rgba(0,0,0,.12),inset 0 0 2px rgba(0,0,0,.15);transition:.15s ease-out;transition-property:opacity,background}.wp-switch-label:after,.wp-switch-label:before{line-height:0;clear:both;transition:inherit;white-space:nowrap;display:inline-block}.wp-switch-label:before{content:attr(data-off);right:1em;color:#aaa;text-shadow:0 1px rgba(255,255,255,.5);float:right;margin-top:1em;margin-right:1em;margin-left:2.5em}.wp-switch-label:after{content:attr(data-on);left:1em;color:#fff;text-shadow:0 1px rgba(0,0,0,.2);opacity:0;float:left;margin-top:0;margin-left:1em;margin-right:2.5em}.wp-switch-input:checked~.wp-switch-label{background:#47a8d8;box-shadow:inset 0 1px 2px rgba(0,0,0,.15),inset 0 0 3px rgba(0,0,0,.2)}.wp-switch-input:checked~.wp-switch-label:before{opacity:0}.wp-switch-input:checked~.wp-switch-label:after{opacity:1}.wp-switch-handle{position:absolute;top:.24em;left:.24em;width:1.125em;height:1.125em;background:#fff;border-radius:100%;box-shadow:1px 1px 5px rgba(0,0,0,.2);background-image:linear-gradient(to bottom,#fff 40%,#f0f0f0);transition:.15s ease-out;transition-property:left,margin-left}.wp-switch-handle:before{content:'';position:absolute;top:0;left:0;margin:.1875em 0 0 .1875em;width:.75em;height:.75em;background:#f9f9f9;border-radius:100%;box-shadow:inset 0 1px rgba(0,0,0,.02);background-image:linear-gradient(to bottom,#eee,#fff)}.wp-switch-input:checked~.wp-switch-handle{left:100%;margin-left:-1.365em;box-shadow:-1px 1px 5px rgba(0,0,0,.2)}.wp-switch-input:disabled~.wp-switch-handle{background-image:linear-gradient(to bottom,silver 40%,grey)}.wp-switch-input:disabled~.wp-switch-handle:before{background:#b0b0b0}.wp-switch-input:disabled~.wp-switch-label{background:silver}.wp-switch-input:disabled~.wp-switch-label:before{color:#eee}.wp-switch-off-gray>.wp-switch-label{background:#eceeef}.wp-switch-off-gray>.wp-switch-label:before{color:#aaa;text-shadow:0 1px rgba(255,255,255,.5)}.wp-switch-off-grey>.wp-switch-label{background:#eceeef}.wp-switch-off-grey>.wp-switch-label:before{color:#aaa;text-shadow:0 1px rgba(255,255,255,.5)}.wp-switch-off-red>.wp-switch-label{background:#ed2121}.wp-switch-off-red>.wp-switch-label:before{color:#fff;text-shadow:0 1px rgba(0,0,0,.2)}.wp-switch-on-green>.wp-switch-input:checked~.wp-switch-label{background:#4fb845;text-shadow:0 1px rgba(0,0,0,.2)}.wp-switch-on-blue>.wp-switch-input:checked~.wp-switch-label{background:#47a8d8;text-shadow:0 1px rgba(0,0,0,.2)}")),document.head.appendChild(n);var o=null,r=function(){"loading"!==document.readyState?this.setupSubscriptionSwitch():document.addEventListener("DOMContentLoaded",function(){this.setupSubscriptionSwitch()}.bind(this))}.bind(this);this.setupSubscriptionSwitch=function(){var n,r,c,p,u,d,l,f,g,h,m,v;o||null!==t.switchElementId&&(n=t.switchElementId||"wonderpush-subscription-switch",r=document.querySelectorAll("#"+n),c=t.unsupported||"",p=t.classPrefix||"wp-",u=t.prepend||"",d=t.append||"",l=t.sentence||"",f=t.cssClass||"",g=t.on||"ON",h=t.off||"OFF",m=t.colorOn,v=t.colorOff,Array.prototype.slice.call(r).forEach((function(t){var n,r,_,y,w,b,S;t&&"true"!==t.dataset.wpInitialized&&((o=t).dataset.wpInitialized="true",e.isNativePushNotificationSupported()?(n=t.dataset.classPrefix||p,t.innerHTML=(t.dataset.prepend||u)+'<div class="'+n+'switch-wrapper"></div>'+(t.dataset.append||d),r=t.querySelector("."+n+"switch-wrapper"),(_=document.createElement("SPAN")).innerHTML=t.dataset.sentence||l,(y=document.createElement("LABEL")).classList.add(n+"switch"),y.className+=" "+(t.dataset.class||f),(t.dataset.colorOn||m)&&y.classList.add(n+"switch-on-"+(t.dataset.colorOn||m)),(t.dataset.colorOff||v)&&y.classList.add(n+"switch-off-"+(t.dataset.colorOff||v)),(w=document.createElement("INPUT")).id=t.id+"-input",w.type="checkbox",w.classList.add(n+"switch-input"),y.appendChild(w),(b=document.createElement("SPAN")).classList.add(n+"switch-label"),b.dataset.on=t.dataset.on||g,b.dataset.off=t.dataset.off||h,y.appendChild(b),(S=document.createElement("SPAN")).classList.add(n+"switch-handle"),y.appendChild(S),r.appendChild(_),r.appendChild(y),w.addEventListener("click",i),window.addEventListener("WonderPushEvent",s(w)),a(w,e.Notification.getSubscriptionState())):t.innerHTML=t.dataset.unsupported||c)})))};var i=function(t){var n=t.target.checked;return t.stopPropagation(),t.preventDefault(),e.setNotificationEnabled(n,t),!1},a=function(t,n){switch(n){case e.SubscriptionState.UNSUPPORTED:t.disabled=!0,t.checked=!1;break;case e.SubscriptionState.UNDETERMINED:case e.SubscriptionState.NOT_SUBSCRIBED:case e.SubscriptionState.UNSUBSCRIBED:t.disabled=!1,t.checked=!1;break;case e.SubscriptionState.SUBSCRIBED:t.disabled=!1,t.checked=!0}},s=function(e){return function(t){var n=(t.originalEvent||t).detail||{};"subscription"===n.name&&a(e,n.state)}};r()}))}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Plugins.preregisterInlinedPlugin("optin-bell","1.0.12",(function(){WonderPush.registerPlugin("optin-bell",{window:function(e,t){if(!e.isNativePushNotificationSupported())return{showBell:function(){},hideBell:function(){},updateTexts:function(){},updateDiscretion:function(){}};var n,o={fr:{"Manage Notifications":"Gestion des notifications","Your personal notification data:":"Vos donnes personnelles de notification :","WonderPush fully supports european GDPR":"WonderPush soutient pleinement la RGPD europenne",Clear:"Effacer",Download:"Tlcharger","You've blocked notifications":"Vous avez bloqu les notifications",Unsubscribe:"Dsinscription","You're subscribed to notifications":"Vous tes abonn aux notifications",Subscribe:"Je m'abonne","You are not receiving any notifications":"Vous ne recevez pas de notifications",Loading:"Chargement","Click to subscribe to notifications":"Cliquez pour vous abonner aux notifications","You won't receive more notifications":"Vous ne recevrez plus de notifications","Thanks for subscribing!":"Merci de vous tre abonn !"},es:{"Manage Notifications":"Administrar notificaciones","Your personal notification data:":"Sus datos personales de notificacin :","WonderPush fully supports european GDPR":"WonderPush es totalmente compatible con GDPR europeo",Clear:"Borrar",Download:"Descargar","You've blocked notifications":"Has bloqueado las notificaciones",Unsubscribe:"Darse de baja de las notificaciones","You're subscribed to notifications":"Ests suscrito a notificaciones",Subscribe:"Suscribirse","You are not receiving any notifications":"No est recibiendo ninguna notificacin",Loading:"Cargando","Click to subscribe to notifications":"Haga clic para suscribirse a las notificaciones","You won't receive more notifications":"No recibir ms notificaciones","Thanks for subscribing!":"Gracias por suscribirse!"},it:{"Manage Notifications":"Gestisci notifiche","Your personal notification data:":"I tuoi dati di notifica personali:","WonderPush fully supports european GDPR":"WonderPush supporta pienamente il GDPR europeo",Clear:"Eliminare",Download:"Scaricare","You've blocked notifications":"Notifiche bloccate",Unsubscribe:"Annulla iscrizione","You're subscribed to notifications":"Sei iscritto alle notifiche",Subscribe:"Mi iscrivo","You are not receiving any notifications":"Non ricevi alcuna notifica",Loading:"Carica","Click to subscribe to notifications":"Fai clic per iscriverti alle notifiche","You won't receive more notifications":"Non riceverai pi notifiche","Thanks for subscribing!":"Grazie per esserti iscritto!"},de:{"Manage Notifications":"Benachrichtigungen verwalten","Your personal notification data:":"Ihre persnlichen Benachrichtigungsdaten:","WonderPush fully supports european GDPR":"WonderPush untersttzt die europische GDPR",Clear:"Klar",Download:"Herunterladen","You've blocked notifications":"Sie haben Benachrichtigungen blockiert",Unsubscribe:"Abbestellen","You're subscribed to notifications":"Sie haben Benachrichtigungen abonniert",Subscribe:"Abonnieren","You are not receiving any notifications":"Sie erhalten keine Benachrichtigungen",Loading:"Wird geladen","Click to subscribe to notifications":"Klicken Sie hier, um Benachrichtigungen zu abonnieren","You won't receive more notifications":"Sie erhalten keine Benachrichtigungen mehr","Thanks for subscribing!":"Danke frs Abonnieren!"},pt:{"Manage Notifications":"Gerenciar notificaes","Your personal notification data:":"Os seus dados de notificao pessoal:","WonderPush fully supports european GDPR":"O WonderPush suporta totalmente o GDPR europeu",Clear:"Clear",Download:"Download","You've blocked notifications":"Voc bloqueou as notificaes",Unsubscribe:"Cancelar inscrio","You're subscribed to notifications":"Voc est inscrito nas notificaes",Subscribe:"Inscrever-se","You are not receiving any notifications":"Voc no est recebendo nenhuma notificao",Loading:"Loading","Click to subscribe to notifications":"Clique para assinar as notificaes","You won't receive more notifications":"Voc no receber mais notificaes","Thanks for subscribing!":"Obrigado por se inscrever!"},nl:{"Manage Notifications":"Beheer pushmeldingen","Your personal notification data:":"Uw persoonlijke meldingsgegevens:","WonderPush fully supports european GDPR":"WonderPush ondersteunt de Europese GDPR volledig",Clear:"Clear",Download:"Downloaden","You've blocked notifications":"Je hebt pushmeldingen geblokkeerd",Unsubscribe:"Abonnement opzeggen","You're subscribed to notifications":"U bent aangemeld voor kennisgevingen",Subscribe:"Abonneren","You are not receiving any notifications":"Je ontvangt geen meldingen meer",Loading:"Bezig met laden","Click to subscribe to notifications":"Klik om u te abonneren op meldingen","You won't receive more notifications":"Je ontvangt geen meldingen meer","Thanks for subscribing!":"Bedankt voor het inschrijven!"},pl:{"Manage Notifications":"Zarzdzaj powiadomieniami push","Your personal notification data:":"Twoje osobiste dane powiadomie:","WonderPush fully supports european GDPR":"WonderPush w peni wspiera europejski RODO",Clear:"Wyczy dane",Download:"Pobierz","You've blocked notifications":"Zablokowae powiadomienia",Unsubscribe:"Anuluj subskrypcje","You're subscribed to notifications":"Subskrybujesz powiadomienia",Subscribe:"Subskrybuj","You are not receiving any notifications":"Nie otrzymujesz adnych powiadomie",Loading:"adowanie","Click to subscribe to notifications":"Kliknij, aby zasubskrybowa powiadomienia","You won't receive more notifications":"Nie bdziesz otrzymywa wicej powiadomie","Thanks for subscribing!":"Dziki za subskrypcj!"}},r="wonderpush-",i=(e.getLocales&&e.getLocales()||[]).map((function(e){return e.split(/[-_]/)[0]}))[0]||(navigator.language||"").split("-")[0],a=function(e){return o.hasOwnProperty(i)&&o[i][e]?o[i][e]:e},s=function(e){return new Promise((function(t,n){var o=function(n){e.removeEventListener("transitionend",o),e.removeEventListener("transitioncancel",o),t()};e.addEventListener("transitionend",o),e.addEventListener("transitioncancel",o)}))};(t=t||{}).cssPrefix&&(r=t.cssPrefix),(n=document.createElement("style")).type="text/css",n.appendChild(document.createTextNode(".wonderpush-hidden{display:none!important}.wonderpush-bell{z-index:10000;direction:ltr;color:#333;font:13px arial;position:fixed;bottom:20px;left:20px;display:flex;justify-content:flex-start;align-items:center;height:44px;transition:all .2s ease-in;transform-origin:center}.wonderpush-bell.wonderpush-deactivated{transform:scaleY(0)}.wonderpush-bell a{color:#ff6f61!important;text-decoration:none!important}.wonderpush-bell .wonderpush-collapsed{transform:scale(0)!important;box-shadow:0 0 0 transparent!important}.wonderpush-bell.wonderpush-discrete{height:33px}.wonderpush-bell.wonderpush-discrete .wonderpush-icon-container{border-radius:16.5px;width:33px;opacity:.5}.wonderpush-bell.wonderpush-discrete:hover{height:44px}.wonderpush-bell.wonderpush-discrete:hover .wonderpush-icon-container{border-radius:22px;width:44px;opacity:1}.wonderpush-bell .wonderpush-icon-container{cursor:pointer;transform-origin:center center;transform:scale(1);transition:all .2s ease-in;width:44px;height:100%;border-radius:22px;background:#ff6f61;display:flex;align-items:center;justify-content:center;position:relative}.wonderpush-bell .wonderpush-icon-container .wonderpush-icon{mask-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gU3ZnIFZlY3RvciBJY29ucyA6IGh0dHA6Ly93d3cub25saW5ld2ViZm9udHMuY29tL2ljb24gLS0+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwMCAxMDAwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAxMDAwIDEwMDAiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPG1ldGFkYXRhPiBTdmcgVmVjdG9yIEljb25zIDogaHR0cDovL3d3dy5vbmxpbmV3ZWJmb250cy5jb20vaWNvbiA8L21ldGFkYXRhPg0KPGc+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsNTEyLjAwMDAwMCkgc2NhbGUoMC4xMDAwMDAsLTAuMTAwMDAwKSI+PHBhdGggZD0iTTQ4NTQuMyw1MDAyLjhjLTExMS4yLTQyLjItMTg0LjEtMTAzLjYtMjI2LjMtMTkxLjhjLTM2LjQtNzQuOC00MC4zLTExNy00MC4zLTQyMHYtMzM1LjZsLTE2NC45LTMyLjZjLTI0MS42LTQ3LjktNDMxLjUtMTE1LjEtNjg4LjUtMjM5LjdjLTc5Mi4xLTM4Ny40LTEzNTAuMS0xMTA2LjYtMTU0NS44LTE5OTIuNmMtMzguNC0xNzQuNS00Mi4yLTI2MC44LTU1LjYtMTMzNi43Yy0xMy40LTEwNTIuOS0xNy4zLTExNjYtNTMuNy0xMzM0LjhjLTEyNC43LTU5MC43LTM5Ny0xMDgzLjYtODIwLjgtMTQ5NS45Yy0xODcuOS0xODAuMy0zNTAuOS0zMDYuOC01NTAuNC00MjMuOGwtMTMwLjQtNzQuOGw0Ni04MC41YzI0LjktNDQuMSw4Mi41LTE1MS41LDEyOC41LTIzNy44bDg0LjQtMTU5LjJINTAwMGg0MTYzLjVsODQuNCwxNTkuMmM0Niw4Ni4zLDEwMy42LDE5My43LDEyOC41LDIzNy44bDQ2LDgwLjVsLTEzNC4yLDc4LjZjLTIxOC42LDEyNi42LTQyMS45LDI4OS42LTYyNS4yLDUwMi41Yy0zODEuNywzOTUuMS02MjUuMiw4NjEuMS03NDIuMiwxNDEzLjRjLTM2LjQsMTY4LjgtNDAuMywyODMuOS01My43LDEzMjUuMmMtMTUuMywxMTQ0LjktMTkuMiwxMjA2LjMtOTUuOSwxNTAxLjZjLTI2NC42LDEwMzcuNS0xMTMxLjUsMTg1Ni40LTIxOTUuOSwyMDc1LjFsLTIxMSw0Mi4ybC05LjYsMzUyLjljLTkuNiwzMjcuOS0xMy40LDM1OC42LTUzLjcsNDI1LjdDNTIxMi45LDQ5NzkuNyw1MDAxLjksNTA1Ni41LDQ4NTQuMyw1MDAyLjh6IE00MzM4LjQsMzIxOS4yYzc2LjctMzguNCwxNDAtMTQ1LjgsMTI2LjYtMjIyLjVjLTE1LjMtMTAzLjYtNjEuNC0xNTEuNS0yMTguNi0yMzAuMWMtMzU4LjYtMTgwLjMtNjEzLjctNDM3LjMtNzk3LjgtODAzLjZjLTk5LjctMTk3LjUtMTk1LjYtMjUxLjItMzQ3LjEtMTg4Yy03Mi45LDMwLjctMTI0LjcsMTE1LjEtMTI0LjcsMjAxLjRjMCwxMzguMSwyMTguNiw1MDIuNSw0NDEuMSw3MzguNGMxNzIuNiwxODAuMywzNTguNiwzMjAuMyw1ODQuOSw0MzcuM0M0MTgxLjEsMzI0Niw0MjU1LjksMzI2MS40LDQzMzguNCwzMjE5LjJ6Ii8+PHBhdGggZD0iTTM5MjYtMzgwNy42YzM2LjQtMjY4LjUsMTM4LjEtNDc5LjUsMzE2LjQtNjU3LjhjMjEyLjktMjEyLjksNDU4LjQtMzE0LjUsNzU3LjUtMzE0LjVzNTQ0LjcsMTAxLjcsNzU3LjUsMzE0LjVjMTgwLjMsMTgwLjMsMjgzLjgsMzk1LjEsMzE0LjUsNjU3LjhsMTEuNSw5MC4xSDQ5OTguMUgzOTE0LjVMMzkyNi0zODA3LjZ6Ii8+PC9nPjwvZz4NCjwvc3ZnPg==);-webkit-mask-image:url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gU3ZnIFZlY3RvciBJY29ucyA6IGh0dHA6Ly93d3cub25saW5ld2ViZm9udHMuY29tL2ljb24gLS0+DQo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwMCAxMDAwIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAxMDAwIDEwMDAiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPG1ldGFkYXRhPiBTdmcgVmVjdG9yIEljb25zIDogaHR0cDovL3d3dy5vbmxpbmV3ZWJmb250cy5jb20vaWNvbiA8L21ldGFkYXRhPg0KPGc+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMC4wMDAwMDAsNTEyLjAwMDAwMCkgc2NhbGUoMC4xMDAwMDAsLTAuMTAwMDAwKSI+PHBhdGggZD0iTTQ4NTQuMyw1MDAyLjhjLTExMS4yLTQyLjItMTg0LjEtMTAzLjYtMjI2LjMtMTkxLjhjLTM2LjQtNzQuOC00MC4zLTExNy00MC4zLTQyMHYtMzM1LjZsLTE2NC45LTMyLjZjLTI0MS42LTQ3LjktNDMxLjUtMTE1LjEtNjg4LjUtMjM5LjdjLTc5Mi4xLTM4Ny40LTEzNTAuMS0xMTA2LjYtMTU0NS44LTE5OTIuNmMtMzguNC0xNzQuNS00Mi4yLTI2MC44LTU1LjYtMTMzNi43Yy0xMy40LTEwNTIuOS0xNy4zLTExNjYtNTMuNy0xMzM0LjhjLTEyNC43LTU5MC43LTM5Ny0xMDgzLjYtODIwLjgtMTQ5NS45Yy0xODcuOS0xODAuMy0zNTAuOS0zMDYuOC01NTAuNC00MjMuOGwtMTMwLjQtNzQuOGw0Ni04MC41YzI0LjktNDQuMSw4Mi41LTE1MS41LDEyOC41LTIzNy44bDg0LjQtMTU5LjJINTAwMGg0MTYzLjVsODQuNCwxNTkuMmM0Niw4Ni4zLDEwMy42LDE5My43LDEyOC41LDIzNy44bDQ2LDgwLjVsLTEzNC4yLDc4LjZjLTIxOC42LDEyNi42LTQyMS45LDI4OS42LTYyNS4yLDUwMi41Yy0zODEuNywzOTUuMS02MjUuMiw4NjEuMS03NDIuMiwxNDEzLjRjLTM2LjQsMTY4LjgtNDAuMywyODMuOS01My43LDEzMjUuMmMtMTUuMywxMTQ0LjktMTkuMiwxMjA2LjMtOTUuOSwxNTAxLjZjLTI2NC42LDEwMzcuNS0xMTMxLjUsMTg1Ni40LTIxOTUuOSwyMDc1LjFsLTIxMSw0Mi4ybC05LjYsMzUyLjljLTkuNiwzMjcuOS0xMy40LDM1OC42LTUzLjcsNDI1LjdDNTIxMi45LDQ5NzkuNyw1MDAxLjksNTA1Ni41LDQ4NTQuMyw1MDAyLjh6IE00MzM4LjQsMzIxOS4yYzc2LjctMzguNCwxNDAtMTQ1LjgsMTI2LjYtMjIyLjVjLTE1LjMtMTAzLjYtNjEuNC0xNTEuNS0yMTguNi0yMzAuMWMtMzU4LjYtMTgwLjMtNjEzLjctNDM3LjMtNzk3LjgtODAzLjZjLTk5LjctMTk3LjUtMTk1LjYtMjUxLjItMzQ3LjEtMTg4Yy03Mi45LDMwLjctMTI0LjcsMTE1LjEtMTI0LjcsMjAxLjRjMCwxMzguMSwyMTguNiw1MDIuNSw0NDEuMSw3MzguNGMxNzIuNiwxODAuMywzNTguNiwzMjAuMyw1ODQuOSw0MzcuM0M0MTgxLjEsMzI0Niw0MjU1LjksMzI2MS40LDQzMzguNCwzMjE5LjJ6Ii8+PHBhdGggZD0iTTM5MjYtMzgwNy42YzM2LjQtMjY4LjUsMTM4LjEtNDc5LjUsMzE2LjQtNjU3LjhjMjEyLjktMjEyLjksNDU4LjQtMzE0LjUsNzU3LjUtMzE0LjVzNTQ0LjcsMTAxLjcsNzU3LjUsMzE0LjVjMTgwLjMsMTgwLjMsMjgzLjgsMzk1LjEsMzE0LjUsNjU3LjhsMTEuNSw5MC4xSDQ5OTguMUgzOTE0LjVMMzkyNi0zODA3LjZ6Ii8+PC9nPjwvZz4NCjwvc3ZnPg==);mask-size:contain;-webkit-mask-size:contain;mask-repeat:no-repeat;-webkit-mask-repeat:no-repeat;mask-position:center center;-webkit-mask-position:center center;background:#fff;width:60%;height:60%}.wonderpush-bell .wonderpush-icon-container .wonderpush-icon-badge{transition:transform .2s ease-in-out;transform-origin:center center;transform:scale(1);font-size:.8em;width:1.4em;height:1.4em;display:flex;border-radius:1em;background:#000;border:1px solid #fff;align-items:center;justify-content:center;position:absolute;left:10%;top:10%;color:#fff}.wonderpush-bell .wonderpush-paragraph{transition:transform .2s ease-in-out;transform-origin:left;transform:scale(1);background-color:rgba(0,0,0,.8);color:#fff;font-size:14px;font-family:arial,sans-serif;border-radius:4px;padding:.7em 1em;margin-left:12px;position:relative}.wonderpush-bell .wonderpush-paragraph:after{position:absolute;right:100%;bottom:.77em;border:7px solid transparent;border-right-color:rgba(0,0,0,.8);content:' ';width:0;height:0;box-sizing:border-box}.wonderpush-bell .wonderpush-help{transition:transform .2s ease-in-out;transform-origin:bottom left;transform:scale(1);background-size:contain;border:1px solid #ccc;background-repeat:no-repeat;width:280px;height:200px;position:absolute;left:0;bottom:59px;border-radius:4px;box-shadow:0 0 15px rgba(0,0,0,.4)}.wonderpush-bell .wonderpush-help:after,.wonderpush-bell .wonderpush-help:before{position:absolute;top:100%;left:11px;border:11px solid transparent;border-top-color:#fff;content:' ';width:0;height:0;box-sizing:border-box}.wonderpush-bell .wonderpush-help:before{left:10px;border-width:12px;border-top-color:#ccc}.wonderpush-bell .wonderpush-dialog{transition:transform .2s ease-in-out;transform-origin:bottom left;transform:scale(1);position:absolute;width:max-content;min-width:240px;left:0;bottom:59px;border:1px solid #ccc;border-radius:4px;background:#fff;box-shadow:0 0 15px rgba(0,0,0,.4)}.wonderpush-bell .wonderpush-dialog:after,.wonderpush-bell .wonderpush-dialog:before{position:absolute;top:100%;left:11px;border:11px solid transparent;border-top-color:#fff;content:' ';width:0;height:0;box-sizing:border-box}.wonderpush-bell .wonderpush-dialog:before{left:10px;border-width:12px;border-top-color:#ccc}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-title{color:#333;font-weight:700;text-align:center;font-size:1.1em;padding:1em;border-bottom:1px solid #e0e0e0}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-button-container{margin:10px;display:flex;justify-content:stretch;align-items:center}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-settings-button{width:25px;height:25px;background-color:#aaa;transition:background-color .3s ease-in-out;mask-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDQ4IDQ4Ij4KICAgIDxwYXRoIGQ9Ik0wIDBoNDh2NDhoLTQ4eiIgZmlsbD0ibm9uZSIvPgogICAgPHBhdGggZD0iTTM4Ljg2IDI1Ljk1Yy4wOC0uNjQuMTQtMS4yOS4xNC0xLjk1cy0uMDYtMS4zMS0uMTQtMS45NWw0LjIzLTMuMzFjLjM4LS4zLjQ5LS44NC4yNC0xLjI4bC00LTYuOTNjLS4yNS0uNDMtLjc3LS42MS0xLjIyLS40M2wtNC45OCAyLjAxYy0xLjAzLS43OS0yLjE2LTEuNDYtMy4zOC0xLjk3bC0uNzUtNS4zYy0uMDktLjQ3LS41LS44NC0xLS44NGgtOGMtLjUgMC0uOTEuMzctLjk5Ljg0bC0uNzUgNS4zYy0xLjIyLjUxLTIuMzUgMS4xNy0zLjM4IDEuOTdsLTQuOTgtMi4wMWMtLjQ1LS4xNy0uOTcgMC0xLjIyLjQzbC00IDYuOTNjLS4yNS40My0uMTQuOTcuMjQgMS4yOGw0LjIyIDMuMzFjLS4wOC42NC0uMTQgMS4yOS0uMTQgMS45NXMuMDYgMS4zMS4xNCAxLjk1bC00LjIyIDMuMzFjLS4zOC4zLS40OS44NC0uMjQgMS4yOGw0IDYuOTNjLjI1LjQzLjc3LjYxIDEuMjIuNDNsNC45OC0yLjAxYzEuMDMuNzkgMi4xNiAxLjQ2IDMuMzggMS45N2wuNzUgNS4zYy4wOC40Ny40OS44NC45OS44NGg4Yy41IDAgLjkxLS4zNy45OS0uODRsLjc1LTUuM2MxLjIyLS41MSAyLjM1LTEuMTcgMy4zOC0xLjk3bDQuOTggMi4wMWMuNDUuMTcuOTcgMCAxLjIyLS40M2w0LTYuOTNjLjI1LS40My4xNC0uOTctLjI0LTEuMjhsLTQuMjItMy4zMXptLTE0Ljg2IDUuMDVjLTMuODcgMC03LTMuMTMtNy03czMuMTMtNyA3LTcgNyAzLjEzIDcgNy0zLjEzIDctNyA3eiIvPgo8L3N2Zz4K);-webkit-mask-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDQ4IDQ4Ij4KICAgIDxwYXRoIGQ9Ik0wIDBoNDh2NDhoLTQ4eiIgZmlsbD0ibm9uZSIvPgogICAgPHBhdGggZD0iTTM4Ljg2IDI1Ljk1Yy4wOC0uNjQuMTQtMS4yOS4xNC0xLjk1cy0uMDYtMS4zMS0uMTQtMS45NWw0LjIzLTMuMzFjLjM4LS4zLjQ5LS44NC4yNC0xLjI4bC00LTYuOTNjLS4yNS0uNDMtLjc3LS42MS0xLjIyLS40M2wtNC45OCAyLjAxYy0xLjAzLS43OS0yLjE2LTEuNDYtMy4zOC0xLjk3bC0uNzUtNS4zYy0uMDktLjQ3LS41LS44NC0xLS44NGgtOGMtLjUgMC0uOTEuMzctLjk5Ljg0bC0uNzUgNS4zYy0xLjIyLjUxLTIuMzUgMS4xNy0zLjM4IDEuOTdsLTQuOTgtMi4wMWMtLjQ1LS4xNy0uOTcgMC0xLjIyLjQzbC00IDYuOTNjLS4yNS40My0uMTQuOTcuMjQgMS4yOGw0LjIyIDMuMzFjLS4wOC42NC0uMTQgMS4yOS0uMTQgMS45NXMuMDYgMS4zMS4xNCAxLjk1bC00LjIyIDMuMzFjLS4zOC4zLS40OS44NC0uMjQgMS4yOGw0IDYuOTNjLjI1LjQzLjc3LjYxIDEuMjIuNDNsNC45OC0yLjAxYzEuMDMuNzkgMi4xNiAxLjQ2IDMuMzggMS45N2wuNzUgNS4zYy4wOC40Ny40OS44NC45OS44NGg4Yy41IDAgLjkxLS4zNy45OS0uODRsLjc1LTUuM2MxLjIyLS41MSAyLjM1LTEuMTcgMy4zOC0xLjk3bDQuOTggMi4wMWMuNDUuMTcuOTcgMCAxLjIyLS40M2w0LTYuOTNjLjI1LS40My4xNC0uOTctLjI0LTEuMjhsLTQuMjItMy4zMXptLTE0Ljg2IDUuMDVjLTMuODcgMC03LTMuMTMtNy03czMuMTMtNyA3LTcgNyAzLjEzIDcgNy0zLjEzIDctNyA3eiIvPgo8L3N2Zz4K);mask-size:contain;-webkit-mask-size:contain;margin-right:5px;cursor:pointer}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-settings-button:hover{background-color:#777}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-button{padding:7px 10px;flex-grow:1;border-radius:4px;background-color:#ff6f61;color:#fff;text-align:center;cursor:pointer;text-transform:uppercase}.wonderpush-bell .wonderpush-dialog .wonderpush-notification{margin:15px;border:1px solid #ddd;border-radius:4px;overflow:hidden;height:63px;box-shadow:0 0 3px rgba(0,0,0,.3)}.wonderpush-bell .wonderpush-dialog .wonderpush-notification .wonderpush-notification-icon{width:53px;height:53px;float:left;margin-top:5px;margin-left:5px;background-color:#f3f3f3;background-size:cover}.wonderpush-bell .wonderpush-dialog .wonderpush-notification .wonderpush-notification-paragraph-small{height:6px;background-color:#eee;margin:8px 5px 0 63px;width:80px}.wonderpush-bell .wonderpush-dialog .wonderpush-notification .wonderpush-notification-paragraph-medium{height:6px;background-color:#eee;margin:8px 5px 0 63px;width:100px}.wonderpush-bell .wonderpush-dialog .wonderpush-notification .wonderpush-notification-paragraph-large{height:6px;background-color:#eee;margin:8px 5px 0 63px;width:120px}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-advanced-settings{transition:all .2s ease-in-out;height:57px;overflow:hidden;box-sizing:content-box;border-top:1px solid #efefef;padding:15px;text-align:center}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-advanced-settings.wonderpush-collapsed{height:0;padding:0}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-advanced-settings .wonderpush-dialog-advanced-settings-description{font-size:12px}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-advanced-settings .wonderpush-dialog-advanced-settings-button-container{margin:10px 0;display:flex;justify-content:stretch;align-items:center}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-advanced-settings .wonderpush-dialog-advanced-settings-button-container .wonderpush-dialog-advanced-settings-download-button{margin-right:5px}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-advanced-settings .wonderpush-dialog-advanced-settings-button-container .wonderpush-dialog-advanced-settings-clear-button,.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-advanced-settings .wonderpush-dialog-advanced-settings-button-container .wonderpush-dialog-advanced-settings-download-button{opacity:.7;transition:all .15s ease-in-out;cursor:pointer;border-radius:4px;padding:3px 5px;text-align:center;flex-grow:1;background-color:#fff;color:#ff6f61;font-size:.9em;border:1px solid #ff6f61;text-transform:uppercase}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-advanced-settings .wonderpush-dialog-advanced-settings-button-container .wonderpush-dialog-advanced-settings-clear-button:hover,.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-advanced-settings .wonderpush-dialog-advanced-settings-button-container .wonderpush-dialog-advanced-settings-download-button:hover{opacity:1}.wonderpush-bell .wonderpush-dialog .wonderpush-dialog-advanced-settings .wonderpush-dialog-advanced-settings-fineprint{font-size:10px;color:#aaa}.wonderpush-bell.wonderpush-right{left:unset;right:20px;flex-direction:row-reverse}.wonderpush-bell.wonderpush-right .wonderpush-paragraph{transition:transform .2s ease-in-out;transform-origin:right;transform:scale(1);margin-left:unset;margin-right:12px;pointer-events:none}.wonderpush-bell.wonderpush-right .wonderpush-paragraph:after{position:absolute;right:unset;left:100%;border-right-color:transparent;border-left-color:rgba(0,0,0,.8)}.wonderpush-bell.wonderpush-right .wonderpush-dialog{transition:transform .2s ease-in-out;transform-origin:bottom right;transform:scale(1);left:unset;right:0}.wonderpush-bell.wonderpush-right .wonderpush-dialog:after{left:unset;right:11px}.wonderpush-bell.wonderpush-right .wonderpush-help{transition:transform .2s ease-in-out;transform-origin:bottom right;transform:scale(1);left:unset;right:0}.wonderpush-bell.wonderpush-right .wonderpush-help:after{left:unset;right:11px}")),document.head.appendChild(n);var c=new function(e){e=e||{},this.element=window.document.createElement("div"),this.element.classList.add(r+"bell"),[{cls:"icon-container",name:"iconContainer"},{cls:"icon",name:"icon",parent:"iconContainer"},{cls:"icon-badge",name:"iconBadge",parent:"iconContainer"},{cls:"paragraph",name:"paragraph"},{cls:"help",name:"help"},{cls:"dialog",name:"dialog"},{cls:"dialog-title",name:"dialogTitle",parent:"dialog"},{cls:"notification",name:"notification",parent:"dialog"},{cls:"notification-icon",name:"notificationIcon",parent:"notification"},{cls:"notification-paragraph-large",parent:"notification"},{cls:"notification-paragraph-medium",parent:"notification"},{cls:"notification-paragraph-large",parent:"notification"},{cls:"notification-paragraph-small",parent:"notification"},{cls:"dialog-button-container",name:"dialogButtonContainer",parent:"dialog"},{cls:"dialog-settings-button",name:"dialogSettingsButton",parent:"dialogButtonContainer"},{cls:"dialog-button",name:"dialogButton",parent:"dialogButtonContainer"},{cls:"dialog-advanced-settings",name:"dialogAdvancedSettings",parent:"dialog"},{cls:"dialog-advanced-settings-description",name:"dialogAdvancedSettingsDescription",parent:"dialogAdvancedSettings"},{cls:"dialog-advanced-settings-button-container",name:"dialogAdvancedSettingsButtonContainer",parent:"dialogAdvancedSettings"},{cls:"dialog-advanced-settings-download-button",name:"dialogAdvancedSettingsDownloadButton",parent:"dialogAdvancedSettingsButtonContainer"},{cls:"dialog-advanced-settings-clear-button",name:"dialogAdvancedSettingsClearButton",parent:"dialogAdvancedSettingsButtonContainer"},{cls:"dialog-advanced-settings-fineprint",name:"dialogAdvancedSettingsFineprint",parent:"dialogAdvancedSettings"}].forEach(function(e){var t=window.document.createElement("div");e.name&&(this[e.name]=t),this[e.parent||"element"].appendChild(t),t.classList.add(r+e.cls)}.bind(this)),e.hidePrivacySettings&&(this.dialogSettingsButton.style.display="none"),this.isCollapsed=function(e){var t="string"==typeof e?this[e]:e;return!!t&&t.classList.contains(r+"collapsed")}.bind(this),this.collapse=function(e){var t="string"==typeof e?this[e]:e;if(t){if(t.classList.contains(r+"collapsed"))return Promise.resolve();t.classList.add(r+"collapsed");var n=this.element.parentNode?s(t):Promise.resolve();return t===this.dialog?n.then(function(){this.collapse(this.dialogAdvancedSettings)}.bind(this)):t===this.paragraph&&n.then(function(){this.paragraph.classList.add(r+"hidden")}.bind(this)),n}}.bind(this),this.uncollapse=function(e){var t="string"==typeof e?this[e]:e;if(t)return t.classList.contains(r+"collapsed")?(t.classList.remove(r+"collapsed"),t.classList.remove(r+"hidden"),s(t)):Promise.resolve()}.bind(this),this.toggleCollapse=function(e){var t="string"==typeof e?this[e]:e;if(t)return t.classList.contains(r+"collapsed")?this.uncollapse(t):this.collapse(t)}.bind(this),this.deactivate=function(){if(!this.element.classList.contains(r+"deactivated"))return this.element.classList.add(r+"deactivated"),s(this.element).then(function(){this.element.classList.add(r+"hidden")}.bind(this))}.bind(this),this.activate=function(){if(this.element.classList.contains(r+"deactivated"))return this.element.classList.remove(r+"hidden"),setTimeout(function(){this.element.classList.remove(r+"deactivated")}.bind(this),0),s(this.element)},e.notificationIcon&&(this.notificationIcon.style.backgroundImage="url("+e.notificationIcon.replace("(","%28").replace(")","%29")+")"),this.dialogTitle.textContent=e.dialogTitle||a("Manage Notifications"),this.dialogAdvancedSettingsDescription.textContent=e.advancedSettingsDescription||a("Your personal notification data:"),e.advancedSettingsFineprint?this.dialogAdvancedSettingsFineprint.textContent=e.advancedSettingsFineprint:this.dialogAdvancedSettingsFineprint.innerHTML=a("WonderPush fully supports european GDPR").replace("WonderPush",'<a href="https://www.wonderpush.com/">WonderPush</a>'),this.dialogAdvancedSettingsClearButton.textContent=e.clearDataButtonTitle||a("Clear"),this.dialogAdvancedSettingsDownloadButton.textContent=e.downloadDataButtonTitle||a("Download"),this.dialogSettingsButton.addEventListener("click",function(){this.toggleCollapse(this.dialogAdvancedSettings)}.bind(this)),this.iconBadge.textContent="1",this.collapse("help"),this.collapse("dialog"),this.collapse("paragraph"),this.collapse("iconBadge"),this.collapse("dialogAdvancedSettings")}({notificationIcon:t.notificationIcon||e.getNotificationIcon(),dialogTitle:t.dialogTitle,hidePrivacySettings:t.hidePrivacySettings,clearDataButtonTitle:t.clearDataButtonTitle,downloadDataButtonTitle:t.downloadDataButtonTitle,advancedSettingsDescription:t.advancedSettingsDescription,advancedSettingsFineprint:t.advancedSettingsFineprint});if(this.showBell=function(){function e(){window.document.body.appendChild(c.element)}"loading"===window.document.readyState?window.document.addEventListener("DOMContentLoaded",e):e()}.bind(this),this.hideBell=function(){c.element&&c.element.parentNode&&c.element.parentNode.removeChild(c.element)},this.updateTexts=function(){switch(e.Notification.getSubscriptionState()){case e.SubscriptionState.DENIED:c.dialogButton.textContent="",c.paragraph.textContent=t.blockedText||a("You've blocked notifications"),c.help.style.backgroundImage="url(https://cdn.by.wonderpush.com/plugins/optin-bell/1.0.0/allow-notifications.jpg)";break;case e.SubscriptionState.SUBSCRIBED:c.dialogButton.textContent=t.unsubscribeButtonTitle||a("Unsubscribe"),c.paragraph.textContent=t.alreadySubscribedText||a("You're subscribed to notifications");break;case e.SubscriptionState.UNSUBSCRIBED:c.dialogButton.textContent=t.subscribeButtonTitle||a("Subscribe"),c.paragraph.textContent=t.alreadyUnsubscribedText||a("You are not receiving any notifications");break;case e.SubscriptionState.UNDETERMINED:c.dialogButton.textContent=a("Loading"),c.paragraph.textContent=a("Loading");break;case e.SubscriptionState.NOT_SUBSCRIBED:c.dialogButton.textContent=a("Subscribe"),c.paragraph.textContent=t.subscribeInviteText||a("Click to subscribe to notifications")}},this.updateDiscretion=function(){e.Notification.getSubscriptionState()===e.SubscriptionState.SUBSCRIBED&&c.isCollapsed(c.dialog)&&c.isCollapsed(c.help)&&c.element.classList.add(r+"discrete")}.bind(this),window.addEventListener("WonderPushEvent",function(n){n.detail&&n.detail.state&&"subscription"===n.detail.name&&(this.updateTexts(),c.collapse(c.dialog),c.collapse(c.help),c.collapse(c.iconBadge),n.detail.state===e.SubscriptionState.UNSUBSCRIBED&&(c.paragraph.textContent=t.unsubscribedText||a("You won't receive more notifications"),setTimeout(function(){c.collapse(c.paragraph),this.updateTexts(),t.hideWhenSubscribed&&c.activate()}.bind(this),1200)),n.detail.state===e.SubscriptionState.SUBSCRIBED&&(c.paragraph.textContent=t.subscribedText||a("Thanks for subscribing!"),c.uncollapse(c.paragraph),setTimeout(function(){t.hideWhenSubscribed?c.deactivate():(c.element.classList.add(r+"discrete"),c.collapse(c.paragraph).then(function(){this.updateTexts()}.bind(this)))}.bind(this),1200)),n.detail.state===e.SubscriptionState.DENIED&&(c.element.classList.remove(r+"discrete"),c.uncollapse(c.paragraph),t.hideWhenSubscribed&&c.activate(),setTimeout(function(){c.collapse(c.paragraph)}.bind(this),1200)))}.bind(this)),c.dialogButton.addEventListener("click",(function(t){switch(e.Notification.getSubscriptionState()){case e.SubscriptionState.SUBSCRIBED:e.setNotificationEnabled(!1,t).then((function(){c.collapse(c.dialog),c.uncollapse(c.paragraph)}));break;case e.SubscriptionState.UNSUBSCRIBED:e.setNotificationEnabled(!0,t),c.collapse(c.dialog)}})),c.dialogAdvancedSettingsDownloadButton.addEventListener("click",(function(t){e.Data.downloadExport()})),c.dialogAdvancedSettingsClearButton.addEventListener("click",function(t){window.confirm(a("This action will clear all the data used to send you targeted push notifications. Are you sure ?"))&&(c.collapse(c.dialog),e.Data.clearAll().then(function(){c.paragraph.textContent=a("Data successfully cleared"),c.uncollapse(c.paragraph),setTimeout(function(){c.collapse(c.paragraph),this.updateTexts()}.bind(this),1200)}.bind(this)))}.bind(this)),c.iconContainer.addEventListener("mouseenter",(function(){c.collapse(c.iconBadge),c.isCollapsed(c.dialog)&&c.uncollapse(c.paragraph)})),c.iconContainer.addEventListener("mouseleave",function(){this.updateDiscretion(),c.collapse(c.paragraph).then(function(){this.updateTexts()}.bind(this))}.bind(this)),c.iconContainer.addEventListener("click",(function(n){if(c.isCollapsed(c.dialog)){var o=e.Notification.getSubscriptionState();switch(o){case e.SubscriptionState.DENIED:e.isOnRightDomain()&&(c.uncollapse(c.help),c.collapse(c.paragraph),c.element.classList.remove(r+"discrete"));break;case e.SubscriptionState.SUBSCRIBED:case e.SubscriptionState.UNSUBSCRIBED:c.dialogSettingsButton.style.display=t.hidePrivacySettings?"none":o===e.SubscriptionState.SUBSCRIBED?"":"none",c.uncollapse(c.dialog),c.collapse(c.paragraph),c.element.classList.remove(r+"discrete");break;case e.SubscriptionState.NOT_SUBSCRIBED:e.setNotificationEnabled(!0,n),c.collapse(c.dialog)}}else c.collapse(c.dialog)})),window.document.addEventListener("click",function(e){c.element.contains(e.srcElement)||(c.collapse(c.dialog),c.collapse(c.help),this.updateDiscretion(),this.updateTexts())}.bind(this)),t.style)for(var p in t.style)c.element.style[p]=t.style[p];"right"===t.position&&c.element.classList.add(r+"right"),t.color&&(c.iconContainer.style.backgroundColor=t.color,c.dialogButton.style.backgroundColor=t.color,c.dialogAdvancedSettingsClearButton.style.color=t.color,c.dialogAdvancedSettingsDownloadButton.style.color=t.color,c.dialogAdvancedSettingsClearButton.style.borderColor=t.color,c.dialogAdvancedSettingsDownloadButton.style.borderColor=t.color),t.bellIcon&&(c.icon.style.maskImage=c.icon.style.webkitMaskImage="url("+t.bellIcon+")"),this.showBell(),this.updateTexts(),e.Notification.getSubscriptionState()===e.SubscriptionState.SUBSCRIBED&&(c.element.classList.add(r+"discrete"),c.collapse(c.iconBadge)),t.hideWhenSubscribed&&e.Notification.getSubscriptionState()===e.SubscriptionState.SUBSCRIBED&&(c.element.classList.add(r+"hidden"),c.element.classList.add(r+"deactivated")),t.hasOwnProperty("showBadge")&&!t.showBadge||e.Storage.get("badgeShown").then((function(t){t.badgeShown||(e.Storage.set("badgeShown",!0),c.uncollapse(c.iconBadge))}))}})}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e._protected.Plugins.preregisterInlinedPlugin("tag-switch","1.1.3",(function(){WonderPush.registerPlugin("tag-switch",(function(e,t){var n;(n=document.createElement("style")).type="text/css",n.appendChild(document.createTextNode(".wp-tag-switch{position:relative;display:inline-block;vertical-align:middle;width:auto;height:auto;padding:.2em;border-radius:1.25em;box-shadow:inset 0 -1px rgba(0,0,0,.05),inset 0 1px 1px rgba(0,0,0,.05);cursor:pointer;background-image:linear-gradient(to bottom,rgba(0,0,0,.2),rgba(255,255,255,.3) 1.5em)}.wp-tag-switch-input{display:none}.wp-tag-switch-label{position:relative;display:block;height:2em;font-size:60%;text-transform:uppercase;background:#eceeef;border-radius:inherit;box-shadow:inset 0 1px 2px rgba(0,0,0,.12),inset 0 0 2px rgba(0,0,0,.15);transition:.15s ease-out;transition-property:opacity,background}.wp-tag-switch-label:after,.wp-tag-switch-label:before{line-height:0;clear:both;transition:inherit;white-space:nowrap;display:inline-block}.wp-tag-switch-label:before{content:attr(data-off);right:1em;color:#aaa;text-shadow:0 1px rgba(255,255,255,.5);float:right;margin-top:1em;margin-right:1em;margin-left:2.5em}.wp-tag-switch-label:after{content:attr(data-on);left:1em;color:#fff;text-shadow:0 1px rgba(0,0,0,.2);opacity:0;float:left;margin-top:0;margin-left:1em;margin-right:2.5em}.wp-tag-switch-input:checked~.wp-tag-switch-label{background:#47a8d8;box-shadow:inset 0 1px 2px rgba(0,0,0,.15),inset 0 0 3px rgba(0,0,0,.2)}.wp-tag-switch-input:checked~.wp-tag-switch-label:before{opacity:0}.wp-tag-switch-input:checked~.wp-tag-switch-label:after{opacity:1}.wp-tag-switch-handle{position:absolute;top:.24em;left:.24em;width:1.125em;height:1.125em;background:#fff;border-radius:100%;box-shadow:1px 1px 5px rgba(0,0,0,.2);background-image:linear-gradient(to bottom,#fff 40%,#f0f0f0);transition:.15s ease-out;transition-property:left,margin-left}.wp-tag-switch-handle:before{content:'';position:absolute;top:0;left:0;margin:.1875em 0 0 .1875em;width:.75em;height:.75em;background:#f9f9f9;border-radius:100%;box-shadow:inset 0 1px rgba(0,0,0,.02);background-image:linear-gradient(to bottom,#eee,#fff)}.wp-tag-switch-input:checked~.wp-tag-switch-handle{left:100%;margin-left:-1.365em;box-shadow:-1px 1px 5px rgba(0,0,0,.2)}.wp-tag-switch-input:disabled~.wp-tag-switch-handle{background-image:linear-gradient(to bottom,silver 40%,grey)}.wp-tag-switch-input:disabled~.wp-tag-switch-handle:before{background:#b0b0b0}.wp-tag-switch-input:disabled~.wp-tag-switch-label{background:silver}.wp-tag-switch-input:disabled~.wp-tag-switch-label:before{color:#eee}.wp-tag-switch-off-gray>.wp-tag-switch-label{background:#eceeef}.wp-tag-switch-off-gray>.wp-tag-switch-label:before{color:#aaa;text-shadow:0 1px rgba(255,255,255,.5)}.wp-tag-switch-off-grey>.wp-tag-switch-label{background:#eceeef}.wp-tag-switch-off-grey>.wp-tag-switch-label:before{color:#aaa;text-shadow:0 1px rgba(255,255,255,.5)}.wp-tag-switch-off-red>.wp-tag-switch-label{background:#ed2121}.wp-tag-switch-off-red>.wp-tag-switch-label:before{color:#fff;text-shadow:0 1px rgba(0,0,0,.2)}.wp-tag-switch-on-green>.wp-tag-switch-input:checked~.wp-tag-switch-label{background:#4fb845;text-shadow:0 1px rgba(0,0,0,.2)}.wp-tag-switch-on-blue>.wp-tag-switch-input:checked~.wp-tag-switch-label{background:#47a8d8;text-shadow:0 1px rgba(0,0,0,.2)}")),document.head.appendChild(n);var o=t.switchElementClass||"wonderpush-tag-switch",r=function(){"loading"!==document.readyState?this.setupTagSwitch():document.addEventListener("DOMContentLoaded",function(){this.setupTagSwitch()}.bind(this))}.bind(this);this.setupTagSwitch=function(){if(null!==t.switchElementClass){var n=document.querySelectorAll("."+o);if(n.length){var r=t.unsupported||"",a="true"===t.includeUnsupported,s=t.classPrefix||"wp-tag-",c=t.prepend||"",p=t.append||"",u=t.sentence||"",d=t.cssClass||"",l=t.label,f=t.on||l||"ON",g=t.off||l||"OFF",h=t.colorOn,m=t.colorOff;return Promise.all([e.getProperties(),e.getTags()]).then((function(t){var o=t[0],v=t[1];Array.prototype.slice.call(n).forEach((function(t){if(t&&"true"!==t.dataset.wpInitialized){t.dataset.wpInitialized="true";var n=a||"true"===t.dataset.includeUnsupported;if(n||e.isNativePushNotificationSupported()){var _=!!t.dataset.tag,y=!!t.dataset.field&&!!t.dataset.value;if(_&&y&&e.logWarn("In the presence of a tag data attribute, field and value data attributes are ignored for",t),_||y){var w=t.dataset.classPrefix||s;t.innerHTML=(t.dataset.prepend||c)+'<div class="'+w+'switch-wrapper"></div>'+(t.dataset.append||p);var b=t.querySelector("."+w+"switch-wrapper"),S=document.createElement("SPAN");S.innerHTML=t.dataset.sentence||u;var E=document.createElement("LABEL");E.classList.add(w+"switch"),E.className+=" "+(t.dataset.class||d),(t.dataset.colorOn||h)&&E.classList.add(w+"switch-on-"+(t.dataset.colorOn||h)),(t.dataset.colorOff||m)&&E.classList.add(w+"switch-off-"+(t.dataset.colorOff||m));var I=document.createElement("INPUT");I.id=t.id+"-input",I.type="checkbox",I.classList.add(w+"switch-input"),E.appendChild(I);var C=document.createElement("SPAN");C.classList.add(w+"switch-label"),C.dataset.on=t.dataset.label||t.dataset.on||l||f,C.dataset.off=t.dataset.label||t.dataset.off||l||g,E.appendChild(C);var T,P=document.createElement("SPAN");if(P.classList.add(w+"switch-handle"),E.appendChild(P),I.addEventListener("click",i),I.disabled=!e.isNativePushNotificationSupported()&&!n,_)I.checked=0<=v.indexOf(t.dataset.tag);else{var N=null==(T=o[t.dataset.field])?[]:Array.isArray(T)?T:[T];I.checked=0<=N.indexOf(t.dataset.value)}b.appendChild(S),b.appendChild(E)}else e.logWarn("Missing tag, or both field and value data attribute for",t)}else t.innerHTML=t.dataset.unsupported||r}}))}))}}};var i=function(t){var n=t.target.closest("."+o),r=t.target.checked;r&&e.isNativePushNotificationSupported()&&e.subscribeToNotifications(t),n.dataset.tag?r?WonderPush.addTag(n.dataset.tag):WonderPush.removeTag(n.dataset.tag):r?WonderPush.addProperty(n.dataset.field,n.dataset.value):WonderPush.removeProperty(n.dataset.field,n.dataset.value)};r()}))}))}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e.prototype.Developer=new function(){this.invalidateConfig=function(){return Promise.all([e._protected.Config.invalidateConfig(),e._protected.Integration.callOnCustomDomain("WonderPushSDK._protected.Config.invalidateConfig",[])]).then((function(){}),(function(t){throw e._protected.Helper.warn("[developer   ]","Failed to invalidate config",t),new e.prototype.Errors.InternalError("Failed to invalidate config")}))}}}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(e){e.preInstantiationPromise.then(()=>(e._protected.Blocker.category("requestvault").add("consent"),e._protected.Consent.awaitUserConsent())).then(()=>{e._protected.Blocker.category("requestvault").remove("consent")})}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){let e=!1;const t=new Set(["constructor"]);return function(n){const o=new n._protected.Promise.Deferred,r=new Set(["init","ready","push","registerPlugin","Constants","Errors","setUserConsent","getUserConsent","clearAllData","clearEventsHistory","clearPreferences","downloadAllData"]);n._protected.Api={},n._protected.Api.proxify=(o,r,i=new Set)=>new Proxy(o,{get:(o,a)=>{if(!(t.has(a)||i.has(a)||e))switch(typeof o[a]){case"object":return n._protected.Api.proxify(o[a],`${r}.${a}`);case"function":return()=>Promise.reject(new n.prototype.Errors.ConsentError(`Cannot call ${r}.${a} without user consent. Consider calling WonderPush.setUserConsent(true) after prompting the user.`));default:return o[a]}return o[a]}}),n._protected.Api.proxifyPublicSDK=function(){n.this=n._protected.Api.proxify(n.this,"WonderPush",r)};const i=()=>n._protected.Consent.hasUserConsent().then(t=>{e=t});return n.preInstantiationPromise.then(()=>n._protected.Consent.getModuleInitializationPromise()).then(()=>{n._protected.Integration.addBroadcastListener(n._protected.Constants.BROADCAST_TYPE_SET_USER_CONSENT,()=>{i()}),i().then(o.resolve)}),o.promise}}.apply(t,[]))||(e.exports=o)},function(e,t,n){var o,r;let i,a;o=[n(99),n(17),n(100)],void 0===(r=function(e,t,n){return function(o){switch(o._protected.Helper.decodeQueryString(location.search).amp){case"frame":(i=new e.AmpWebPushHelperFrame({debug:!1,WonderPushSDK:o})).run();break;case"dialog":o._protected.PopupUI.getModuleInitializationPromise().then(()=>{(a=new n.AmpWebPushPermissionDialog({debug:!1,defaultHTML:o._protected.PopupUI.permissionUI(),needUserGestureToAskPermission:o._protected.Notification.needUserGestureToAskPermission(),PromisePoll:o._protected.Promise.Poll})).run()})}if(o._protected.RunModes.Behaviors.ContextServiceWorker){const e=()=>o._protected.Config.getModuleInitializationPromise().then(()=>({applicationServerKey:o._protected.Helper.arrayBufferFromBase64UrlSafe(o._protected.Options.getApplicationServerKey()||""),onSubscribe:e=>e?Promise.all([o._protected.Notification.setManuallyUnsubscribed(!1),o._protected.Installation.addInstallationPushToken(e)]):Promise.resolve(),onUnsubscribe:()=>o._protected.Notification.setManuallyUnsubscribed(!0),getManuallyUnsubscribed:()=>o._protected.Notification.getManuallyUnsubscribed()}));t.registerListeners(e,o._protected.ServiceWorker.addEventListener)}}}.apply(t,o))||(e.exports=r)},function(e,t,n){"use strict";n.r(t),n.d(t,"HelperFrameOptions",(function(){})),n.d(t,"ServiceWorkerMessage",(function(){})),n.d(t,"ServiceWorkerRegistrationMessage",(function(){})),n.d(t,"NotificationPermissionStateMessage",(function(){})),n.d(t,"StorageGetMessage",(function(){})),n.d(t,"AmpWebPushHelperFrame",(function(){return s}));var o=n(0),r=n(1),i=n(3),a=n(17);class s{constructor(e){this.WonderPushSDK_=e&&e.WonderPushSDK,this.debug_=e&&e.debug,this.window_=e.windowContext||window,this.ampMessenger_=new r.a({debug:this.debug_,windowContext:this.window_}),this.allowedWorkerMessageTopics_={}}replyToFrameWithPayload_(e,t,n,o){e({success:t,error:t?void 0:n,result:t?o:void 0})}onAmpPageMessageReceivedNotificationPermissionState_(e,t){if(e&&e.isQueryTopicSupported){let n=!1;for(const t in r.a.Topics)e.isQueryTopicSupported===r.a.Topics[t]&&(n=!0);this.replyToFrameWithPayload_(t,!0,null,n)}else this.replyToFrameWithPayload_(t,!0,null,Notification.permission)}onAmpPageMessageReceivedStorageGet_(e,t){let n=null;try{e&&e.key&&this.window_.localStorage?n=this.window_.localStorage.getItem(e.key):console.warn(o.c,"LocalStorage retrieval failed.")}catch(e){}this.replyToFrameWithPayload_(t,!0,null,n)}onAmpPageMessageReceivedServiceWorkerState_(e,t){const n={isControllingFrame:!!this.window_.navigator.serviceWorker.controller,url:this.window_.navigator.serviceWorker.controller?this.window_.navigator.serviceWorker.controller.scriptURL:null,state:this.window_.navigator.serviceWorker.controller?this.window_.navigator.serviceWorker.controller.state:null};this.replyToFrameWithPayload_(t,!0,null,n)}onAmpPageMessageReceivedServiceWorkerRegistration_(e,t){if(!e||!e.workerUrl||!e.registrationOptions)throw new Error("Expected arguments workerUrl and registrationOptions in message, got:",e);this.window_.navigator.serviceWorker.register(e.workerUrl,e.registrationOptions).then(()=>{this.replyToFrameWithPayload_(t,!0,null,null)}).catch(e=>{this.replyToFrameWithPayload_(t,!0,null,e?e.message||e.toString():null)})}messageServiceWorker(e){this.window_.navigator.serviceWorker.controller.postMessage({command:e.topic,payload:e.payload})}onAmpPageMessageReceivedServiceWorkerQuery_(e,t){if(!e||!e.topic)throw new Error("Expected argument topic in message, got:",e);new Promise(t=>{this.allowedWorkerMessageTopics_[e.topic]=t,this.waitUntilWorkerControlsPage().then(()=>{this.messageServiceWorker(e)})}).then(n=>(delete this.allowedWorkerMessageTopics_[e.topic],this.replyToFrameWithPayload_(t,!0,null,n)))}getParentOrigin_(){const e=Object(i.a)(this.window_.location.search);if(!e.parentOrigin)throw new Error("Expecting parentOrigin URL query parameter.");return e.parentOrigin}onPageMessageReceivedFromServiceWorker_(e){const{command:t,payload:n}=e.data,o=this.allowedWorkerMessageTopics_[t];t===a.WorkerMessengerCommand.AMP_SUBSCRIBE&&this.WonderPushSDK_&&this.WonderPushSDK_._protected.Installation.updateInstallationCoreProperties(),"function"==typeof o&&o(n)}isWorkerControllingPage_(){return this.window_.navigator.serviceWorker&&this.window_.navigator.serviceWorker.controller&&"activated"===this.window_.navigator.serviceWorker.controller.state}waitUntilWorkerControlsPage(){return new Promise(e=>{this.isWorkerControllingPage_()?e():this.window_.navigator.serviceWorker.addEventListener("controllerchange",()=>{this.isWorkerControllingPage_()?e():this.window_.navigator.serviceWorker.controller.addEventListener("statechange",()=>{this.isWorkerControllingPage_()&&e()})})})}run(e){this.ampMessenger_.on(r.a.Topics.NOTIFICATION_PERMISSION_STATE,this.onAmpPageMessageReceivedNotificationPermissionState_.bind(this)),this.ampMessenger_.on(r.a.Topics.SERVICE_WORKER_STATE,this.onAmpPageMessageReceivedServiceWorkerState_.bind(this)),this.ampMessenger_.on(r.a.Topics.SERVICE_WORKER_REGISTRATION,this.onAmpPageMessageReceivedServiceWorkerRegistration_.bind(this)),this.ampMessenger_.on(r.a.Topics.SERVICE_WORKER_QUERY,this.onAmpPageMessageReceivedServiceWorkerQuery_.bind(this)),this.ampMessenger_.on(r.a.Topics.STORAGE_GET,this.onAmpPageMessageReceivedStorageGet_.bind(this)),this.waitUntilWorkerControlsPage().then(()=>{this.window_.navigator.serviceWorker.addEventListener("message",this.onPageMessageReceivedFromServiceWorker_.bind(this))}),this.ampMessenger_.listen([e||this.getParentOrigin_()])}}},function(e,t,n){"use strict";n.r(t),n.d(t,"PermissionDialogOptions",(function(){})),n.d(t,"AmpWebPushPermissionDialog",(function(){return s}));var o=n(0),r=n(1),i=n(3);const a=n(10);class s{constructor(e){this.debug_=e&&e.debug,this.PromisePoll=e&&e.PromisePoll,this.window_=e.windowContext||window,this.defautHTML_=e.defaultHTML,this.needUserGestureToAskPermission=e.needUserGestureToAskPermission,this.ampMessenger_=new r.a({debug:this.debug_,windowContext:this.window_})}isCurrentDialogPopup(){return!!this.window_.opener&&this.window_.opener!==this.window_}requestNotificationPermission(){return this.needUserGestureToAskPermission?new this.PromisePoll(()=>"default"!==Notification.permission,Number.POSITIVE_INFINITY,250).wait().then(()=>Notification.permission):new Promise((e,t)=>{try{this.window_.Notification.requestPermission(t=>e(t))}catch(e){t(e)}})}run(){this.onCloseIconClick_(),this.storeNotificationPermission_(),this.showTargetPermissionSection_(),this.showPostloadSection_(),this.showDefaultUI_(),this.window_.Notification.permission!==o.a.DENIED?this.onPermissionDefaultOrGranted_():this.onPermissionDenied_()}showDefaultUI_(){const e=this.defautHTML_,t=this.window_.document.querySelector("#whole-content");if(e&&t){t.innerHTML=a.sanitize(e);const n=e=>{e.addEventListener("click",(function(e){e.preventDefault(),window.close()}))};t.querySelectorAll(".wonderpush-close-button").forEach(n),t.querySelectorAll(".wp-popup-negative-button").forEach(n),t.querySelectorAll(".wp-popup-positive-button").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),WonderPush.subscribeToNotifications(e)})})}}onCloseIconClick_(){const e=this.window_.document.querySelector("#close");e&&e.addEventListener("click",()=>{this.closeDialog()})}closeDialog(){if(this.isCurrentDialogPopup())this.window_.close();else{const e=this.window_.fakeLocation||this.window_.location,t=Object(i.a)(e.search);if(!t.return)throw new Error("Missing required parameter.");const n=Object(i.c)(t.return);this.redirectToUrl(n)}}onPermissionDenied_(){navigator.permissions.query({name:"notifications"}).then(e=>{e.onchange=()=>{switch(this.storeNotificationPermission_(),this.window_.Notification.permission){case o.a.DEFAULT:case o.a.GRANTED:this.onPermissionDefaultOrGranted_()}}})}storeNotificationPermission_(){this.window_.localStorage.setItem(o.b.NOTIFICATION_PERMISSION,this.window_.Notification.permission)}showTargetPermissionSection_(){const e=this.window_.document.querySelectorAll("[permission]");for(let t=0;t<e.length;t++){const n=e[t];this.setDomElementVisibility_(n,!1)}const t=this.window_.document.querySelector(`[permission=${this.window_.Notification.permission}]`);t&&this.setDomElementVisibility_(t,!0)}showPostloadSection_(){const e=this.window_.document.querySelector("#preload"),t=this.window_.document.querySelector("#postload");e&&t&&(this.setDomElementVisibility_(e,!1),this.setDomElementVisibility_(t,!0))}setDomElementVisibility_(e,t){e&&(t?e.classList.remove("invisible"):e.classList.add("invisible"))}onPermissionDefaultOrGranted_(){return this.requestNotificationPermission().then(e=>{if(this.storeNotificationPermission_(),this.isCurrentDialogPopup())return this.ampMessenger_.connect(opener,"*"),this.ampMessenger_.send(r.a.Topics.NOTIFICATION_PERMISSION_STATE,e).then(e=>{const t=e[0];t&&t.closeFrame&&this.closeDialog()});this.closeDialog()})}redirectToUrl(e){const t=Object(i.b)(e);!t||"http:"!==t.protocol&&"https:"!==t.protocol||(this.window_.location.href=e)}}},function(e,t,n){var o;let r=null;void 0===(o=function(){return function(e){e._protected.InAppMessaging=new function(){this.setDisplayCallback=function(e){r&&r.setDisplayCallback(e)},this.getDisplayedInAppMessage=function(){return r&&r.display.inAppMessage||null},this.forceDisplayOnNextEvent=(t,n)=>{Array.isArray(t)&&e._protected.CustomDomainStorage.get(e._protected.Constants.FORCED_INAPPS_STORAGE_KEY,[]).then(o=>{const r=Array.from(o||[]);return r.push({eventTypes:t,notification:n}),e._protected.CustomDomainStorage.set(e._protected.Constants.FORCED_INAPPS_STORAGE_KEY,r)})};const{RateLimiter:t}=n(102);let o;const i=()=>e._protected.Locking.getModuleInitializationPromise().then(()=>(o||(o=new t(e._protected.Storage,e._protected.Locking)),o));this.rateLimiter=e._protected.Integration.proxifyToCustomDomain("WonderPushSDK._protected.InAppMessaging.rateLimiter",{increment:e=>i().then(t=>t.increment(e)),isRateLimited:e=>i().then(t=>t.isRateLimited(e))})},e.preInstantiationPromise.then(()=>{if(e._protected.RunModes.Behaviors.ModeWebSite){const{InAppMessaging:t}=n(103);r=new t(e)}})}}.apply(t,[]))||(e.exports=o)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),r="[inapp-ratel]",i=function(){function e(e,t){this.storage=e,this.locking=t}return e.prototype.makeMutex=function(e){var t=this;return this.locking.getModuleInitializationPromise().then((function(){return new t.locking.ExpiringUnfairNamedGlobalMutex("RateLimit_"+e.key,500)}))},e.prototype.increment=function(e){var t,n=this;return o.debug(r,"[increment   ]","try increment",e.key),this.makeMutex(e).then((function(n){return t=n,o.debug(r,"[increment   ]","acquiring mutex",e.key),t.acquire({timeout:500})})).catch((function(n){throw o.debug(r,"[increment   ]","could not acquire mutex",n,e.key),t=void 0,n})).then((function(){var t;return o.debug(r,"[increment   ]","got mutex",e.key),n.storage.bulk([{test:{key:"InAppRateLimiter",defaultValue:{},operationsCb:function(n){o.debug(r,"[increment   ]","got storage result",e.key,JSON.parse(JSON.stringify(n)));var i=n[e.key]||{count:0,createdAt:+new Date};n[e.key]=i;var a=new Date;return i.createdAt+e.timeToLive<=a.getTime()&&(o.debug(r,"[increment   ]","reset",e.key),i.createdAt=a.getTime(),i.count=0),i.count>=e.limit?(o.debug(r,"[increment   ]","limit reached",e.key),t=new Error("Cannot increment rate limit "+e.key+": limit reached"),[]):(i.count++,o.debug(r,"[increment   ]","increment",e.key,i.count),[{put:{key:"InAppRateLimiter",value:n}}])}}}]).then((function(){if(t)throw t}))})).catch((function(e){throw t&&t.release().catch((function(e){return o.error(r,"[increment   ]","could not release mutex",e)})),e})).then((function(){return o.debug(r,"[increment   ]","increment done",e.key),t.release()}))},e.prototype.isRateLimited=function(e){var t,n=this;return this.makeMutex(e).then((function(e){return(t=e).acquire({timeout:500})})).catch((function(n){throw o.debug(r,"[isRateLimit]","could not acquire mutex",n,e.key),t=void 0,n})).then((function(){return o.debug(r,"[isRateLimit]","mutex acquired",e.key),n.storage.get("InAppRateLimiter",{})})).then((function(t){o.debug(r,"[isRateLimit]","got cache",JSON.parse(JSON.stringify(t)),e.key);var n=t[e.key];return!!n&&!(n.createdAt+e.timeToLive<+new Date)&&n.count>=e.limit})).catch((function(e){throw o.debug(r,"[isRateLimit]","error",e),t&&t.release().catch((function(e){return o.error(r,"[isRateLimit]","could not release mutex",e)})),e})).then((function(n){return o.debug(r,"[isRateLimit]",e.key,n?"is":"is not","rate limited"),o.debug(r,"[isRateLimit]","releasing mutex",e.key),t.release().then((function(){return n}))}))},e}();t.RateLimiter=i},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(r=(r=a.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(104),c=n(105),p=n(106),u=n(107),d=n(4),l=n(2),f=n(108),g=n(21),h=n(123),m=n(5),v="[inapp       ]",_=function(e){function t(t){var n=this.constructor,o=e.call(this,t)||this;return Object.setPrototypeOf(o,n.prototype),o}return r(t,e),t}(Error),y=function(e){function t(t){var n=this.constructor,o=e.call(this,t)||this;return Object.setPrototypeOf(o,n.prototype),o}return r(t,e),t}(Error),w=function(){function e(e){var t=this;this.messagesSuppressed=!1,this.internalEvents=e._protected,this.protectedNotifications=e._protected.Notification,this.publicNotifications=e.prototype.Notification,this.subscriptionStates=e.prototype.SubscriptionState,this.events=e._protected.Events,this.presence=e._protected,this.installation=e._protected.Installation,this.locking=e._protected.Locking,this.rateLimiter=e._protected.InAppMessaging.rateLimiter,this.eventTriggerListener=new s.WonderPushEventTriggerListener(e._protected.Events),this.consentModule=e._protected.Consent,this.eventTriggerListener.subscribe((function(e){t.triggerEvent(e)})),this.eventTriggerListener.start(),this.fetcher=new c.Fetcher(e._protected.Config),this.bookkeeper=new p.Bookkeeper(e._protected.CustomDomainStorage),this.customDomainStorage=e._protected.CustomDomainStorage,this.display=new f.Display(this),this.displayCallback=this.display.callback,this.FORCED_INAPPS_STORAGE_KEY=e._protected.Constants.FORCED_INAPPS_STORAGE_KEY}return e.prototype.setDisplayCallback=function(e){this.displayCallback=e||this.display.callback},e.prototype.nextForcedInApp=function(e){var t=this;return this.customDomainStorage.get(this.FORCED_INAPPS_STORAGE_KEY,[]).then((function(n){var o=(n||[]).find((function(t){return function(e){return e&&e.notification&&e.eventTypes}(t)&&t.eventTypes.indexOf(e)>=0}));if(o){var r=(n||[]).filter((function(e){return e!==o}));return t.customDomainStorage.set(t.FORCED_INAPPS_STORAGE_KEY,r).then((function(){return o}))}}))},e.prototype.triggerEvent=function(t){return i(this,void 0,void 0,(function(){var n,o,r,i=this;return a(this,(function(a){switch(a.label){case 0:return l.debug(v,"[triggerEvent]","event",t),this.messagesSuppressed?(l.debug(v,"[triggerEvent]","skipping in-app messages because messagesSuppressed is true"),[2]):(n={},o="InAppMessaging.triggerEvent",[4,this.consentModule.hasUserConsent()]);case 1:return a.sent()?(Promise.all([this.bookkeeper.impressionRecords,this.locking.remoteMutexManager.create(o,5e3)]).then((function(e){var t=e[0],o=e[1];return(t||[]).forEach((function(e){"string"==typeof e.reporting.campaignId&&(n[e.reporting.campaignId]=e)})),r=o,i.locking.remoteMutexManager.acquire(r,{timeout:1e4})})).then((function(){return i.nextForcedInApp(t)})).then((function(n){if(l.debug(v,"[triggerEvent] forcedInApp",n),n){var o=e.inAppFromNotification(n.notification);throw o&&i.displayInAppMessage(o),new y}var r=g.EventRateLimits.filter((function(e){return e.eventType===t}));return l.debug(v,"[triggerEvent]","enforcing rate limits",r),Promise.all(r.map((function(e){return i.rateLimiter.isRateLimited(e)})))})).then((function(e){if(e.filter((function(e){return e})).length)throw new _;return Promise.all([i.fetcher.fetchConfig(),i.installation.getProperties(),i.installation.Profile.getCoreProperties(!0),i.events.getAllEvents(),i.presence.getLastPresenceInfo(),i.installation.getTags()])})).then((function(o){var r=o[0],a=o[1],s=o[2],c=o[3],p=o[4],u=new Set(o[5]),f=r.campaigns.map((function(e){return new d.CampaignWrapper(e)}));f=f.filter((function(e){if(!e.active)return!1;if(!e.triggersMatchingEvent(t).length)return!1;if(e.campaign.segment){var o=i.publicNotifications.getSubscriptionState(),r=o===i.subscriptionStates.SUBSCRIBED?"optIn":o===i.subscriptionStates.UNSUBSCRIBED?"softOptOut":"optOut",f=new h.Segmenter(e.campaign.segment,s,a,u,c,p,r).matches();if(l.debug(v,"[triggerEvent]","segmenter matches",e.campaign.segment,f),!f)return!1}var g=n[e.campaignId];return!(g&&g.count>=(e.campaign.capping?e.campaign.capping.maxImpressions:1)||g&&+new Date-g.impressionTime<=(e.campaign.capping?e.campaign.capping.snoozeTime:0)||e.campaign.notifications.length<1||"undefined"!=typeof window&&!d.urlPassesFilters(new URL(window.location.href),e.campaign.urlFilters)&&(l.debug(v,"[triggerEvent]","campaign discarded from url filter",e.campaign,window.location.href),1))})),l.debug(v,"[triggerEvent]","eligible campaigns",f);var g=void 0,m=0;if(f.length){var _=f[0];m=_.triggersMatchingEvent(t)[0].delay||0;var y=_.campaign.notifications[0];g=e.inAppFromNotification(y)}g&&i.displayInAppMessage(g,{delay:m,eventType:t})})).catch((function(e){if(e instanceof _)l.debug(v,"[triggerEvent]","rate limit reached");else{if(!(e instanceof y))throw l.error(v,"[triggerEvent]","error, releasing mutex",e),r&&i.locking.remoteMutexManager.release(r),e;l.debug(v,"[triggerEvent]","forced in-app")}})).then((function(){return i.locking.remoteMutexManager.release(r)})),[2]):[2]}}))}))},e.prototype.displayInAppMessage=function(e,t){void 0===t&&(t={});var n=new u.Reporter(this.internalEvents,this.protectedNotifications,this.rateLimiter,this.bookkeeper,t.eventType);this.displayCallback(e,n,t.delay||0)||this.display.callback(e,n,t.delay||0)},e.inAppFromNotification=function(e){var t,n=m.ReportingDataUtil.extract(e);return e.content.modal?t=new d.InAppMessage(d.InAppMessageType.MODAL,e.content.modal,n,e.payload):e.content.card?t=new d.InAppMessage(d.InAppMessageType.CARD,e.content.card,n,e.payload):e.content.imageOnly?t=new d.InAppMessage(d.InAppMessageType.IMAGEONLY,e.content.imageOnly,n,e.payload):e.content.banner?t=new d.InAppMessage(d.InAppMessageType.BANNER,e.content.banner,n,e.payload):l.error(v,"[triggerEvent]","unknown in-app message type",e),t},e}();t.InAppMessaging=w},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),a=n(2),s="[inapp-trigg]",c=function(e){function t(t){var n=e.call(this)||this;return n.events=t,n.started=!1,n.exitEventListener=function(e){"mouseleave"===e.type&&(a.debug(s,"detected mouseleave, reporting ON_EXIT",e),n.report(i.SystemEvent.ON_EXIT))},n.wonderPushEventListener=function(e){if(e instanceof CustomEvent){var t=e.detail.type;if(t===n.events.WonderPushTrackEventEvent.TYPE){if(!e.detail.event)return;var o=e.detail.event.type;"@VISIT"===o?(a.debug(s,"detected @VISIT, reporting APP_LAUNCH",e),n.report(i.SystemEvent.APP_LAUNCH)):o.startsWith("@")||(a.debug(s,"detected custom event, reporting",o,e),n.report(o))}else t===n.events.NewPageView.TYPE&&(a.debug(s,"detected new page view, reporting ON_FOREGROUND",e),n.report(i.SystemEvent.ON_FOREGROUND))}},n}return r(t,e),t.prototype.start=function(){this.started||(this.started=!0,this.events.listen(this.wonderPushEventListener),"undefined"!=typeof document&&document.addEventListener("mouseleave",this.exitEventListener))},t.prototype.stop=function(){this.started=!1,this.events.unlisten(this.wonderPushEventListener),"undefined"!=typeof document&&document.removeEventListener("mouseleave",this.exitEventListener)},t}(function(){function e(){this.subscribers=new Set}return e.prototype.report=function(e){this.subscribers.forEach((function(t){return t(e)}))},e.prototype.subscribe=function(e){this.subscribers.add(e)},e.prototype.unsubscribe=function(e){this.subscribers.delete(e)},e}());t.WonderPushEventTriggerListener=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e){this.config=e}return e.prototype.fetchConfig=function(){return this.config.getInAppConfig()},e}();t.Fetcher=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(5),r="inAppImpressions",i=function(){function e(e){this.storage=e}return e.prototype.recordImpression=function(e){var t=this;return this.storage.get(r,[]).then((function(n){for(var o=Array.from(n||[]),i={reporting:e,impressionTime:+new Date,count:1},a=!1,s=0;o&&s<o.length;s++){var c=o[s];if(c.reporting.campaignId&&c.reporting.campaignId===e.campaignId){a=!0,i.count=(c.count||0)+1,o[s]=i;break}}return a||o.push(i),t.storage.set(r,o)})).then((function(){}))},Object.defineProperty(e.prototype,"impressionRecords",{get:function(){return this.storage.get(r,[]).then((function(e){return Array.isArray(e)?e.filter((function(e){return function(e){return!!e&&o.isReportingData(e.reporting)&&"number"==typeof e.impressionTime&&"number"==typeof e.count}(e)})):[]}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"campaignIdsFromImpressions",{get:function(){return this.impressionRecords.then((function(e){return new Set(e.map((function(e){return e.reporting.campaignId})).filter((function(e){return"string"==typeof e})))}))},enumerable:!0,configurable:!0}),e}();t.Bookkeeper=i},function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(21),i=n(2),a=n(5),s="[inapp-repor]",c=function(){function e(e,t,n,o,r){this.internalEvents=e,this.notifications=t,this.rateLimiter=n,this.bookkeeper=o,this.eventType=r}return e.prototype.log=function(e,t,n,r){var i=o({actionDate:+new Date},r?{buttonLabel:r}:{});a.ReportingDataUtil.assignEventData(i,t.reportingData),this.internalEvents.trackInternalEventWithAppropriateApi(e,i,void 0,{overrideNotificationReceiptOnly:n})},e.prototype.logImpression=function(e){var t=this;i.debug(s,"[logImpressi]",e),this.bookkeeper.recordImpression(e.reportingData),this.eventType&&r.EventRateLimits.filter((function(e){return e.eventType===t.eventType})).forEach((function(e){return t.rateLimiter.increment(e)})),this.log("@INAPP_VIEWED",e,!0)},e.prototype.logClick=function(e,t,n){i.debug(s,"[logClick    ]",e,t),t.forEach((function(e){return e.domEvent=n})),this.notifications.handleActions(e.reportingData,t),this.log("@INAPP_CLICKED",e,!1,e.buttonTypeOfActions(t))},e.prototype.logDismiss=function(e,t){i.debug(s,"[logDismiss  ]",e)},e}();t.Reporter=c},function(e,t,n){"use strict";var o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(2),i=n(4);n(109);var a=n(111),s=n(114),c=n(2),p=n(117),u=n(120),d="[inapp-displ]",l=function(){function e(e){this.messageDisplayControl=e}return Object.defineProperty(e.prototype,"inAppMessage",{get:function(){return this._inAppMessage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"callback",{get:function(){var e=this;return function(t,n,o){return e._inAppMessage||e.messageDisplayControl.messagesSuppressed?(r.debug(d,"[callback    ]","skipping inAppMessage because",e.messageDisplayControl.messagesSuppressed?"messages are suppressed":"a message is already showing",t),!0):(r.debug(d,"[callback    ]","displaying inAppMessage",t),e._inAppMessage=t,o?setTimeout((function(){return e.displayMessage(t,n)}),o):e.displayMessage(t,n),!0)}},enumerable:!0,configurable:!0}),e.prototype.displayMessage=function(e,t){var n=this,r=void 0;switch(e.messageType){case i.InAppMessageType.BANNER:r=new a.BannerController(o(o({},e.content),{autoDismissTime:1e4}));break;case i.InAppMessageType.CARD:r=new s.CardController(o({},e.content));break;case i.InAppMessageType.IMAGEONLY:r=new p.ImageOnlyController(o({},e.content));break;case i.InAppMessageType.MODAL:r=new u.ModalController(o({},e.content));break;default:c.error(d,"[displayMess]","unknown in-app message type",e.messageType)}r&&(r.dismissCallback=function(o){n._inAppMessage=void 0,t.logDismiss(e,o)},r.clickCallback=function(o,r){n._inAppMessage=void 0,t.logClick(e,o,r)},r.attachAndAnimateEntry().then((function(){t.logImpression(e)})))},e}();t.Display=l},function(e,t,n){var o=n(8),r=n(110);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i=(o(r,{insert:"head",singleton:!1}),r.locals?r.locals:{});e.exports=i},function(e,t,n){(t=n(6)(!1)).push([e.i,".wpiam-message#wpiam-message {\n  z-index: 2147483646;\n}\n.wpiam-message#wpiam-message * {\n  box-sizing: content-box;\n  margin: initial;\n  padding: initial;\n  width: initial;\n  height: initial;\n  min-width: initial;\n  min-height: initial;\n  max-width: initial;\n  max-height: initial;\n  border: initial;\n  background: initial;\n  font-weight: initial;\n  color: initial;\n  opacity: initial;\n  display: initial;\n}\n.wpiam-message#wpiam-message button {\n  display: inline-block;\n}\n.wpiam-message#wpiam-message p,\n.wpiam-message#wpiam-message h2,\n.wpiam-message#wpiam-message div,\n.wpiam-message#wpiam-message section {\n  display: block;\n}\n.wpiam-message#wpiam-message h2 {\n  letter-spacing: normal;\n  font-weight: bold;\n}\n.wpiam-message#wpiam-message .wpiam-card {\n  border-radius: 8px;\n  position: relative;\n}\n.wpiam-message#wpiam-message button {\n  padding: 1px 7px 2px 7px;\n}\n.wpiam-message#wpiam-message section {\n  margin-bottom: 0;\n}\n.wpiam-fullscreen-container {\n  position: fixed;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  right: 0;\n}\n.wpiam-fullscreen-container .wpiam-dim-background {\n  position: absolute;\n  left: 0;\n  top: 0;\n  bottom: 0;\n  right: 0;\n  background-color: rgba(0, 0, 0, 0.5) !important;\n  z-index: -1;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),a=n(11);n(112);var s=function(e){function t(t){var n=e.call(this,t)||this;n.options=t,n.containerElement=document.createElement("div"),n.containerElement.id="wpiam-message",n.containerElement.className="wpiam-banner-message wpiam-message wpiam-banner-message-position-"+(t.bannerPosition||"top");var o=document.createElement("div");if(n.cardElement=o,n.containerElement.appendChild(o),o.className="wpiam-banner-card wpiam-card",n.options.backgroundHexColor&&(o.style.backgroundColor=n.options.backgroundHexColor),n.options.imageUrl){var r=new Image;r.src=n.options.imageUrl,o.appendChild(r),r.className="wpiam-banner-picture-frame wpiam-landscape"}var a=document.createElement("div");a.className="wpiam-banner-content wpiam-landscape",o.appendChild(a);var s=document.createElement("h2");if(a.appendChild(s),s.innerText=n.options.title.text,n.options.title.hexColor&&(s.style.color=n.options.title.hexColor),n.options.body){var c=document.createElement("p");a.appendChild(c),c.innerText=n.options.body.text,n.options.body.hexColor&&(c.style.color=n.options.body.hexColor)}return n.options.autoDismissTime&&setTimeout((function(){return n.dismiss(i.DismissType.AUTO)}),n.options.autoDismissTime),n.containerElement.addEventListener("click",(function(e){n.options.actions.length?n.click(n.options.actions,e):n.dismiss(i.DismissType.TAP)})),n}return r(t,e),Object.defineProperty(t.prototype,"active",{get:function(){return!!this.containerElement.parentElement&&!this.dismissType},enumerable:!0,configurable:!0}),t.prototype.performEntryAnimation=function(){var e=this;return new Promise((function(t){var n=("bottom"===e.options.bannerPosition?1:-1)*e.containerElement.clientHeight,o=e.cardElement.animate([{transform:"translateY("+Math.round(n)+"px)"},{transform:"translateY(0)"}],{duration:250});o.onfinish=o.oncancel=function(){return t()}}))},t.prototype.attach=function(){return window.document.body.appendChild(this.containerElement),Promise.resolve()},t.prototype.performExitAnimation=function(){var e=this;return new Promise((function(t){var n=("bottom"===e.options.bannerPosition?1:-1)*e.containerElement.clientHeight,o=e.cardElement.animate([{transform:"translateY(0)"},{transform:"translateY("+Math.round(n)+"px)"}],{duration:250});o.onfinish=o.oncancel=function(){return t()}}))},t.prototype.detach=function(){var e;return null===(e=this.containerElement.parentElement)||void 0===e||e.removeChild(this.containerElement),Promise.resolve()},t.prototype.handleResize=function(){},Object.defineProperty(t.prototype,"animationElement",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dimBackgroundElement",{get:function(){return null},enumerable:!0,configurable:!0}),t}(a.Controller);t.BannerController=s},function(e,t,n){var o=n(8),r=n(113);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i=(o(r,{insert:"head",singleton:!1}),r.locals?r.locals:{});e.exports=i},function(e,t,n){(t=n(6)(!1)).push([e.i,".wpiam-message.wpiam-banner-message#wpiam-message {\n  position: fixed;\n  top: 0px;\n  left: 0px;\n  right: 0px;\n  padding: 12px 12px 0px 12px;\n  display: flex;\n  justify-content: center;\n  font-size: 16px;\n}\n.wpiam-message.wpiam-banner-message#wpiam-message.wpiam-banner-message-position-bottom {\n  top: unset;\n  bottom: 0px;\n  padding: 0px 12px 12px 12px;\n}\n.wpiam-message.wpiam-banner-message#wpiam-message .wpiam-card.wpiam-banner-card {\n  display: flex;\n  padding: 8px;\n  flex-grow: 1;\n  max-width: 750px;\n  cursor: pointer;\n}\n.wpiam-message.wpiam-banner-message#wpiam-message .wpiam-card.wpiam-banner-card .wpiam-banner-content {\n  flex-grow: 1;\n}\n.wpiam-message.wpiam-banner-message#wpiam-message .wpiam-card.wpiam-banner-card .wpiam-banner-content h2 {\n  font-size: 1em;\n  margin: 0 0 4px;\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n}\n.wpiam-message.wpiam-banner-message#wpiam-message .wpiam-card.wpiam-banner-card .wpiam-banner-content p {\n  font-size: 1em;\n  margin: 0;\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n}\n.wpiam-message.wpiam-banner-message#wpiam-message .wpiam-card.wpiam-banner-card .wpiam-banner-picture-frame {\n  max-width: 40%;\n  max-height: 2.8em;\n  margin-right: 8px;\n}\n.wpiam-message.wpiam-banner-message#wpiam-message .wpiam-card.wpiam-banner-card .wpiam-banner-picture-frame.wpiam-landscape {\n  max-width: 20%;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),a=n(11);n(115);var s=function(e){function t(t){var n=e.call(this,t)||this;n.options=t,n.element=document.createElement("div"),n.element.id="wpiam-message",n.element.className="wpiam-message wpiam-card-message wpiam-fullscreen-container",n.backgroundElement=document.createElement("div"),n.backgroundElement.className="wpiam-dim-background",n.element.appendChild(n.backgroundElement);var o=document.createElement("div");n.containerElement=o,n.element.appendChild(o),o.className="wpiam-card-container",o.addEventListener("click",(function(e){e.target===o&&(e.stopPropagation(),e.preventDefault(),n.dismiss(i.DismissType.TAP))}));var r=document.createElement("div");o.appendChild(r),r.className="wpiam-card",n.options.backgroundHexColor&&(r.style.backgroundColor=n.options.backgroundHexColor);var a=document.createElement("div");r.appendChild(a),a.className="wpiam-card-content";var s=document.createElement("div");s.className="wpiam-img-container",n.imgContainerElement=s,a.appendChild(s);var c=document.createElement("section");a.appendChild(c);var p=document.createElement("div");if(p.className="wpiam-msg-content",c.appendChild(p),n.options.title){var u=document.createElement("h2");p.appendChild(u),u.innerText=n.options.title.text,n.options.title.hexColor&&(u.style.color=n.options.title.hexColor)}if(n.options.body){var d=document.createElement("p");p.appendChild(d),d.innerText=n.options.body.text,n.bodyElement=d,n.options.body.hexColor&&(d.style.color=n.options.body.hexColor)}var l=document.createElement("div");if(l.className="wpiam-actions",c.appendChild(l),n.options.secondaryActionButton){var f=document.createElement("button");l.appendChild(f),f.className="wpiam-secondary-btn",n.options.secondaryActionButton.buttonHexColor&&(f.style.backgroundColor=n.options.secondaryActionButton.buttonHexColor),f.innerText=n.options.secondaryActionButton.text.text,n.options.secondaryActionButton.text.hexColor&&(f.style.color=n.options.secondaryActionButton.text.hexColor),f.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault(),n.options.secondaryActions.length?n.click(n.options.secondaryActions,e):n.dismiss(i.DismissType.TAP)}))}return n.options.primaryActionButton&&(f=document.createElement("button"),l.appendChild(f),f.className="wpiam-primary-btn",n.options.primaryActionButton.buttonHexColor&&(f.style.backgroundColor=n.options.primaryActionButton.buttonHexColor),f.innerText=n.options.primaryActionButton.text.text,n.options.primaryActionButton.text.hexColor&&(f.style.color=n.options.primaryActionButton.text.hexColor),f.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault(),n.options.primaryActions.length?n.click(n.options.primaryActions,e):n.dismiss(i.DismissType.TAP)}))),n}return r(t,e),t.prototype.handleResize=function(){var e;e=this.element.clientWidth>600||this.isLandscape;var t=this.element.querySelector(".wpiam-card");t&&(t.className="wpiam-card "+(e?"wpiam-landscape":"wpiam-portrait"));var n=(e?this.options.landscapeImageUrl:this.options.portraitImageUrl)||this.options.landscapeImageUrl||this.options.portraitImageUrl;this.imgContainerElement&&(this.imgContainerElement.style.display=n?"":"none",this.imgContainerElement.style.backgroundImage=n?"url("+n+")":"none")},Object.defineProperty(t.prototype,"active",{get:function(){return!!this.element.parentElement&&!this.dismissType},enumerable:!0,configurable:!0}),t.prototype.attach=function(){return window.document.body.appendChild(this.element),this.handleResize(),Promise.resolve()},t.prototype.detach=function(){var e;return null===(e=this.element.parentElement)||void 0===e||e.removeChild(this.element),Promise.resolve()},Object.defineProperty(t.prototype,"animationElement",{get:function(){return this.containerElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dimBackgroundElement",{get:function(){return this.backgroundElement},enumerable:!0,configurable:!0}),t}(a.Controller);t.CardController=s},function(e,t,n){var o=n(8),r=n(116);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i=(o(r,{insert:"head",singleton:!1}),r.locals?r.locals:{});e.exports=i},function(e,t,n){(t=n(6)(!1)).push([e.i,".wpiam-card-message.wpiam-message#wpiam-message {\n  font-size: 15px;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container {\n  align-items: center;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card .wpiam-card-content {\n  border-radius: inherit;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card .wpiam-card-content .wpiam-img-container {\n  background-size: cover;\n  background-position: center;\n  flex-shrink: 0;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card .wpiam-card-content section {\n  padding: 24px;\n  display: flex;\n  flex-direction: column;\n  justify-content: stretch;\n  overflow-y: auto;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card .wpiam-card-content section .wpiam-msg-content {\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: stretch;\n  overflow-y: auto;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card .wpiam-card-content section .wpiam-msg-content h2 {\n  font-size: 1.1em;\n  margin: 0;\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  flex-shrink: 0;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card .wpiam-card-content section .wpiam-msg-content p {\n  flex-grow: 1;\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  margin: 24px 0;\n  overflow-y: auto;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card .wpiam-card-content section .wpiam-actions {\n  flex-shrink: 0;\n  display: flex;\n  justify-content: flex-end;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card .wpiam-card-content section .wpiam-actions button {\n  cursor: pointer;\n  background: none;\n  border: 0;\n  font-size: 1em;\n  border-radius: 2px;\n  padding: 5px 9px 5px 9px;\n  font-weight: bold;\n  outline: none;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card .wpiam-card-content section .wpiam-actions button + button {\n  margin-left: 4px;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card.wpiam-landscape .wpiam-card-content {\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n  width: 500px;\n  height: 260px;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card.wpiam-landscape .wpiam-card-content .wpiam-img-container {\n  height: 260px;\n  flex-basis: 260px;\n  border-bottom-left-radius: inherit;\n  border-top-left-radius: inherit;\n  border-bottom-right-radius: 0px;\n  border-top-right-radius: 0px;\n  flex-grow: 0;\n  flex-shrink: 0;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card.wpiam-landscape .wpiam-card-content section {\n  flex-grow: 1;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card.wpiam-portrait .wpiam-card-content {\n  display: flex;\n  flex-direction: column;\n  justify-content: stretch;\n  max-height: 420px;\n  width: 260px;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card.wpiam-portrait .wpiam-card-content .wpiam-img-container {\n  height: 173px;\n  border-bottom-left-radius: 0px;\n  border-top-left-radius: inherit;\n  border-bottom-right-radius: 0px;\n  border-top-right-radius: inherit;\n}\n.wpiam-card-message.wpiam-message#wpiam-message .wpiam-card-container .wpiam-card.wpiam-portrait .wpiam-card-content section {\n  flex-grow: 1;\n}\n@media only screen and (min-width: 385px) and (min-height: 680px) {\n  .wpiam-card-message.wpiam-message#wpiam-message .wpiam-portrait {\n    transform: scale(1.2);\n  }\n}\n@media only screen and (min-width: 480px) and (min-height: 850px) {\n  .wpiam-card-message.wpiam-message#wpiam-message .wpiam-portrait {\n    transform: scale(1.4);\n  }\n}\n@media only screen and (min-width: 640px) and (min-height: 1136px) {\n  .wpiam-card-message.wpiam-message#wpiam-message .wpiam-portrait {\n    transform: scale(1.6);\n  }\n}\n@media only screen and (min-width: 680px) and (min-height: 385px) {\n  .wpiam-card-message.wpiam-message#wpiam-message .wpiam-landscape {\n    transform: scale(1.2);\n  }\n}\n@media only screen and (min-width: 850px) and (min-height: 480px) {\n  .wpiam-card-message.wpiam-message#wpiam-message .wpiam-landscape {\n    transform: scale(1.4);\n  }\n}\n@media only screen and (min-width: 1136px) and (min-height: 640px) {\n  .wpiam-card-message.wpiam-message#wpiam-message .wpiam-landscape {\n    transform: scale(1.6);\n  }\n}\n",""]),e.exports=t},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),a=n(11);n(118);var s=n(22),c=function(e){function t(t){var n=e.call(this,t)||this;n.options=t,n.element=document.createElement("div"),n.element.id="wpiam-message",n.element.className="wpiam-imageonly-message wpiam-fullscreen-container wpiam-message",n.backgroundElement=document.createElement("div"),n.backgroundElement.className="wpiam-dim-background",n.element.appendChild(n.backgroundElement);var o=document.createElement("div");n.containerElement=o,n.element.appendChild(o),o.className="wpiam-imageonly-card-container",o.addEventListener("click",(function(e){e.target===o&&(e.stopPropagation(),e.preventDefault(),n.dismiss(i.DismissType.TAP))}));var r=document.createElement("div");o.appendChild(r),r.className="wpiam-imageonly-card wpiam-card",r.addEventListener("click",(function(e){n.options.actions.length?n.click(n.options.actions,e):n.dismiss(i.DismissType.TAP)}));var a=new Image;a.src=n.options.imageUrl,r.appendChild(a),n.options.actions.length&&(a.style.cursor="pointer");var c=s.DisplayHelper.makeCloseButton();return c.classList.add("position-"+(t.closeButtonPosition||"outside")),r.appendChild(c),c.addEventListener("click",(function(){n.dismiss(i.DismissType.TAP)})),n}return r(t,e),t.prototype.handleResize=function(){var e=this.isLandscape,t=this.element.querySelector(".wpiam-imageonly-card-container"),n=this.element.querySelector("img");n.className=e?"wpiam-landscape":"",n.style.maxHeight=Math.round(.8*t.offsetHeight)+"px",n.style.maxWidth=Math.round(.8*t.offsetWidth)+"px"},Object.defineProperty(t.prototype,"active",{get:function(){return!!this.element.parentElement&&!this.dismissType},enumerable:!0,configurable:!0}),t.prototype.attach=function(){return window.document.body.appendChild(this.element),this.handleResize(),Promise.resolve()},t.prototype.detach=function(){var e;return null===(e=this.element.parentElement)||void 0===e||e.removeChild(this.element),Promise.resolve()},Object.defineProperty(t.prototype,"animationElement",{get:function(){return this.containerElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dimBackgroundElement",{get:function(){return this.backgroundElement},enumerable:!0,configurable:!0}),t}(a.Controller);t.ImageOnlyController=c},function(e,t,n){var o=n(8),r=n(119);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i=(o(r,{insert:"head",singleton:!1}),r.locals?r.locals:{});e.exports=i},function(e,t,n){(t=n(6)(!1)).push([e.i,".wpiam-imageonly-message.wpiam-message#wpiam-message .wpiam-imageonly-card-container {\n  align-items: center;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n}\n.wpiam-imageonly-message.wpiam-message#wpiam-message .wpiam-cancel-button {\n  position: absolute;\n  right: -8px;\n  top: -8px;\n  cursor: pointer;\n}\n.wpiam-imageonly-message.wpiam-message#wpiam-message .wpiam-cancel-button.position-inside {\n  top: 4px;\n  right: 4px;\n}\n.wpiam-imageonly-message.wpiam-message#wpiam-message .wpiam-cancel-button.position-none {\n  display: none;\n}\n.wpiam-imageonly-message.wpiam-message#wpiam-message .wpiam-card.wpiam-imageonly-card {\n  cursor: pointer;\n  padding: 0;\n  max-width: 80%;\n  max-height: 80%;\n  display: inline-block;\n}\n.wpiam-imageonly-message.wpiam-message#wpiam-message .wpiam-card.wpiam-imageonly-card img {\n  display: block;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=n(11),a=n(4);n(121);var s=n(22),c=function(e){function t(t){var n=e.call(this,t)||this;n.options=t,n.element=document.createElement("div"),n.element.id="wpiam-message",n.element.className="wpiam-message wpiam-modal-message wpiam-fullscreen-container",n.backgroundElement=document.createElement("div"),n.backgroundElement.className="wpiam-dim-background",n.element.appendChild(n.backgroundElement);var o=document.createElement("div");n.containerElement=o,n.element.appendChild(o),o.className="wpiam-modal-card-container",o.addEventListener("click",(function(e){e.target===o&&(e.stopPropagation(),e.preventDefault(),n.dismiss(a.DismissType.TAP))}));var r=document.createElement("div");n.cardElement=r,o.appendChild(r),r.className="wpiam-card",n.options.backgroundHexColor&&(r.style.backgroundColor=n.options.backgroundHexColor),n.options.title.hexColor&&(r.style.color=n.options.title.hexColor);var i=s.DisplayHelper.makeCloseButton();i.classList.add("position-"+(t.closeButtonPosition||"outside")),r.appendChild(i),i.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault(),n.dismiss(a.DismissType.TAP)}));var c=document.createElement("div");n.modalContainerElement=c,r.appendChild(c),c.className="wpiam-modal-container";var p=document.createElement("h2");if(n.titleElement=p,c.appendChild(p),p.innerText=n.options.title.text,n.options.title.hexColor&&(p.style.color=n.options.title.hexColor),n.options.imageUrl&&(n.img=document.createElement("img"),c.appendChild(n.img),n.img.src=n.options.imageUrl),n.options.body){var u=document.createElement("p");n.bodyElement=u,c.appendChild(u),u.innerText=n.options.body.text,n.options.body.hexColor&&(u.style.color=n.options.body.hexColor)}if(n.options.actionButton){var d=document.createElement("button");n.buttonElement=d,c.appendChild(d),d.innerText=n.options.actionButton.text.text,n.options.actionButton.text.hexColor&&(d.style.color=n.options.actionButton.text.hexColor),n.options.actionButton.buttonHexColor&&(d.style.backgroundColor=n.options.actionButton.buttonHexColor),d.addEventListener("click",(function(e){e.stopPropagation(),e.preventDefault(),n.click(n.options.actions,e)}))}return n}return r(t,e),Object.defineProperty(t.prototype,"active",{get:function(){return!!this.element.parentNode&&!this.dismissType},enumerable:!0,configurable:!0}),t.prototype.attach=function(){var e=this,t=function(){window.document.body.appendChild(e.element),e.handleResize()};if(this.img){var n=this.img;return new Promise((function(e,o){n.onload=function(){t(),e()},n.onerror=function(){o(new Error("error loading image"))}}))}return t(),Promise.resolve()},t.prototype.detach=function(){var e;return null===(e=this.element.parentNode)||void 0===e||e.removeChild(this.element),Promise.resolve()},t.prototype.handleResize=function(){var e,t,n=this,o=this.isLandscape||this.element.clientWidth>=650;if(this.cardElement.className="wpiam-card "+(o?"wpiam-landscape":"wpiam-portrait"),o){!this.imgContainer&&this.img&&(this.imgContainer=document.createElement("div"),this.imgContainer.className="wpiam-img-container",this.imgContainer.style.display=this.options.imageUrl?"default":"none",this.modalContainerElement.appendChild(this.imgContainer),this.img&&this.imgContainer.appendChild(this.img)),this.contentContainer||(this.contentContainer=document.createElement("div"),this.contentContainer.className="wpiam-content-container",this.modalContainerElement.appendChild(this.contentContainer),[this.titleElement,this.bodyElement,this.buttonElement].forEach((function(e){var t;e&&(null===(t=n.contentContainer)||void 0===t||t.appendChild(e))}))),this.cardElement.style.width="";var r=Math.min(390,Math.round(this.img?this.element.clientWidth/2:2*this.element.clientWidth/3)-48);this.contentContainer.style.width=r+"px";var i=this.element.clientHeight-96;if(this.contentContainer.style.maxHeight=i+"px",this.img){var a=this.element.clientHeight-96,s=Math.floor(2*(r+72)/3),c=Math.min(s,this.img.width),p=c*(this.img.height/this.img.width);p>a&&(c=(p=a)*(this.img.width/this.img.height)),this.img.style.height=Math.floor(p)+"px",this.img.style.width=Math.floor(c)+"px"}}else this.cardElement.style.width=this.element.clientWidth-48+"px",[this.titleElement,this.img,this.bodyElement,this.buttonElement].forEach((function(e){var t;e&&e.parentNode!==n.modalContainerElement&&(null===(t=n.modalContainerElement)||void 0===t||t.appendChild(e))})),this.imgContainer&&(null===(e=this.imgContainer.parentNode)||void 0===e||e.removeChild(this.imgContainer)),this.imgContainer=void 0,this.contentContainer&&(null===(t=this.contentContainer.parentNode)||void 0===t||t.removeChild(this.contentContainer)),this.contentContainer=void 0,this.img&&(this.img.style.height="",this.img.style.width="",this.img.style.maxHeight="",this.img.style.maxWidth="");var u=this.element.clientHeight-96;this.modalContainerElement.style.maxHeight=Math.min(u,1e3)+"px"},Object.defineProperty(t.prototype,"animationElement",{get:function(){return this.containerElement},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dimBackgroundElement",{get:function(){return this.backgroundElement},enumerable:!0,configurable:!0}),t}(i.Controller);t.ModalController=c},function(e,t,n){var o=n(8),r=n(122);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i=(o(r,{insert:"head",singleton:!1}),r.locals?r.locals:{});e.exports=i},function(e,t,n){(t=n(6)(!1)).push([e.i,".wpiam-modal-message.wpiam-message#wpiam-message {\n  font-size: 15px;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container {\n  display: flex;\n  align-items: center;\n  height: 100%;\n  width: 100%;\n  justify-content: center;\n  box-sizing: border-box;\n  padding: 24px;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card {\n  max-height: 100%;\n  max-width: 100%;\n  box-sizing: border-box;\n  padding: 24px;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card .wpiam-modal-container {\n  box-sizing: content-box;\n  max-height: 1000px;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card .wpiam-modal-container h2 {\n  font-size: 1.1em;\n  margin: 0 0 24px;\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  flex-shrink: 0;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card .wpiam-modal-container p {\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  margin-bottom: 24px;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card .wpiam-modal-container button {\n  cursor: pointer;\n  font-size: 1em;\n  border: 0;\n  border-radius: 2px;\n  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n  padding: 4px 8px;\n  outline: none;\n  flex-shrink: 0;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card.wpiam-landscape .wpiam-modal-container {\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n  align-content: stretch;\n  max-width: 650px;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card.wpiam-landscape .wpiam-modal-container .wpiam-img-container {\n  flex: 0 0 auto;\n  margin-right: 24px;\n  display: flex;\n  align-items: center;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card.wpiam-landscape .wpiam-modal-container .wpiam-content-container {\n  align-self: center;\n  flex-grow: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  align-content: safe flex-start;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card.wpiam-landscape .wpiam-modal-container .wpiam-content-container h2 {\n  max-height: 3em;\n  overflow-y: auto;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card.wpiam-landscape .wpiam-modal-container .wpiam-content-container p {\n  overflow-y: auto;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card.wpiam-portrait .wpiam-modal-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  text-align: center;\n  align-content: safe flex-start;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card.wpiam-portrait .wpiam-modal-container img {\n  flex: 1 3 auto;\n  min-height: 0;\n  object-fit: scale-down;\n  margin-bottom: 24px;\n  max-width: 100%;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card.wpiam-portrait .wpiam-modal-container p {\n  flex: 1 0 auto;\n  overflow-y: auto;\n  max-height: 6em;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card.wpiam-portrait .wpiam-modal-container h2 {\n  flex: 1 0 auto;\n  max-height: 3em;\n  overflow-y: auto;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-card.wpiam-portrait .wpiam-modal-container button {\n  flex: 0 0 auto;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-cancel-button {\n  position: absolute;\n  right: -8px;\n  top: -8px;\n  color: rgba(0, 0, 0, 0.87);\n  cursor: pointer;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-cancel-button.position-inside {\n  top: 4px;\n  right: 4px;\n}\n.wpiam-modal-message.wpiam-message#wpiam-message .wpiam-modal-card-container .wpiam-cancel-button.position-none {\n  display: none;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";var o,r=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(124),s=n(2),c="[inapp-segme]",p=function(){function e(e,t,n,o,r,i,s){this.segment=e,this.installationCoreProperties=t,this.installationCustomProperties=n,this.tags=o,this.allEvents=r,this.presenceInfo=i,this.subscriptionState=s,this.dslParser=a.defaultParserLenient,this.installationSource=new a.InstallationSource}return e.prototype.matches=function(){if(!this.segment)return!0;var e=this.dslParser.parse(this.segment,this.installationSource);return this.matchesSegment(e)},e.prototype.matchesSegment=function(e){return e.accept(new f(this.installationCoreProperties,this.installationCustomProperties,this.tags,this.allEvents,this.presenceInfo,this.subscriptionState))},e.toJsValue=function(e){return e instanceof a.BooleanValueNode||e instanceof a.NumberValueNode||e instanceof a.StringValueNode||e instanceof a.DateValueNode||e instanceof a.DurationValueNode||e instanceof a.NullValueNode?e.value:e instanceof a.RelativeDateValueNode?e.duration.applyTo(new Date).getTime():void s.warn(c,"[toJsValue   ]","Unsupported value",e)},e}();t.Segmenter=p;var u=function(){function e(e,t,n,o,r,i){this.installationCoreProperties=e,this.installationCustomProperties=t,this.tags=n,this.allEvents=o,this.presenceInfo=r,this.subscriptionState=i}return e.prototype.visitSubscriptionStatusCriterionNode=function(e){return e.subscriptionStatus===this.subscriptionState},e.prototype.visitPushUnsupportedCriterionNode=function(e){return e.pushUnsupported===("undefined"==typeof PushManager)},e.prototype.visitLastActivityDateCriterionNode=function(e){return e.dateComparison?e.dateComparison.accept(this):this.lastVisitDate()>0},e.prototype.visitASTValueNode=function(e){return s.warn(c,"[visitASTVal]","not implemented"),!1},e.prototype.visitAllCriterionNode=function(e){for(var t=e.context.dataSource.accept(this),n=0,o=e.values;n<o.length;n++){var r=o[n],i=!1,a=p.toJsValue(r);if(null===a)0===t.length&&(i=!0);else for(var u=0,d=t;u<d.length;u++)if(d[u]===a){i=!0;break}if(!i)return s.debug(c,"[visitAllCri]","return false because",t,"!==",a,e),!1}return s.debug(c,"[visitAllCri]","return true",t,e),!0},e.prototype.visitAndCriterionNode=function(e){for(var t=0,n=e.children;t<n.length;t++){var o=n[t];if(!o.accept(this))return s.debug(c,"[visitAndCri]","return false because",o,"is false.",e),!1}return s.debug(c,"[visitAndCri]","return true",e),!0},e.prototype.visitAnyCriterionNode=function(e){for(var t=e.context.dataSource.accept(this),n=0,o=e.values;n<o.length;n++){var r=o[n],i=p.toJsValue(r);if(null===i&&0===t.length)return s.debug(c,"[visitAnyCri] return true for ",t),!0;for(var a=0,u=t;a<u.length;a++){var d=u[a];if(d===i)return s.debug(c,"[visitAnyCri]","return true because",d,"===",i,e),!0}}return s.debug(c,"[visitAnyCri]","return false",e),!1},e.prototype.visitComparisonCriterionNode=function(e){for(var t=e.context.dataSource.accept(this),n=!1,o=p.toJsValue(e.value),r=0,i=t;r<i.length;r++){var a=i[r];switch(e.comparator){case"gt":n=a>o;break;case"lt":n=a<o;break;case"gte":n=a>=o;break;case"lte":n=a<=o}if(n)break}return s.debug(c,"[visitCompar]","return",n,"because",t,e.comparator,o,e),n},e.prototype.visitEqualityCriterionNode=function(e){var t=e.context.dataSource.accept(this),n=p.toJsValue(e.value);if(null===n)return 0===t.length;for(var o=!1,r=0,i=t;r<i.length&&!(o=i[r]===n);r++);return s.debug(c,"[visitEquali]","return",o,"because",t,o?"===":"!==",n,e),o},e.prototype.visitGeoCriterionNode=function(e){return s.warn(c,"[visitGeoCri]","not implemented"),!1},e.prototype.visitInsideCriterionNode=function(e){return s.warn(c,"[visitInside]","not implemented"),!1},e.prototype.visitJoinCriterionNode=function(e){if(e.context.dataSource instanceof a.EventSource){for(var t=0,n=this.allEvents;t<n.length;t++){var o=n[t],r=new g(this.installationCoreProperties,this.installationCustomProperties,this.tags,this.allEvents,this.presenceInfo,this.subscriptionState,o);if(e.child.accept(r))return!0}return!1}if(e.context.dataSource instanceof a.InstallationSource){var i=new f(this.installationCoreProperties,this.installationCustomProperties,this.tags,this.allEvents,this.presenceInfo,this.subscriptionState);return e.child.accept(i)}return s.debug(c,"[visitJoinCr] return false for unsupported",e.context.dataSource),!1},e.prototype.visitMatchAllCriterionNode=function(e){return s.debug(c,"[visitMatchA]","return true",e),!0},e.prototype.visitNotCriterionNode=function(e){var t=!e.child.accept(this);return s.debug(c,"[visitNotCri]","return",t,e),t},e.prototype.visitOrCriterionNode=function(e){for(var t=0,n=e.children;t<n.length;t++){var o=n[t];if(o.accept(this))return s.debug(c,"[visitOrCrit]","return true because",o,"is true",e),!0}return s.debug(c,"[visitOrCrit]","return false",e),!1},e.prototype.visitPrefixCriterionNode=function(e){var t=e.context.dataSource.accept(this),n=p.toJsValue(e.value);if("string"!=typeof n)return s.warn(c,"[visitPrefix]",n,"is not a string",e),!1;for(var o=!1,r=0,i=t;r<i.length;r++){var a=i[r];if("string"==typeof a){if(o=a.startsWith(n))break}else s.warn(c,"[visitPrefix]",a,"is not a string",e)}return s.debug(c,"[visitPrefix]","return",o,"because",t,o?"does":"does not","start with",n,e),o},e.prototype.visitPresenceCriterionNode=function(e){var t=+new Date;return!((!this.presenceInfo||this.presenceInfo.untilDate>=t&&this.presenceInfo.fromDate<=t)!==e.present||e.elapsedTimeComparison&&!e.elapsedTimeComparison.accept(this)||e.sinceDateComparison&&!e.sinceDateComparison.accept(this))},e.prototype.visitSegmentCriterionNode=function(e){return s.warn(c,"[visitSegmen]","not implemented"),!1},e.prototype.visitASTUnknownCriterionNode=function(e){return s.warn(c,"[visitASTUnk]","not implemented"),!1},e.prototype.visitEventSource=function(e){return[]},e.prototype.visitGeoDateSource=function(e){return[]},e.prototype.visitGeoLocationSource=function(e){return[]},e.prototype.visitInstallationSource=function(e){return[]},e.prototype.visitPresenceElapsedTimeSource=function(e){return e.present?[this.presenceInfo?Math.max(0,+new Date-this.presenceInfo.fromDate):0]:[this.presenceInfo?this.presenceInfo.elapsedTime:0]},e.prototype.visitPresenceSinceDateSource=function(e){return e.present?[this.presenceInfo?this.presenceInfo.fromDate:+new Date]:[this.presenceInfo?this.presenceInfo.untilDate:Number.MAX_VALUE]},e.prototype.visitUserSource=function(e){return[]},e.prototype.visitLastActivityDateSource=function(e){return[this.lastVisitDate()]},e.prototype.lastVisitDate=function(){for(var e=0,t=0,n=this.allEvents;t<n.length;t++){var o=n[t];"@VISIT"===o.type&&o.actionDate&&o.actionDate>e&&(e=o.actionDate)}return e},e}(),d=/^(\d\d\d\d(?:-\d\d(?:-\d\d)?)?)(?:T(\d\d(?::\d\d(?::\d\d(?:.\d\d\d)?)?)?))?(Z|[+-]\d\d(?::\d\d(?::\d\d(?:.\d\d\d)?)?)?)?$/,l=function(e){var t=d.exec(e);if(t){var n=t[1],o=t[2];o||(o="");var r=t[3];r||(r=""),n+="1970-01-01".substring(n.length),o+="00:00:00.000".substring(o.length),"Z"===r&&(r=""),r.length>5&&(r=r.substring(0,5));var i=n+"T"+o+(r+="+00:00".substring(r.length));try{return new Date(i)}catch(e){return}}},f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.visitFieldSource=function(e){for(var t,n=e.fullPath(),o=i(i({},this.installationCoreProperties),{custom:i(i({},this.installationCustomProperties),{tags:Array.from(this.tags)})}),r=0,a=n.parts;r<a.length;r++){var s=a[r];o&&(o=o[s])}if(t=Array.isArray(o)?o.filter((function(e){return null!=e})):null==o?[]:[o],n.parts.length>=2&&"custom"===n.parts[0]&&n.parts[n.parts.length-1].startsWith("date_")){var c=t;t=[];for(var p=0,u=c;p<u.length;p++){var d=u[p];if("string"==typeof d)try{var f=l(d);d=f?f.getTime():d}catch(e){}t.push(d)}}return t},t}(u),g=function(e){function t(t,n,o,r,i,a,s){var c=e.call(this,t,n,o,r,i,a)||this;return c.event=s,c}return r(t,e),t.prototype.visitFieldSource=function(e){for(var t=e.fullPath(),n=this.event,o=0,r=t.parts;o<r.length;o++){var i=r[o];n&&(n=n[i])}return Array.isArray(n)?n:null==n?[]:[n]},t}(u)},function(e,t,n){"use strict";function o(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),o(n(7)),o(n(12)),o(n(13)),o(n(23)),o(n(24)),o(n(125)),o(n(31)),o(n(29)),o(n(9)),o(n(16)),o(n(27)),o(n(26)),o(n(15)),o(n(28)),o(n(14)),o(n(30)),o(n(25))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(25),r=n(23),i=n(14),a=n(9),s=n(24),c=n(26),p=n(15),u=n(16),d=n(27),l=n(28),f=n(29),g=n(30),h=n(12),m=n(13);class v extends o.ConfigurableValueNodeParser{constructor(){super(),this.registerExactNameParser("date",v.parseDate),this.registerExactNameParser("duration",v.parseDuration),this.registerExactNameParser("geolocation",v.parseGeolocation),this.registerExactNameParser("geobox",v.parseGeobox),this.registerExactNameParser("geocircle",v.parseGeocircle),this.registerExactNameParser("geopolygon",v.parseGeopolygon)}static parseDate(e,t,n){if("number"==typeof n){const t=n;return new r.DateValueNode(e,t)}if("string"==typeof n){const t=n;if(/^(\+|-)?P/.test(t)){const n=i.ISO8601Duration.parse(t);return new r.RelativeDateValueNode(e,n)}const o=/^(\d\d\d\d(?:-\d\d(?:-\d\d)?)?)(?:T(\d\d(?::\d\d(?::\d\d(?:.\d\d\d)?)?)?))?(Z|[+-]\d\d(?::\d\d(?::\d\d(?:.\d\d\d)?)?)?)?$/.exec(t);if(null!==o){let t=o[1],n=o[2]||"",i=o[3]||"";t+="1970-01-01".substr(t.length),n+="00:00:00.000000".substr(n.length),"Z"===i&&(i=""),i=(i+="+00:00".substr(i.length)).substr(0,6);const a=new Date(t+"T"+n+i);return new r.DateValueNode(e,a.getTime())}}throw new a.BadInputError(`"${t}" values expect a number or a string value`)}static parseDuration(e,t,n){if("number"==typeof n){const t=n;return new r.DurationValueNode(e,t)}if("string"==typeof n){const o=n;if(/^(\+|-)?P/.test(o)){const t=i.ISO8601Duration.parse(o);return new r.DurationValueNode(e,t)}const s=/^\s*([+-]?[0-9\.]+(?:[eE][+-]?[0-9]+)?)\s*([a-zA-Z]*)?\s*$/.exec(o);if(null!==s){const n=parseFloat(s[1]),o=s[2];if(["ns","nanos","nanosecond","nanoseconds"].indexOf(o)>=0)return new r.DurationValueNode(e,n/1e6);if(["us","micros","microsecond","microseconds"].indexOf(o)>=0)return new r.DurationValueNode(e,n/1e3);if(["ms","millis","millisecond","milliseconds"].indexOf(o)>=0)return new r.DurationValueNode(e,n);if(["s","sec","secs","second","seconds"].indexOf(o)>=0)return new r.DurationValueNode(e,1e3*n);if(["m","min","minute","minutes"].indexOf(o)>=0)return new r.DurationValueNode(e,60*n*1e3);if(["h","hr","hour","hours"].indexOf(o)>=0)return new r.DurationValueNode(e,60*n*60*1e3);if(["d","day","days"].indexOf(o)>=0)return new r.DurationValueNode(e,24*n*60*60*1e3);if(["w","week","weeks"].indexOf(o)>=0)return new r.DurationValueNode(e,7*n*24*60*60*1e3);throw new a.BadInputError(`"${t}" string values expect a valid unit`)}}throw new a.BadInputError(`"${t}" values expect a number or a valid string value`)}static parseGeolocation(e,t,n){if("string"==typeof n){const t=n;return new s.GeoLocationValueNode(e,c.Geohash.parse(t).toGeoLocation())}if("object"!=typeof n||Array.isArray(n)||"number"!=typeof n.lat||"number"!=typeof n.lon)throw new a.BadInputError(`"${t}" values expect an object with a "lat" and "lon" numeric fields`);const o=n.lat,r=n.lon;return new s.GeoLocationValueNode(e,new p.GeoLocation(o,r))}static parseGeobox(e,t,n){if("string"==typeof n){const t=n;return new s.GeoBoxValueNode(e,c.Geohash.parse(t).toGeoBox())}if("object"!=typeof n||Array.isArray(n))throw new a.BadInputError(`"${t}" values expect an object`);if(null!=n.topLeft&&null!=n.bottomRight)return new s.GeoBoxValueNode(e,u.GeoBox.fromTopLeftAndBottomRight(v.parseGeolocation(e,"geolocation",n.topLeft).value,v.parseGeolocation(e,"geolocation",n.bottomRight).value));if(null!=n.topRight&&null!=n.bottomLeft)return new s.GeoBoxValueNode(e,u.GeoBox.fromTopRightAndBottomLeft(v.parseGeolocation(e,"geolocation",n.topRight).value,v.parseGeolocation(e,"geolocation",n.bottomLeft).value));if("number"==typeof n.top&&"number"==typeof n.right&&"number"==typeof n.bottom&&"number"==typeof n.left)return new s.GeoBoxValueNode(e,u.GeoBox.fromTopRightBottomLeft(n.top,n.right,n.bottom,n.left));throw new a.BadInputError(`"${t}" did not receive an object with a handled format`)}static parseGeocircle(e,t,n){if("object"!=typeof n||Array.isArray(n))throw new a.BadInputError(`"${t}" values expect an object`);if("number"!=typeof n.radius)throw new a.BadInputError(`"${t}" needs a radius numeric field`);if(null!=n.center)return new s.GeoCircleValueNode(e,new d.GeoCircle(v.parseGeolocation(e,"geolocation",n.center).value,n.radius));throw new a.BadInputError(`"${t}" did not receive an object with a handled format`)}static parseGeopolygon(e,t,n){if(!Array.isArray(n)||n.length<3)throw new a.BadInputError(`"${t}" values expect an array of at least 3 geolocations`);return new s.GeoPolygonValueNode(e,new l.GeoPolygon(n.map(t=>v.parseGeolocation(e,"geolocation",t).value)))}}t.DefaultValueNodeParser=v;class _ extends o.ConfigurableCriterionNodeParser{constructor(){super(),this.registerDynamicNameParser(_.parseDynamicDotField),this.registerExactNameParser("and",_.parseAnd),this.registerExactNameParser("or",_.parseOr),this.registerExactNameParser("not",_.parseNot),this.registerExactNameParser("segment",_.parseSegment),this.registerExactNameParser("lastActivityDate",_.parseLastActivityDate),this.registerExactNameParser("presence",_.parsePresence),this.registerExactNameParser("geo",_.parseGeo),this.registerExactNameParser("subscriptionStatus",_.parseSubscriptionStatus),this.registerExactNameParser("pushUnsupported",_.parsePushUnsupported),this.registerExactNameParser("user",_.parseUser),this.registerExactNameParser("installation",_.parseInstallation),this.registerExactNameParser("event",_.parseEvent),this.registerExactNameParser("eq",_.parseEq),this.registerExactNameParser("any",_.parseAny),this.registerExactNameParser("all",_.parseAll),this.registerExactNameParser("gt",_.parseGt),this.registerExactNameParser("gte",_.parseGte),this.registerExactNameParser("lt",_.parseLt),this.registerExactNameParser("lte",_.parseLte),this.registerExactNameParser("prefix",_.parsePrefix),this.registerExactNameParser("inside",_.parseInside)}static parseDynamicDotField(e,t,n){if("."===t.charAt(0)){const o=new f.FieldSource(e.dataSource,f.FieldPath.parse(t.substr(1))),r=e.withDataSource(o);return e.parser.parseCriterion(r,n)}return null}static parseAnd(e,t,n){const o=_.ensureArrayOfObjects(t,n);return new h.AndCriterionNode(e,o.map(t=>e.parser.parseCriterion(e,t)))}static parseOr(e,t,n){const o=_.ensureArrayOfObjects(t,n);return new h.OrCriterionNode(e,o.map(t=>e.parser.parseCriterion(e,t)))}static parseNot(e,t,n){const o=_.ensureObject(t,n);return new h.NotCriterionNode(e,e.parser.parseCriterion(e,o))}static parseSegment(e,t,n){if(e.dataSource.getRootDataSource()!==e.dataSource)throw new a.BadInputError(`"${t}" is not supported in the context of a field`);const o=_.ensureObject(t,n),r=_.ensureString(t+".id",o.id);if(r.length<1)throw new a.BadInputError(`"${t}.id" expects a valid id`);return new h.SegmentCriterionNode(e,r)}static parseLastActivityDate(e,t,n){if(!(e.dataSource instanceof f.InstallationSource))throw new a.BadInputError(`"${t}" is only supported in the context of "installation"`);const o=_.ensureObject(t,n),r=new f.LastActivityDateSource(e.dataSource),i=e.parser.parseCriterion(e.withDataSource(r),o);return new h.LastActivityDateCriterionNode(e,i)}static parsePresence(e,t,n){if(!(e.dataSource instanceof f.InstallationSource))throw new a.BadInputError(`"${t}" is only supported in the context of "installation"`);const o=_.ensureObject(t,n),r=_.ensureBoolean(t+".present",n.present),i=new f.PresenceSinceDateSource(e.dataSource,r),s="sinceDate"in o?e.parser.parseCriterion(e.withDataSource(i),_.ensureObject(t+".sinceDate",n.sinceDate)):void 0,c=new f.PresenceElapsedTimeSource(e.dataSource,r),p="elapsedTime"in o?e.parser.parseCriterion(e.withDataSource(c),_.ensureObject(t+".elapsedTime",n.elapsedTime)):void 0;return new h.PresenceCriterionNode(e,r,s,p)}static parseGeo(e,t,n){if(!(e.dataSource instanceof f.InstallationSource))throw new a.BadInputError(`"${t}" is only supported in the context of "installation"`);const o=_.ensureObject(t,n),r=new f.GeoLocationSource(e.dataSource),i="location"in o?e.parser.parseCriterion(e.withDataSource(r),_.ensureObject(t+".location",n.location)):void 0,s=new f.GeoDateSource(e.dataSource),c="date"in o?e.parser.parseCriterion(e.withDataSource(s),_.ensureObject(t+".date",n.date)):void 0;return new h.GeoCriterionNode(e,i,c)}static parseSubscriptionStatus(e,t,n){if(!(e.dataSource instanceof f.InstallationSource))throw new a.BadInputError(`"${t}" is only supported in the context of "installation"`);const o=_.ensureString(t,n);if("optIn"!==o&&"optOut"!==o&&"softOptOut"!==o)throw new a.BadInputError('"'+t+'" must be one of "optIn", "optOut" or "softOptOut"');return new h.SubscriptionStatusCriterionNode(e,o)}static parsePushUnsupported(e,t,n){if(!(e.dataSource instanceof f.InstallationSource))throw new a.BadInputError(`"${t}" is only supported in the context of "installation"`);const o=_.ensureBoolean(t,n);return new h.PushUnsupportedCriterionNode(e,o)}static parseUser(e,t,n){const o=e.dataSource.getRootDataSource(),r=_.ensureObject(t,n),i=e.withDataSource(new f.UserSource);if(o instanceof f.UserSource)return e.parser.parseCriterion(i,r);if(o instanceof f.InstallationSource)return new h.JoinCriterionNode(i,e.parser.parseCriterion(i,r));if(o instanceof f.EventSource){const t=e.withDataSource(new f.InstallationSource),n=t.withDataSource(new f.UserSource);return new h.JoinCriterionNode(t,new h.JoinCriterionNode(n,e.parser.parseCriterion(n,r)))}throw new a.BadInputError(`"${t}" is not supported in this context`)}static parseInstallation(e,t,n){const o=e.dataSource.getRootDataSource(),r=_.ensureObject(t,n),i=e.withDataSource(new f.InstallationSource);if(o instanceof f.UserSource||o instanceof f.EventSource)return new h.JoinCriterionNode(i,e.parser.parseCriterion(i,r));if(o instanceof f.InstallationSource)return e.parser.parseCriterion(i,r);throw new a.BadInputError(`"${t}" is not supported in this context`)}static parseEvent(e,t,n){const o=e.dataSource.getRootDataSource(),r=_.ensureObject(t,n),i=e.withDataSource(new f.EventSource);if(o instanceof f.UserSource){const t=e.withDataSource(new f.InstallationSource),n=t.withDataSource(new f.EventSource);return new h.JoinCriterionNode(t,new h.JoinCriterionNode(n,e.parser.parseCriterion(n,r)))}if(o instanceof f.InstallationSource)return new h.JoinCriterionNode(i,e.parser.parseCriterion(i,r));if(o instanceof f.EventSource)return e.parser.parseCriterion(i,r);throw new a.BadInputError(`"${t}" is only supported in the context of "installation"`)}static parseEq(e,t,n){if(e.dataSource.getRootDataSource()===e.dataSource)throw new a.BadInputError(`"${t}" is only supported in the context of a field`);return new h.EqualityCriterionNode(e,e.parser.parseValue(e,n))}static parseAny(e,t,n){if(e.dataSource.getRootDataSource()===e.dataSource)throw new a.BadInputError(`"${t}" is only supported in the context of a field`);const o=_.ensureArray(t,n);return new h.AnyCriterionNode(e,o.map(t=>e.parser.parseValue(e,t)))}static parseAll(e,t,n){if(e.dataSource.getRootDataSource()===e.dataSource)throw new a.BadInputError(`"${t}" is only supported in the context of a field`);const o=_.ensureArray(t,n);return new h.AllCriterionNode(e,o.map(t=>e.parser.parseValue(e,t)))}static parseGtGteLtLte(e,t,n,o){if(e.dataSource.getRootDataSource()===e.dataSource)throw new a.BadInputError(`"${t}" is only supported in the context of a field`);return new h.ComparisonCriterionNode(e,o,e.parser.parseValue(e,n))}static parseGt(e,t,n){return _.parseGtGteLtLte(e,t,n,"gt")}static parseGte(e,t,n){return _.parseGtGteLtLte(e,t,n,"gte")}static parseLt(e,t,n){return _.parseGtGteLtLte(e,t,n,"lt")}static parseLte(e,t,n){return _.parseGtGteLtLte(e,t,n,"lte")}static parsePrefix(e,t,n){if(e.dataSource.getRootDataSource()===e.dataSource)throw new a.BadInputError(`"${t}" is only supported in the context of a field`);const o=e.parser.parseValue(e,n);if(!(o instanceof m.StringValueNode))throw new a.BadInputError(`"${t}" expects a string value`);return new h.PrefixCriterionNode(e,o)}static parseInside(e,t,n){if(e.dataSource.getRootDataSource()===e.dataSource)throw new a.BadInputError(`"${t}" is only supported in the context of a field`);const o=e.parser.parseValue(e,n);if(!(o instanceof s.GeoAbstractAreaValueNode))throw new a.BadInputError(`"${t}" expects a compatible geo value`);return new h.InsideCriterionNode(e,o)}static ensureArray(e,t){if(!Array.isArray(t))throw new a.BadInputError('"'+e+'" expects an array');return t}static ensureArrayOfObjects(e,t){if(!Array.isArray(t))throw new a.BadInputError('"'+e+'" expects an array');if(t.some(e=>"object"!=typeof e||null===e||Array.isArray(e)))throw new a.BadInputError('"'+e+'" expects an array of objects');return t}static ensureObject(e,t){if(null===t||"object"!=typeof t||Array.isArray(t))throw new a.BadInputError('"'+e+'" expects an object');return t}static ensureString(e,t){if("string"!=typeof t)throw new a.BadInputError('"'+e+'" expects a string');return t}static ensureBoolean(e,t){if("boolean"!=typeof t)throw new a.BadInputError('"'+e+'" expects a boolean');return t}}t.DefaultCriterionNodeParser=_,t.defaultParser=new g.SegmentationDSLParser({throwOnUnknownCriterion:!0,throwOnUnknownValue:!0,valueParser:new v,criterionParser:new _}),t.defaultParserLenient=new g.SegmentationDSLParser({throwOnUnknownCriterion:!1,throwOnUnknownValue:!1,valueParser:new v,criterionParser:new _})}]);